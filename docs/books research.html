
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Table of contents &#8212; My Jupyter Book</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-2 bd-sidebar site-navigation show single-page" id="site-navigation">
    
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/books research.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/books research.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Table of contents</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <h1>Books Success by Awarding Prediction</h1><div class="section" id="table-of-contents">
<h1>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">Â¶</a></h1>
<ol class="simple">
<li><p><a class="reference external" href="#introduction">Introduction</a><br></p></li>
<li><p><a class="reference external" href="#imports">Imports</a><br></p></li>
<li><p><a class="reference external" href="#data_acquisition">Data acquisition</a><br>
3.1 <a class="reference external" href="#scraping_challanges">Scraping challanges</a><br>
3.2 <a class="reference external" href="#scraping_clean_data">Scraping clean data</a><br>
3.3 <a class="reference external" href="#authentication_process">Authentication process</a><br>
3.4 <a class="reference external" href="#authentication_class">Authentication class</a><br>
3.5 <a class="reference external" href="#scraping_process">Scraping Process</a><br>
3.6 <a class="reference external" href="#book_spider_class">Book Spider Class</a><br>
3.7 <a class="reference external" href="#scraping_route_creation">Scraping route creation</a><br>
3.8 <a class="reference external" href="#genre_spider">Genre spider</a><br></p></li>
<li><p><a class="reference external" href="#scraping">Scrapping and threading</a><br>
4.1 <a class="reference external" href="#first_crawl">First crawl</a><br>
4.2 <a class="reference external" href="#concating_data">Concating Data</a><br>
4.2 <a class="reference external" href="#data_scraped">Total data scraped</a><br></p></li>
<li><p><a class="reference external" href="#data_cleaning">Data cleaning</a><br>
5.1 <a class="reference external" href="#corrupted_data_cleaning">Corrupted data cleaning</a><br>
5.2 <a class="reference external" href="#replace_missing_og">Replace missing data - original title</a><br>
5.3 <a class="reference external" href="#none_values">None values - discussion and strategy</a><br></p></li>
<li><p><a class="reference external" href="#outliers_detection_eda">Pre outliers cleaning EDA</a><br>
6.1 <a class="reference external" href="#genre_distribution">Genre distribution</a><br>
6.2 <a class="reference external" href="#mean_rating_by_genre">Mean rating by genre</a><br>
6.3 <a class="reference external" href="#language_distribution">Language distribution</a><br>
6.4 <a class="reference external" href="#edition_count_to_rating">Edition count to rating</a><br>
6.5 <a class="reference external" href="#rating_to_award">Rating to award</a><br>
6.6 <a class="reference external" href="#pages_count_to_books_count">Pages count to books count</a><br></p></li>
<li><p><a class="reference external" href="#dealing_with_outliers">Dealing with outliers</a><br>
7.1 <a class="reference external" href="#dealing_with_outliers">Outliers detection</a><br>
7.2 <a class="reference external" href="#outliers_cleaning">Outliers cleaning</a><br>
7.3 <a class="reference external" href="#outliers_clean_results">Outliers cleaning results</a><br></p></li>
<li><p><a class="reference external" href="#after_clean_eda">EDA after outliers cleaning</a><br>
8.1 <a class="reference external" href="#thoughts_after_clean">Thoughts of the results</a><br>
8.2 <a class="reference external" href="#metrics_agg">Aggregation metrics</a><br>
8.3 <a class="reference external" href="#og_title_eff">Original title correlation with awards</a><br>
8.4 <a class="reference external" href="#awards_count_to_genre">Awards count per genre</a><br>
8.5 <a class="reference external" href="#awards_book_by_percentage">Awards percentage by genre</a><br></p></li>
<li><p><a class="reference external" href="#machine_learning_prep">Machine learning preperation</a><br></p></li>
<li><p><a class="reference external" href="#machine_learning_single">Machine learning - Decision tree</a><br>
10.1 <a class="reference external" href="#machine_learning_single">Single decision tree</a><br>
10.2 <a class="reference external" href="#first_attempt">First prediction</a><br>
10.3 <a class="reference external" href="#ace">New dimenstion - The ace in the sleeve</a><br>
10.4 <a class="reference external" href="#depth_opt">Depth optiomazation</a><br></p></li>
<li><p><a class="reference external" href="#random_forest">Machine learning - Random forest</a><br>
11.1 <a class="reference external" href="#overfitting">Overfitting?</a><br>
11.2 <a class="reference external" href="#improve_model">Model improvment</a><br>
11.3 <a class="reference external" href="#another_ace">Adjusting features</a><br>
11.4 <a class="reference external" href="#grid_search_forest">Grid search many forests</a><br>
11.5 <a class="reference external" href="#the_top">F-score accuracy addition</a><br>
11.6 <a class="reference external" href="#random_states">Random states tests</a><br></p></li>
<li><p><a class="reference external" href="#conclusion">Conclusion and credits</a><br></p></li>
</ol>
<p><a id='introduction'></a></p>
<h2>Introduction</h2>
<p>
    Today the movie industry is one of the biggest industries in the world.<br>
    Full of many actors, producers, films and even a lot of rating websites such as: IMDB, Rotten tomatoes, Metacritic and etc.<br>
    As the film industry growth we felt that something was forgotten here and thought to ourselves: What about the books industry and those great books which also in days became the scripts of many successful movies?<br> 
    This thought led us to ask ourselves: assuming we were a huge books publisher and a writer came to us with a book, how could we know if this book will be successful?<br>
    Also if we were to be the authors of the book, could we ever know if the book will get the audience sympathy or even reach the cinema theatres?<br>
    To answer the following questions we set a goal to our research: to see if we can build a model that will predict if a book is so successful that it will also be awarded by list of books features.
</p><p><a id='imports'></a></p>
<h3 id="imports">Import needed packages</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install pydot
<span class="o">!</span>pip install pydotplus
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">bs4.element</span> <span class="kn">import</span> <span class="n">Tag</span> <span class="k">as</span> <span class="n">HtmlTag</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="n">Number</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>  
<span class="kn">import</span> <span class="nn">pydotplus</span> 
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">misc</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">make_scorer</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pydot in ./venv/lib/python3.9/site-packages (1.4.2)
Requirement already satisfied: pyparsing&gt;=2.1.4 in ./venv/lib/python3.9/site-packages (from pydot) (3.0.9)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: You are using pip version 21.2.3; however, version 22.1 is available.</span>
<span class=" -Color -Color-Yellow">You should consider upgrading via the &#39;/Users/shahartal/Desktop/test/venv/bin/python3 -m pip install --upgrade pip&#39; command.</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pydotplus in ./venv/lib/python3.9/site-packages (2.0.2)
Requirement already satisfied: pyparsing&gt;=2.0.1 in ./venv/lib/python3.9/site-packages (from pydotplus) (3.0.9)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: You are using pip version 21.2.3; however, version 22.1 is available.</span>
<span class=" -Color -Color-Yellow">You should consider upgrading via the &#39;/Users/shahartal/Desktop/test/venv/bin/python3 -m pip install --upgrade pip&#39; command.</span>
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [1],</span> in <span class="ni">&lt;cell line: 15&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="n">Number</span>
<span class="ne">---&gt; </span><span class="mi">15</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pandas&#39;
</pre></div>
</div>
</div>
</div>
<p><a id="data_acquisition"></a></p>
<h2>Data Acquisition</h2>
<p>In order to create a predication model we first needed to gather relevant data.</p>
<p>Considering our options of data acquisition sources, we decided to look for the biggest library catalogs and reading lists websites and scrape data which we thought will be helpful and save it as a dataframe</p>
<p>The top options we found were:<br>
<ul>
    <li><a href="https://openlibrary.org/" target="_blank">Open Library</a></li>
    <li><a href="https://www.goodreads.com/" target="_blank">Good Reads</a></li>
    <li><a href="https://www.librarything.com/" target="_blank">Library Thing</a></li>
    <li><a href="https://booklikes.com/" target="_blank">Book Likes</a></li>
</ul>
<p>After a punctual search in these websites for relevant data and great community scale, we have decided to move on with good reads due to the scale of the community and amount of features provided with each book.</p>
<p>We started looking for a way to scrape data from good reads and we immediately faced the issue of having to authenticate and make all network requests to their servers under the same authenticated session</p><h4>
We used authentication credentials, so we stored the credentials to a .env file locally and load the varialbes by name instead hardcoding them.
</h4><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_dotenv_variables</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">env_vars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="o">!</span>cat ./.env
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">env_vars</span><span class="p">:</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<span class="n">load_dotenv_variables</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a id='scraping_challanges'></a></p>
<h3>Scraping challanges</h3>
<p>While we trying our first attempts to scrape the data from good reads we found out the following issues:<br>
    <ul>
        <li>When sending too many requests in a short period of time, the website started to slow down and the scraping slowly was defected (slower responses)</li>
        <li>Once in a while instead of getting a valid response from the servers we got an unexpected error which resulted lack of data</li>
        <li>The default user agent used by requests was python-requests/2.26.0 and we were worried that we may be detected has a bot and thus being forbid from sending requests using the same user/ip</li>
     </ul>
</p>
<p> The way we dealed with these issues was by created saftey methods for each chllange.<h3>
Some util functions to help scrape the data without harming the the 3rd party websites and retry mechanism in case of failure
</h3>
<p>
    <ul>
        <li>sleepms - function made in order to create a delay so the amount of requests sends to the server in parralel will not affect the scraping performance and other users experience in the website</li>
        <li>random_wait - function which is used in order to create random delay so our scraping methodology will not be detected by the servers.</li>
        <li>get_request_with_retry - function that sends a get request to the servers and also address the issue of unexpected errors.</li>
        <li>get_fake_user_agent - function which provides us with a non suspectable user agent.<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sleepms</span><span class="p">(</span><span class="n">milliseconds</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="n">seconds</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">milliseconds</span>
    <span class="n">sleep</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">random_wait</span><span class="p">():</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">sleepms</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AuthorizationFailureException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">class</span> <span class="nc">HtmlTagNotFoundException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_request_with_retry</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">(),</span> <span class="n">retries_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">expected_status_code</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">retries_count</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;url:</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">, invalid retries count: </span><span class="si">{</span><span class="n">retries_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">retries_count</span><span class="p">):</span>
        <span class="n">random_wait</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span> <span class="ow">and</span> <span class="n">expected_status_code</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">result</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="n">expected_status_code</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;url:</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">, retries limit exceeded...&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_fake_user_agent</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36&quot;</span>
</pre></div>
</div>
</div>
</div>
<p><a id='scraping_clean_data'></a></p>
<h3>Scraping clean data</h3>
<p>While scaping we found out that we get some of the features scraped with defected such as:<br>
    <ul>
        <li>Some numbers were presented with a comma separator and we wanted to store a numeric type and not a string type.</li>
        <li>Some features were a subset of a bigger text which we only needed a part of it.</li>
     </ul>
</p>
<p>In order to resolve these issues we created a converter which extract the data we wanted precisely</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NumberTypesConverters</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">INT</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">FLOAT</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">COMPLEX</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">string_to_number</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">number_converter</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Number</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;gets a string which may contain commas and a number type, returns converted string&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">number_converter</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">number_converter</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">extract_parentheses_value</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;gets string with parentheses in it, and return the inner value inside first parentheses&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="s2">&quot;(&quot;</span> <span class="ow">in</span> <span class="n">string</span> <span class="ow">or</span> <span class="ow">not</span> <span class="s2">&quot;)&quot;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string</span>
    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><a id='authentication_process'></a></p>
<h3>Authentication process</h3>
<p>At the beginning we were trying to understand what is needed from us in order to authenticate to the good read servers.<br>
   We were looking at the requests sent to the server just by using the website as normal user and logging in to an account.<br>
   We could see that besides the username and password which were sent in the request there were 2 more fields sent:<br>
    <ul>
        <li>authenticity_token</li>
        <li>n</li>
    </ul>
   After deep investigation at the HTML tree we finally found these fields which were both under an hidden type input tag, this was made in order to prevent the "casual" user finding them out.<br>
   Once we did find these fields we were able to create a class to automate the authentication process.<br>
   <strong>Note: These days the class will not work due to a massive change to the website done in the 19th of April 2022 which included changes to the authentication service - You can still see the old website <a href="https://web.archive.org/web/*/https://www.goodreads.com/">here</a> at the 18th of April 2022</strong></p><h3>But why do we need authentication in a free to use website?</h3>
<p>Apparently the website was free to use but it was not functioning properly while the user is not signed in to the website<br>
Here is a good example that shows how the shelves page is not showing the right books while the user is not signed in (we will talk about shelves later on).
</p><img src="./images/1.jpeg" /><img src="./images/2.jpeg" /><p><a id='authentication_class'></a></p>
<h3>Authentication Class</h3>
<p>
Used to store authentication persistent data inside of a requests session, to allow private scraping
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SessionAuthenticator</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="n">session</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets requests session class and authenticate it to derived service&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GoodReadsAuthenticator</span><span class="p">(</span><span class="n">SessionAuthenticator</span><span class="p">):</span>
    <span class="n">LOGIN_URL</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;https://www.goodreads.com/user/sign_in&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user_password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">user_email</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid user_email&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_email</span> <span class="o">=</span> <span class="n">user_email</span>
        <span class="k">if</span> <span class="n">user_password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid user_password&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_password</span> <span class="o">=</span> <span class="n">user_password</span>
    
    <span class="k">def</span> <span class="nf">__get_authenticity_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">token_hidden_input</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;authenticity_token&quot;</span><span class="p">})</span><span class="c1"># hidden field</span>
        <span class="k">if</span> <span class="n">token_hidden_input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">HtmlTagNotFoundException</span><span class="p">(</span><span class="s2">&quot;authenticity_token_hidden_input is not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">token_hidden_input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__get_n_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">n_hidden_input</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;n&quot;</span><span class="p">})</span><span class="c1"># used to be below &quot;not a member?&quot;</span>
        <span class="k">if</span> <span class="n">n_hidden_input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">HtmlTagNotFoundException</span><span class="p">(</span><span class="s2">&quot;n_hidden_input is not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n_hidden_input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets requests.Session and provides cookie persistence for Good Reads&quot;&quot;&quot;</span>
        
        <span class="n">login_form_page_res</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">get_request_with_retry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LOGIN_URL</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>

        <span class="n">authenticity_token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_authenticity_token</span><span class="p">(</span><span class="n">login_form_page_res</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

        <span class="n">n_val</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_n_value</span><span class="p">(</span><span class="n">login_form_page_res</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    
        <span class="n">login_payload</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;user[email]&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_email</span><span class="p">,</span>
            <span class="s2">&quot;user[password]&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_password</span><span class="p">,</span>
            <span class="s2">&quot;authenticity_token&quot;</span><span class="p">:</span> <span class="n">authenticity_token</span><span class="p">,</span>
            <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="n">n_val</span>
        <span class="p">}</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempting to log in to Good Reads...&quot;</span><span class="p">)</span>
        
        <span class="n">authentication_res</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LOGIN_URL</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">login_payload</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">authentication_res</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AuthorizationFailureException</span><span class="p">(</span><span class="s2">&quot;Good Reads login failure&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;logged in sucessfully...&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<h3>Authenticating...</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">session</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="n">get_fake_user_agent</span><span class="p">()})</span><span class="c1"># otherwise, default is: &#39;python-requests/2.26.0&#39;</span>
<span class="n">grAuth</span><span class="p">:</span> <span class="n">SessionAuthenticator</span> <span class="o">=</span> <span class="n">GoodReadsAuthenticator</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GOODREADS_EMAIL&quot;</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GOODREADS_PASSWORD&quot;</span><span class="p">))</span>

    <span class="n">grAuth</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempting to log in to Good Reads...
logged in sucessfully...
</pre></div>
</div>
</div>
</div>
<p><a id='scraping_process'></a></p>
<h3>Scraping Process</h3>
<p>
Once we finished with creating both the authentication class and the utilization functions we were right in the spot were we felt confident to start building a spider classes which will scrape the data for us automatically.
</p>
<p>
At first glance at the website we thought to ourselves, just how exactly we want to scrape the data?<br>
So went in to the website and started exploring the website in order to find the best route for our scraping proccess.
</p>
<p>
We could clearly see that our best option to get maximum data was in the book's page which contains huge amount of data.<br>
Right on first sight we could mark ourselves data which we knew we are going to use.<br>
The elements we saw right away:<br>
</p><img src="./images/3.png" /></p>
At this phase we asked ourselves 2 questions:<br>
<ol>
    <li>What is the exact data we wish to scrape?</li>
    <li>How can we easily access large amount of books which will present different types of books.</li>
</ol>
To move forward we first knew we need to know what exactly we want to scrape for each book.<br>
We could easily get from the book's page the following list:<br>
<ul>
    <li>title</li>
    <li>rating</li>
    <li>ratings count</li>
    <li>reviews count</li>
    <li>book format</li>
    <li>pages count</li>
    <li>main language</li>
    <li>editions count</li>
    <li>has awards - The most important field for us since we based our whole research on that page</li>
    <li>The top tagged genres for book - Which we decided 3 will be enough</li>
</ul>
But this was not enough information, we were not satisfied with that, so we continued to look for some more books and that's were we found some books had a field called "original name" - We had a feeling that this field my present a good change, where book did not succeed in onr name but did on another, therefore we added this field to the list.<br>
Yet we knew this was still not enough data, so we explored pages connected to the book's URL page to see what data is available from each book page.<br>
The first thing we wanted to have is connection to the author, we knew that book's success has to be somehow also related to the author that wrote the book.<br>
Luckily for us - The name of the author was also link to the author's page.
</p><img src="./images/4.png" /><p>
The exploration in the author's page then began.<br>
While we ere exploring the author's page we found the following data which we decided can be helpful for us in order to create a good prediction method.
<ul>
    <li>author name</li>
    <li>author followers count</li>
    <li>author books count</li>
    <li>author avg rating</li>
    <li>author ratings count</li>
    <li>author reviews count</li>
</ul>
</p><img src="./images/5.png" /><img src="./images/6.png" /><p>
Now felt more confident about the data we have, but then we recalled one field that caught our interest in book page, which it was the "Want to Read" button at the book's page.<br>
We wandered, is there any way we could get the amount of people interested in reading the book?<br>
Back in the book's page we pressed the "Want to Read" button, that revealed a new field of interest to us - "Currently reading".
</p><img src="./images/7.png" /><p>
But still, we did not knew how to get to the number of how many users want to read the book or currently reading the book.<br>
So we kept exploring the book's page up to the point where we pressed the "see top shelves..." hyperlink, there we could finally get the numbers we wanted, Since both the "to read" and "currently reading" were actually tagged in the shelves.
</p><img src="./images/8.png" /><h4>Great!</h4>
<p>
Now have all the data we want to scrape and we know the route from a book's page to the other pages which we can get the data from.<br>
That concludes both the first and the second questions we were asking ourselves.<br>
This is where we decided to create the first spider that scrape the data we agreed on.<br>
We inspected each and every elements we were looking for in the HTML tree of each page and the result led to this class:
</p><p><a id='book_spider_class'></id></p>
<h3>Book Spider Class</h3>
<p>
The book spider class is a tool which gets the book's url and the authentication session we are using and scrape the data from the book's page as well as from the author's page and the top shelves page (using another http request if needed for the other linked pages to the book's page).
</p>
Remider of the list of data and where are they scraped from:
<ul>
    <li>title - book page</li>
    <li>original title - book page</li>
    <li>rating - book page</li>
    <li>ratings count - book page</li>
    <li>reviews count - book page</li>
    <li>book format - book page</li>
    <li>pages count - book page</li>
    <li>main language - book page</li>
    <li>editions count - book page</li>
    <li>has awards - book page</li>
    <li>top tagged genre 1 - book page</li>
    <li>top tagged genre 2 - book page</li>
    <li>top tagged genre 3 - book page</li>
    <li>to read count - books top shelves</li>
    <li>currently reading count - books top shelves</li>
    <li>author name - author page</li>
    <li>author followers count - author page</li>
    <li>author books count - author page</li>
    <li>author avg rating - author page</li>
    <li>author ratings count - author page</li>
    <li>author reviews count - author page</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BookSpider</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">scrape_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;scrapes book data and returns object or something&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GoodReadsBookSpider</span><span class="p">(</span><span class="n">BookSpider</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">book_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">book_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no book_url provided&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">book_url</span> <span class="o">=</span> <span class="n">book_url</span>
        <span class="k">if</span> <span class="n">session</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no session provided&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">session</span>
    
    <span class="k">def</span> <span class="nf">__get_item_from_book_data_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">book_data_box</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;bookDataBox&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">book_data_box</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">book_data_box</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;clearFloats&quot;</span><span class="p">}):</span>
            <span class="n">row_title</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;infoBoxRowTitle&quot;</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">row_title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="o">==</span> <span class="n">title</span><span class="p">:</span>
                <span class="n">row_value</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;infoBoxRowItem&quot;</span><span class="p">})</span>
                <span class="k">return</span> <span class="n">row_value</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="k">def</span> <span class="nf">__get_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">book_title</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;h1&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;bookTitle&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">book_title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">book_title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">title</span>
    
    <span class="k">def</span> <span class="nf">__get_original_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_item_from_book_data_box</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;Original Title&quot;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__get_rating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">rating_tag</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;ratingValue&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">rating_tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">rating_tag</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">FLOAT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__get_ratings_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">rating_tag</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;meta&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;ratingCount&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">rating_tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">rating_text</span> <span class="o">=</span> <span class="n">rating_tag</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">rating_text</span><span class="p">,</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">INT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__get_reviews_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">review_tag</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;meta&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;reviewCount&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">review_tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">review_text</span> <span class="o">=</span> <span class="n">review_tag</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">review_text</span><span class="p">,</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">INT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__get_book_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">book_format_tag</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;bookFormat&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">book_format_tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">book_format_tag</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">__get_pages_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">pages_num_tag</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;numberOfPages&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">pages_num_tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">pages_num_text</span> <span class="o">=</span> <span class="n">pages_num_tag</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">pages_num_text</span><span class="p">,</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">INT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__get_main_language</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">lang_tag</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;inLanguage&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">lang_tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">lang</span> <span class="o">=</span> <span class="n">lang_tag</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">lang</span>
        
    <span class="k">def</span> <span class="nf">__get_editions_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">editions_tag</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;otherEditionsLink&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">editions_tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="n">editions_a</span> <span class="o">=</span> <span class="n">editions_tag</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">extract_parentheses_value</span><span class="p">(</span><span class="n">editions_a</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">INT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__get_has_awards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_item_from_book_data_box</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;Literary Awards&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        
    <span class="k">def</span> <span class="nf">__get_top_tagged_genre</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">place</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">generes_tags</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;actionLinkLite&quot;</span><span class="p">,</span> <span class="s2">&quot;bookPageGenreLink&quot;</span><span class="p">]},</span> <span class="n">href</span><span class="o">=</span><span class="k">lambda</span> <span class="n">value</span><span class="p">:</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/genres/&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">place</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">generes_tags</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">genre_tag</span> <span class="o">=</span> <span class="n">generes_tags</span><span class="p">[</span><span class="n">place</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">genre_tag</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">genre_tag</span>
    
    <span class="c1"># shelves</span>
    
    <span class="k">def</span> <span class="nf">__get_shelf_stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">self_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;shelfStat&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">stat</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
            <span class="n">stat_name</span> <span class="o">=</span> <span class="n">stat</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mediumText&quot;</span><span class="p">,</span> <span class="s2">&quot;actionLinkLite&quot;</span><span class="p">]})</span>
            <span class="k">if</span> <span class="n">stat_name</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="o">==</span> <span class="n">self_name</span><span class="p">:</span>
                <span class="n">stat_val</span> <span class="o">=</span> <span class="n">stat</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;smallText&quot;</span><span class="p">})</span>
                <span class="n">stat_val_text</span> <span class="o">=</span> <span class="n">stat_val</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stat_val_text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="s2">&quot; &quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stat_val_text</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="n">stat_val_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="k">def</span> <span class="nf">__get_user_reading_shelves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">shelves_anchor</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="k">lambda</span> <span class="n">value</span><span class="p">:</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/book/shelves/&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">shelves_anchor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;to_read_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="n">shelves_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.goodreads.com/</span><span class="si">{</span><span class="n">shelves_anchor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">shelves_response</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">get_request_with_retry</span><span class="p">(</span><span class="n">shelves_url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="n">to_read_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_to_read_count</span><span class="p">(</span><span class="n">shelves_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> 
        <span class="n">currently_reading_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_currently_reading_count</span><span class="p">(</span><span class="n">shelves_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;to_read_count&quot;</span><span class="p">:</span> <span class="n">to_read_count</span><span class="p">,</span> <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">:</span> <span class="n">currently_reading_count</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">__get_to_read_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">read_count_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_shelf_stat</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;to-read&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">read_count_str</span><span class="p">,</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">INT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__get_currently_reading_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">read_count_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_shelf_stat</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;currently-reading&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">read_count_str</span><span class="p">,</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">INT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
        
    <span class="c1"># author</span>
    
    <span class="k">def</span> <span class="nf">__get_author_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">author_name_container</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;authorName__container&quot;</span><span class="p">})</span>
        <span class="n">author_name_url_tag</span> <span class="o">=</span> <span class="n">author_name_container</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;authorName&quot;</span><span class="p">,</span> <span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;url&quot;</span><span class="p">})</span>
        <span class="n">author_href</span> <span class="o">=</span> <span class="n">author_name_url_tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)</span>
        <span class="n">author_response</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">get_request_with_retry</span><span class="p">(</span><span class="n">author_href</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
        
        <span class="n">author_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_author_name</span><span class="p">(</span><span class="n">author_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">author_followers_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_author_followers_count</span><span class="p">(</span><span class="n">author_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">author_books_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_author_books_count</span><span class="p">(</span><span class="n">author_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">author_avg_rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_author_avg_rating</span><span class="p">(</span><span class="n">author_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">author_ratings_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_author_author_ratings_count</span><span class="p">(</span><span class="n">author_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">author_reviews_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_author_author_reviews_count</span><span class="p">(</span><span class="n">author_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;author_name&quot;</span><span class="p">:</span> <span class="n">author_name</span><span class="p">,</span>
            <span class="s2">&quot;author_followers_count&quot;</span><span class="p">:</span> <span class="n">author_followers_count</span><span class="p">,</span>
            <span class="s2">&quot;author_books_count&quot;</span><span class="p">:</span> <span class="n">author_books_count</span><span class="p">,</span>
            <span class="s2">&quot;author_avg_rating&quot;</span><span class="p">:</span> <span class="n">author_avg_rating</span><span class="p">,</span>
            <span class="s2">&quot;author_ratings_count&quot;</span><span class="p">:</span> <span class="n">author_ratings_count</span><span class="p">,</span>
            <span class="s2">&quot;author_reviews_count&quot;</span><span class="p">:</span> <span class="n">author_reviews_count</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">__get_author_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">name_cont</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;h1&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;authorName&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">name_cont</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name_cont</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">name</span>
        
    <span class="k">def</span> <span class="nf">__get_author_followers_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">author_followers_count_el</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="k">lambda</span> <span class="n">value</span><span class="p">:</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/author_followings?&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">author_followers_count_el</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">author_followers_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">extract_parentheses_value</span><span class="p">(</span><span class="n">author_followers_count_el</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">INT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">author_followers_count</span>
        
    <span class="k">def</span> <span class="nf">__get_author_books_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">author_books_count_parent</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;hreview-aggregate&quot;</span><span class="p">,</span> <span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;aggregateRating&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">author_books_count_parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">distinct_works_text_container</span><span class="p">:</span> <span class="n">HtmlTag</span> <span class="o">=</span> <span class="n">author_books_count_parent</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="k">lambda</span> <span class="n">value</span><span class="p">:</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/author/list/&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">distinct_works_text_container</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">INT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__get_author_avg_rating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;ratingValue&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">cont</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">author_average_rating</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">FLOAT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">author_average_rating</span>
        
    <span class="k">def</span> <span class="nf">__get_author_author_ratings_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;ratingCount&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">cont</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">author_ratings_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">),</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">INT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">author_ratings_count</span>
        
    <span class="k">def</span> <span class="nf">__get_author_author_reviews_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;itemprop&quot;</span><span class="p">:</span> <span class="s2">&quot;reviewCount&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">cont</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">author_reviews_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">string_to_number</span><span class="p">(</span><span class="n">cont</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">),</span> <span class="n">NumberTypesConverters</span><span class="o">.</span><span class="n">INT</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">author_reviews_count</span>
        
    <span class="k">def</span> <span class="nf">scrape_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">book_page_response</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">get_request_with_retry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">book_url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_title</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">original_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_original_title</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_rating</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> 
        <span class="n">ratings_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_ratings_count</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">reviews_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_reviews_count</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>     
        <span class="n">book_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_book_format</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">pages_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_pages_count</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> 
        <span class="n">main_language</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_main_language</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">editions_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_editions_count</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> 
        <span class="n">has_awards</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_has_awards</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">top_tagged_genre_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_top_tagged_genre</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">top_tagged_genre_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_top_tagged_genre</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">top_tagged_genre_3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_top_tagged_genre</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>     
        
        <span class="n">user_reading_shelves</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_user_reading_shelves</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">author_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_author_info</span><span class="p">(</span><span class="n">book_page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>   
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
            <span class="s2">&quot;original_title&quot;</span><span class="p">:</span> <span class="n">original_title</span><span class="p">,</span>
            <span class="s2">&quot;rating&quot;</span><span class="p">:</span> <span class="n">rating</span><span class="p">,</span>
            <span class="s2">&quot;ratings_count&quot;</span><span class="p">:</span> <span class="n">ratings_count</span><span class="p">,</span>
            <span class="s2">&quot;reviews_count&quot;</span><span class="p">:</span> <span class="n">reviews_count</span><span class="p">,</span>
            <span class="s2">&quot;book_format&quot;</span><span class="p">:</span> <span class="n">book_format</span><span class="p">,</span>
            <span class="s2">&quot;pages_count&quot;</span><span class="p">:</span> <span class="n">pages_count</span><span class="p">,</span>
            <span class="s2">&quot;main_language&quot;</span><span class="p">:</span> <span class="n">main_language</span><span class="p">,</span>
            <span class="s2">&quot;editions_count&quot;</span><span class="p">:</span> <span class="n">editions_count</span><span class="p">,</span>
            <span class="s2">&quot;has_awards&quot;</span><span class="p">:</span> <span class="n">has_awards</span><span class="p">,</span>
            <span class="s2">&quot;top_tagged_genre_1&quot;</span><span class="p">:</span> <span class="n">top_tagged_genre_1</span><span class="p">,</span>
            <span class="s2">&quot;top_tagged_genre_2&quot;</span><span class="p">:</span> <span class="n">top_tagged_genre_2</span><span class="p">,</span>
            <span class="s2">&quot;top_tagged_genre_3&quot;</span><span class="p">:</span> <span class="n">top_tagged_genre_3</span><span class="p">,</span>
            <span class="s2">&quot;to_read_count&quot;</span><span class="p">:</span> <span class="n">user_reading_shelves</span><span class="p">[</span><span class="s2">&quot;to_read_count&quot;</span><span class="p">],</span>
            <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">:</span> <span class="n">user_reading_shelves</span><span class="p">[</span><span class="s2">&quot;currently_reading_count&quot;</span><span class="p">],</span>
            <span class="s2">&quot;author_name&quot;</span><span class="p">:</span> <span class="n">author_info</span><span class="p">[</span><span class="s2">&quot;author_name&quot;</span><span class="p">],</span>
            <span class="s2">&quot;author_followers_count&quot;</span><span class="p">:</span> <span class="n">author_info</span><span class="p">[</span><span class="s2">&quot;author_followers_count&quot;</span><span class="p">],</span>
            <span class="s2">&quot;author_books_count&quot;</span><span class="p">:</span> <span class="n">author_info</span><span class="p">[</span><span class="s2">&quot;author_books_count&quot;</span><span class="p">],</span>
            <span class="s2">&quot;author_avg_rating&quot;</span><span class="p">:</span> <span class="n">author_info</span><span class="p">[</span><span class="s2">&quot;author_avg_rating&quot;</span><span class="p">],</span>
            <span class="s2">&quot;author_ratings_count&quot;</span><span class="p">:</span> <span class="n">author_info</span><span class="p">[</span><span class="s2">&quot;author_ratings_count&quot;</span><span class="p">],</span>
            <span class="s2">&quot;author_reviews_count&quot;</span><span class="p">:</span> <span class="n">author_info</span><span class="p">[</span><span class="s2">&quot;author_reviews_count&quot;</span><span class="p">]</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p><a id='scraping_route_creation'></a></p>
<h3>Creating the route for successful scraping</h3>
<p>
Now what left was just to find the way to access a large amount of different types of books.<br>
So we went on and thought about what could be the best way to get different types of books? Genres of course!<br>
Great, We know how to get a great scale of books, So we decided to check how does the genres page looks like when exploring all the genres.
</p><img src="./images/9.png" /><p>
This is the page we found out there.
</p><img src="./images/10.png" /><p>
Inside a genre we could see the access to book links but we were not satisfied with the way we can access book link from the generes page - The coverWrapper class was too generic and we had no access to large amount of books.
</p><img src="./images/11.png" /><p>
Exploration of the genere page led to this button:
</p><img src="./images/12.png" /><p>
Which this link provided us with the solution to all of our problems.<br>
This page's URL built from easy to explore api links:<br>
<ul>
    <li><a href="https://www.goodreads.com/shelf/show" target="_blank">https://www.goodreads.com/shelf/show</a></li>
    <li>followed by the genre</li>
    <li>with ending of which page are you at</li>
</ul>
Example for a complete URL - <a href=https://www.goodreads.com/shelf/show/horror?page=2 target="_blank">https://www.goodreads.com/shelf/show/horror?page=2</a><br>
Moreover, accessing a book's page was easy from this page.
Last but not least we knew exactly how many books to expect each page since each shelf page holds up to 50 books per page.<img src="./images/13.png" /><p><a id='genre_spider'></a></p>
<h3>Genre Spider Class</h3>
<p>
Once we found out the right way to start scraping the data, now what's left is to create a genre spider which will handle browsing inside genres and help us getting the books easily.<br>
We built a Genre spider which gets a genre from a list of genres we decided, the spider handles the mechanism for fetching pages by genre and using books scrapers to store books data.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GenreSpider</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">scrape_books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_books</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">books_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;scrapes genre books data and returns dataframe&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GoodReadsGenreSpider</span><span class="p">(</span><span class="n">GenreSpider</span><span class="p">):</span>
    <span class="n">GENRE_EXPLORATION_URL</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.goodreads.com/shelf/show&quot;</span>
    <span class="n">PAGE_BOOKS_NUM</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">GOOD_READS_DEFINED_GENRE_MAX</span> <span class="o">=</span> <span class="mi">100_000</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genre_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">genre_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no genre_name provided&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genre_name</span> <span class="o">=</span> <span class="n">genre_name</span>
        <span class="k">if</span> <span class="n">session</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no session provided&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">session</span>
    
    <span class="k">def</span> <span class="nf">__get_page_books</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">html</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
        <span class="n">soup</span><span class="p">:</span> <span class="n">BeautifulSoup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">books_url_tags</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;bookTitle&quot;</span><span class="p">})</span>
        <span class="n">books</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">book_url_tag_tag</span> <span class="ow">in</span> <span class="n">books_url_tags</span><span class="p">:</span>
            <span class="n">book_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.goodreads.com</span><span class="si">{</span><span class="n">book_url_tag_tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">bs</span><span class="p">:</span> <span class="n">BookSpider</span> <span class="o">=</span> <span class="n">GoodReadsBookSpider</span><span class="p">(</span><span class="n">book_url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
            <span class="n">book</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">scrape_data</span><span class="p">()</span>
            <span class="n">books</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;genre=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">genre_name</span><span class="si">}</span><span class="s2">, new book has been fetched sucessfully, page scope: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">books</span><span class="p">)</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">books_url_tags</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">books</span>
        
    <span class="k">def</span> <span class="nf">scrape_books</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_books</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">books_offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">genre_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">GENRE_EXPLORATION_URL</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">genre_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">max_books</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_books</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GOOD_READS_DEFINED_GENRE_MAX</span>
        
        <span class="n">has_next</span> <span class="o">=</span> <span class="kc">True</span>
        
        <span class="n">page</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">books_offset</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">PAGE_BOOKS_NUM</span><span class="p">:</span>
            <span class="n">page</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">books_offset</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">PAGE_BOOKS_NUM</span><span class="p">)</span>
        
        <span class="n">books</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">books</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_books</span> <span class="ow">and</span> <span class="n">has_next</span><span class="p">:</span>
            <span class="n">page_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">genre_url</span><span class="si">}</span><span class="s2">?page=</span><span class="si">{</span><span class="n">page</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fetching genre=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">genre_name</span><span class="si">}</span><span class="s2">, page=</span><span class="si">{</span><span class="n">page</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">page</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">page_response</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">get_request_with_retry</span><span class="p">(</span><span class="n">page_url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">page_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
                <span class="n">has_next</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">continue</span>
            <span class="n">page_books</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_page_books</span><span class="p">(</span><span class="n">page_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">page_books</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">PAGE_BOOKS_NUM</span><span class="p">:</span>
                <span class="n">has_next</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">books</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">page_books</span><span class="p">)</span>

            
                
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">books</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a id='scraping'></a></p>
<h2>Scraping - Let's start scraping</h2>
<p>
    But before we started scraping there was something we wanted to improve in our scraping model.<br>
    Because scraping is a lot of IO and different genres are not dependent, in order to have better network utilization we have decided to use multi-threading.<br>
    We did not want to overload the site and harm other users experience with over-requesting, however we wanted to decrease our scraping time by scraping multiple genres at the same time.<br>
    But what is the right number of threads that will remain balance between faster scraping and not causing over-requesting from the website which will also delay the server's response time?<br>
    The best practice was by doing "trial and error" here are the trials we did:<br>
    <ul>
        <li>2 Threads simultaneously - did not improve the scraping time to our satisfaction.</li>
        <li>All Threads simultaneously (17 threads) - The server was overloaded and we did not get responses in a decent time.</li>
        <li>10 Threads simultaneously - As we suspected it was still too much for the server to handle.</li>
        <li>5 Threads simultaneously - The server response time was as fast as send single threaded request.</li>
    </ul>
    In conclusion we ran 5 threads which were scraping 5 different genres at the same time.
</p>    
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">threading</span>

<span class="k">def</span> <span class="nf">explore_genre</span><span class="p">(</span><span class="n">genre</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start working on genre: </span><span class="si">{</span><span class="n">genre</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gs</span><span class="p">:</span> <span class="n">GenreSpider</span> <span class="o">=</span> <span class="n">GoodReadsGenreSpider</span><span class="p">(</span><span class="n">genre</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>
    <span class="n">genre_df</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">scrape_books</span><span class="p">(</span><span class="n">max_books</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">genre</span><span class="si">}</span><span class="s2">_books&quot;</span>
    <span class="n">genre_df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./books_by_genres/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;work on genre: </span><span class="si">{</span><span class="n">genre</span><span class="si">}</span><span class="s2"> has been finished&quot;</span><span class="p">)</span>

<span class="n">target_genres_to_explore</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;fantasy&quot;</span><span class="p">,</span>
    <span class="s2">&quot;crime&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fiction&quot;</span><span class="p">,</span>
    <span class="s2">&quot;horror&quot;</span><span class="p">,</span>
    <span class="s2">&quot;manga&quot;</span><span class="p">,</span>
    <span class="s2">&quot;psychology&quot;</span><span class="p">,</span>
    <span class="s2">&quot;travel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;thriller&quot;</span><span class="p">,</span>
    <span class="s2">&quot;adult&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sport&quot;</span><span class="p">,</span>
    <span class="s2">&quot;science&quot;</span><span class="p">,</span>
    <span class="s2">&quot;science-fiction&quot;</span><span class="p">,</span>
    <span class="s2">&quot;biography&quot;</span><span class="p">,</span>
    <span class="s2">&quot;self-help&quot;</span><span class="p">,</span>
    <span class="s2">&quot;religion&quot;</span><span class="p">,</span>
    <span class="s2">&quot;history&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cookbooks&quot;</span>
<span class="p">]</span>

<span class="n">MAX_CONCURRENTLY</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">genres_buckets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_genres_to_explore</span><span class="p">):</span>
    <span class="n">genres_buckets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target_genres_to_explore</span><span class="p">[</span><span class="n">offset</span><span class="p">:</span><span class="n">MAX_CONCURRENTLY</span> <span class="o">+</span> <span class="n">offset</span><span class="p">])</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="n">MAX_CONCURRENTLY</span>

<span class="k">for</span> <span class="n">genres</span> <span class="ow">in</span> <span class="n">genres_buckets</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start genre bucket: </span><span class="si">{</span><span class="n">genres</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">genres</span><span class="p">:</span>
        <span class="n">threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">explore_genre</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">genre</span><span class="p">,)))</span>

    <span class="k">for</span> <span class="n">thread</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">thread</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;end genre bucket: </span><span class="si">{</span><span class="n">genres</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;done all target genres exploration&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>note: accidently restarted output, won&#39;t run this long scraping stage again
</pre></div>
</div>
</div>
</div>
<p><a id='first_crawl'></a></p>
<h3>First Crawl Conclusion</h3>
<p>
As can be seen, in the logs above, although at the start, we have set boundary of 1000 books at max for each genre, it seems like some of the genres are having just 6 pages and such.<br>
You can see it below, as the travel books rows count is below 1000 (below 20 pages)
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_genre_with_low_books_number_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./books_by_genres/travel_books&quot;</span><span class="p">)</span>
<span class="n">example_genre_with_low_books_number_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(299, 21)
</pre></div>
</div>
</div>
</div>
<h3>First Crawl Conclusion - Continue</h3>
<p>
In addition, after further investigating our scrape target website, we see that all genres have up to 25 pages (1250 books) to browse (AT MAX).
Therefore, We are going to run the scrape flow again so we fetch every book we are able to (by selected genres), but this time change the genreSpider class to support offset, so it won't re-read the same books again, AND we will append the books this time to the existing parquet file, instead of overwriting them... other than that, same approach.
NOTE: original Class as been updated.
</p>
<ul>
    <li>
        Same Target Genres, <strong>Altough, only the ones which have any books left to scrape. (the genres which has 1000 books in their df (prev max)</strong>
    </li>
    <li>
        same multi-threades approach
    </li>
</ul><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># getting only relevant genres (to better perform I/O utilization) </span>
<span class="c1"># (prevent case of just 2 genres in same threading group with idles genres - waste of time)</span>
<span class="n">new_target_genres_to_explore</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">target_genres_to_explore</span><span class="p">:</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">genre</span><span class="si">}</span><span class="s2">_books&quot;</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;./books_by_genres/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">prev_max</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">prev_max</span><span class="p">:</span>
        <span class="n">new_target_genres_to_explore</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">genre</span><span class="p">)</span>

<span class="c1"># again, bucket the genres up..        </span>
<span class="n">MAX_CONCURRENTLY</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># same as before</span>

<span class="n">genres_buckets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_target_genres_to_explore</span><span class="p">):</span>
    <span class="n">genres_buckets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target_genres_to_explore</span><span class="p">[</span><span class="n">offset</span><span class="p">:</span><span class="n">MAX_CONCURRENTLY</span> <span class="o">+</span> <span class="n">offset</span><span class="p">])</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="n">MAX_CONCURRENTLY</span>

<span class="c1"># just passing offset to scraper instead of max...</span>
<span class="k">def</span> <span class="nf">explore_genre</span><span class="p">(</span><span class="n">genre</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start working on genre: </span><span class="si">{</span><span class="n">genre</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">gs</span><span class="p">:</span> <span class="n">GenreSpider</span> <span class="o">=</span> <span class="n">GoodReadsGenreSpider</span><span class="p">(</span><span class="n">genre</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>
    <span class="n">genre_df</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">scrape_books</span><span class="p">(</span><span class="n">books_offset</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">genre_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="c1"># already fetched all this genre books, empty df.</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">genre</span><span class="si">}</span><span class="s2">_books&quot;</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;./books_by_genres/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="c1"># reading df and concat instead of overwrting prev one...</span>
    <span class="n">prev_genre_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">genre_books</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">prev_genre_df</span><span class="p">,</span> <span class="n">genre_df</span><span class="p">])</span>
    <span class="n">genre_books</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;work on genre: </span><span class="si">{</span><span class="n">genre</span><span class="si">}</span><span class="s2"> has been finished&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">genres</span> <span class="ow">in</span> <span class="n">genres_buckets</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start genre bucket: </span><span class="si">{</span><span class="n">genres</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">genres</span><span class="p">:</span>
        <span class="n">threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">explore_genre</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">genre</span><span class="p">,)))</span>

    <span class="k">for</span> <span class="n">thread</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">thread</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;end genre bucket: </span><span class="si">{</span><span class="n">genres</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;done all target genres exploration&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>start genre bucket: [&#39;fantasy&#39;, &#39;crime&#39;, &#39;fiction&#39;, &#39;horror&#39;, &#39;manga&#39;]
start working on genre: fantasy
fetching genre=fantasy, page=21
start working on genre: crime
fetching genre=crime, page=21
start working on genre: fiction
fetching genre=fiction, page=21
start working on genre: horror
fetching genre=horror, page=21
start working on genre: manga
fetching genre=manga, page=21
genre=manga, new book has been fetched sucessfully, page scope: 1/50
genre=horror, new book has been fetched sucessfully, page scope: 1/50
genre=fiction, new book has been fetched sucessfully, page scope: 1/50
genre=crime, new book has been fetched sucessfully, page scope: 1/50
genre=fantasy, new book has been fetched sucessfully, page scope: 1/50
genre=manga, new book has been fetched sucessfully, page scope: 2/50
genre=horror, new book has been fetched sucessfully, page scope: 2/50
genre=fiction, new book has been fetched sucessfully, page scope: 2/50
genre=crime, new book has been fetched sucessfully, page scope: 2/50
genre=fantasy, new book has been fetched sucessfully, page scope: 2/50
genre=manga, new book has been fetched sucessfully, page scope: 3/50
genre=fiction, new book has been fetched sucessfully, page scope: 3/50
genre=horror, new book has been fetched sucessfully, page scope: 3/50
genre=crime, new book has been fetched sucessfully, page scope: 3/50
genre=fantasy, new book has been fetched sucessfully, page scope: 3/50
genre=manga, new book has been fetched sucessfully, page scope: 4/50
genre=fiction, new book has been fetched sucessfully, page scope: 4/50
genre=horror, new book has been fetched sucessfully, page scope: 4/50
genre=crime, new book has been fetched sucessfully, page scope: 4/50
genre=manga, new book has been fetched sucessfully, page scope: 5/50
genre=fantasy, new book has been fetched sucessfully, page scope: 4/50
genre=fiction, new book has been fetched sucessfully, page scope: 5/50
genre=horror, new book has been fetched sucessfully, page scope: 5/50
genre=crime, new book has been fetched sucessfully, page scope: 5/50
genre=manga, new book has been fetched sucessfully, page scope: 6/50
genre=fantasy, new book has been fetched sucessfully, page scope: 5/50
genre=fiction, new book has been fetched sucessfully, page scope: 6/50
genre=crime, new book has been fetched sucessfully, page scope: 6/50
genre=manga, new book has been fetched sucessfully, page scope: 7/50
genre=horror, new book has been fetched sucessfully, page scope: 6/50
genre=fiction, new book has been fetched sucessfully, page scope: 7/50
genre=fantasy, new book has been fetched sucessfully, page scope: 6/50
genre=crime, new book has been fetched sucessfully, page scope: 7/50
genre=manga, new book has been fetched sucessfully, page scope: 8/50
genre=horror, new book has been fetched sucessfully, page scope: 7/50
genre=fiction, new book has been fetched sucessfully, page scope: 8/50
genre=horror, new book has been fetched sucessfully, page scope: 8/50
genre=manga, new book has been fetched sucessfully, page scope: 9/50
genre=crime, new book has been fetched sucessfully, page scope: 8/50
genre=fantasy, new book has been fetched sucessfully, page scope: 7/50
genre=fiction, new book has been fetched sucessfully, page scope: 9/50
genre=manga, new book has been fetched sucessfully, page scope: 10/50
genre=crime, new book has been fetched sucessfully, page scope: 9/50
genre=horror, new book has been fetched sucessfully, page scope: 9/50
genre=fantasy, new book has been fetched sucessfully, page scope: 8/50
genre=fiction, new book has been fetched sucessfully, page scope: 10/50
genre=manga, new book has been fetched sucessfully, page scope: 11/50
genre=crime, new book has been fetched sucessfully, page scope: 10/50
genre=horror, new book has been fetched sucessfully, page scope: 10/50
genre=fiction, new book has been fetched sucessfully, page scope: 11/50
genre=fantasy, new book has been fetched sucessfully, page scope: 9/50
genre=manga, new book has been fetched sucessfully, page scope: 12/50
genre=crime, new book has been fetched sucessfully, page scope: 11/50
genre=horror, new book has been fetched sucessfully, page scope: 11/50
genre=fiction, new book has been fetched sucessfully, page scope: 12/50
genre=fantasy, new book has been fetched sucessfully, page scope: 10/50
genre=manga, new book has been fetched sucessfully, page scope: 13/50
genre=horror, new book has been fetched sucessfully, page scope: 12/50
genre=crime, new book has been fetched sucessfully, page scope: 12/50
genre=fiction, new book has been fetched sucessfully, page scope: 13/50
genre=fantasy, new book has been fetched sucessfully, page scope: 11/50
genre=manga, new book has been fetched sucessfully, page scope: 14/50
genre=horror, new book has been fetched sucessfully, page scope: 13/50
genre=fiction, new book has been fetched sucessfully, page scope: 14/50
genre=crime, new book has been fetched sucessfully, page scope: 13/50
genre=fantasy, new book has been fetched sucessfully, page scope: 12/50
genre=manga, new book has been fetched sucessfully, page scope: 15/50
genre=horror, new book has been fetched sucessfully, page scope: 14/50
genre=fiction, new book has been fetched sucessfully, page scope: 15/50
genre=crime, new book has been fetched sucessfully, page scope: 14/50
genre=fantasy, new book has been fetched sucessfully, page scope: 13/50
genre=manga, new book has been fetched sucessfully, page scope: 16/50
genre=horror, new book has been fetched sucessfully, page scope: 15/50
genre=fiction, new book has been fetched sucessfully, page scope: 16/50
genre=crime, new book has been fetched sucessfully, page scope: 15/50
genre=fantasy, new book has been fetched sucessfully, page scope: 14/50
genre=manga, new book has been fetched sucessfully, page scope: 17/50
genre=horror, new book has been fetched sucessfully, page scope: 16/50
genre=crime, new book has been fetched sucessfully, page scope: 16/50
genre=fantasy, new book has been fetched sucessfully, page scope: 15/50
genre=fiction, new book has been fetched sucessfully, page scope: 17/50
genre=manga, new book has been fetched sucessfully, page scope: 18/50
genre=horror, new book has been fetched sucessfully, page scope: 17/50
genre=crime, new book has been fetched sucessfully, page scope: 17/50
genre=fantasy, new book has been fetched sucessfully, page scope: 16/50
genre=manga, new book has been fetched sucessfully, page scope: 19/50
genre=fiction, new book has been fetched sucessfully, page scope: 18/50
genre=horror, new book has been fetched sucessfully, page scope: 18/50
genre=crime, new book has been fetched sucessfully, page scope: 18/50
genre=fantasy, new book has been fetched sucessfully, page scope: 17/50
genre=manga, new book has been fetched sucessfully, page scope: 20/50
genre=horror, new book has been fetched sucessfully, page scope: 19/50
genre=fiction, new book has been fetched sucessfully, page scope: 19/50
genre=crime, new book has been fetched sucessfully, page scope: 19/50
genre=fantasy, new book has been fetched sucessfully, page scope: 18/50
genre=manga, new book has been fetched sucessfully, page scope: 21/50
genre=fiction, new book has been fetched sucessfully, page scope: 20/50
genre=crime, new book has been fetched sucessfully, page scope: 20/50
genre=horror, new book has been fetched sucessfully, page scope: 20/50
genre=manga, new book has been fetched sucessfully, page scope: 22/50
genre=fiction, new book has been fetched sucessfully, page scope: 21/50
genre=fantasy, new book has been fetched sucessfully, page scope: 19/50
genre=crime, new book has been fetched sucessfully, page scope: 21/50
genre=horror, new book has been fetched sucessfully, page scope: 21/50
genre=manga, new book has been fetched sucessfully, page scope: 23/50
genre=fantasy, new book has been fetched sucessfully, page scope: 20/50
genre=crime, new book has been fetched sucessfully, page scope: 22/50
genre=fiction, new book has been fetched sucessfully, page scope: 22/50
genre=horror, new book has been fetched sucessfully, page scope: 22/50
genre=manga, new book has been fetched sucessfully, page scope: 24/50
genre=fantasy, new book has been fetched sucessfully, page scope: 21/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=crime, new book has been fetched sucessfully, page scope: 23/50
genre=manga, new book has been fetched sucessfully, page scope: 25/50
genre=fiction, new book has been fetched sucessfully, page scope: 23/50
genre=horror, new book has been fetched sucessfully, page scope: 23/50
genre=fantasy, new book has been fetched sucessfully, page scope: 22/50
genre=manga, new book has been fetched sucessfully, page scope: 26/50
genre=crime, new book has been fetched sucessfully, page scope: 24/50
genre=horror, new book has been fetched sucessfully, page scope: 24/50
genre=fiction, new book has been fetched sucessfully, page scope: 24/50
genre=fantasy, new book has been fetched sucessfully, page scope: 23/50
genre=manga, new book has been fetched sucessfully, page scope: 27/50
genre=crime, new book has been fetched sucessfully, page scope: 25/50
genre=fiction, new book has been fetched sucessfully, page scope: 25/50
genre=horror, new book has been fetched sucessfully, page scope: 25/50
genre=manga, new book has been fetched sucessfully, page scope: 28/50
genre=fantasy, new book has been fetched sucessfully, page scope: 24/50
genre=crime, new book has been fetched sucessfully, page scope: 26/50
genre=fiction, new book has been fetched sucessfully, page scope: 26/50
genre=horror, new book has been fetched sucessfully, page scope: 26/50
genre=crime, new book has been fetched sucessfully, page scope: 27/50
genre=fantasy, new book has been fetched sucessfully, page scope: 25/50
genre=horror, new book has been fetched sucessfully, page scope: 27/50
genre=fiction, new book has been fetched sucessfully, page scope: 27/50
genre=crime, new book has been fetched sucessfully, page scope: 28/50
genre=fantasy, new book has been fetched sucessfully, page scope: 26/50
genre=horror, new book has been fetched sucessfully, page scope: 28/50
genre=fiction, new book has been fetched sucessfully, page scope: 28/50
genre=crime, new book has been fetched sucessfully, page scope: 29/50
genre=fantasy, new book has been fetched sucessfully, page scope: 27/50
genre=fiction, new book has been fetched sucessfully, page scope: 29/50
genre=crime, new book has been fetched sucessfully, page scope: 30/50
genre=horror, new book has been fetched sucessfully, page scope: 29/50
genre=fantasy, new book has been fetched sucessfully, page scope: 28/50
genre=crime, new book has been fetched sucessfully, page scope: 31/50
genre=fiction, new book has been fetched sucessfully, page scope: 30/50
genre=horror, new book has been fetched sucessfully, page scope: 30/50
genre=fantasy, new book has been fetched sucessfully, page scope: 29/50
genre=crime, new book has been fetched sucessfully, page scope: 32/50
genre=horror, new book has been fetched sucessfully, page scope: 31/50
genre=fiction, new book has been fetched sucessfully, page scope: 31/50
genre=fantasy, new book has been fetched sucessfully, page scope: 30/50
genre=crime, new book has been fetched sucessfully, page scope: 33/50
genre=fiction, new book has been fetched sucessfully, page scope: 32/50
genre=horror, new book has been fetched sucessfully, page scope: 32/50
genre=fantasy, new book has been fetched sucessfully, page scope: 31/50
genre=crime, new book has been fetched sucessfully, page scope: 34/50
genre=manga, new book has been fetched sucessfully, page scope: 29/50
genre=fiction, new book has been fetched sucessfully, page scope: 33/50
genre=horror, new book has been fetched sucessfully, page scope: 33/50
genre=fantasy, new book has been fetched sucessfully, page scope: 32/50
genre=crime, new book has been fetched sucessfully, page scope: 35/50
genre=manga, new book has been fetched sucessfully, page scope: 30/50
genre=fiction, new book has been fetched sucessfully, page scope: 34/50
genre=fantasy, new book has been fetched sucessfully, page scope: 33/50
genre=horror, new book has been fetched sucessfully, page scope: 34/50
genre=crime, new book has been fetched sucessfully, page scope: 36/50
genre=manga, new book has been fetched sucessfully, page scope: 31/50
genre=fantasy, new book has been fetched sucessfully, page scope: 34/50
genre=horror, new book has been fetched sucessfully, page scope: 35/50
genre=manga, new book has been fetched sucessfully, page scope: 32/50
genre=fantasy, new book has been fetched sucessfully, page scope: 35/50
genre=crime, new book has been fetched sucessfully, page scope: 37/50
genre=horror, new book has been fetched sucessfully, page scope: 36/50
genre=manga, new book has been fetched sucessfully, page scope: 33/50
genre=fantasy, new book has been fetched sucessfully, page scope: 36/50
genre=horror, new book has been fetched sucessfully, page scope: 37/50
genre=crime, new book has been fetched sucessfully, page scope: 38/50
genre=manga, new book has been fetched sucessfully, page scope: 34/50
genre=crime, new book has been fetched sucessfully, page scope: 39/50
genre=horror, new book has been fetched sucessfully, page scope: 38/50
genre=manga, new book has been fetched sucessfully, page scope: 35/50
genre=fantasy, new book has been fetched sucessfully, page scope: 37/50
genre=crime, new book has been fetched sucessfully, page scope: 40/50
genre=manga, new book has been fetched sucessfully, page scope: 36/50
genre=fantasy, new book has been fetched sucessfully, page scope: 38/50
genre=horror, new book has been fetched sucessfully, page scope: 39/50
genre=manga, new book has been fetched sucessfully, page scope: 37/50
genre=horror, new book has been fetched sucessfully, page scope: 40/50
genre=crime, new book has been fetched sucessfully, page scope: 41/50
genre=fantasy, new book has been fetched sucessfully, page scope: 39/50
genre=manga, new book has been fetched sucessfully, page scope: 38/50
genre=horror, new book has been fetched sucessfully, page scope: 41/50
genre=crime, new book has been fetched sucessfully, page scope: 42/50
genre=fantasy, new book has been fetched sucessfully, page scope: 40/50
genre=manga, new book has been fetched sucessfully, page scope: 39/50
genre=fiction, new book has been fetched sucessfully, page scope: 35/50
genre=crime, new book has been fetched sucessfully, page scope: 43/50
genre=fantasy, new book has been fetched sucessfully, page scope: 41/50
genre=horror, new book has been fetched sucessfully, page scope: 42/50
genre=manga, new book has been fetched sucessfully, page scope: 40/50
genre=fiction, new book has been fetched sucessfully, page scope: 36/50
genre=crime, new book has been fetched sucessfully, page scope: 44/50
genre=fantasy, new book has been fetched sucessfully, page scope: 42/50
genre=horror, new book has been fetched sucessfully, page scope: 43/50
genre=manga, new book has been fetched sucessfully, page scope: 41/50
genre=fiction, new book has been fetched sucessfully, page scope: 37/50
genre=crime, new book has been fetched sucessfully, page scope: 45/50
genre=fantasy, new book has been fetched sucessfully, page scope: 43/50
genre=horror, new book has been fetched sucessfully, page scope: 44/50
genre=manga, new book has been fetched sucessfully, page scope: 42/50
genre=fiction, new book has been fetched sucessfully, page scope: 38/50
genre=fantasy, new book has been fetched sucessfully, page scope: 44/50
genre=crime, new book has been fetched sucessfully, page scope: 46/50
genre=horror, new book has been fetched sucessfully, page scope: 45/50
genre=manga, new book has been fetched sucessfully, page scope: 43/50
genre=fiction, new book has been fetched sucessfully, page scope: 39/50
genre=fantasy, new book has been fetched sucessfully, page scope: 45/50
genre=crime, new book has been fetched sucessfully, page scope: 47/50
genre=horror, new book has been fetched sucessfully, page scope: 46/50
genre=manga, new book has been fetched sucessfully, page scope: 44/50
genre=fiction, new book has been fetched sucessfully, page scope: 40/50
genre=manga, new book has been fetched sucessfully, page scope: 45/50
genre=crime, new book has been fetched sucessfully, page scope: 48/50
genre=horror, new book has been fetched sucessfully, page scope: 47/50
genre=fantasy, new book has been fetched sucessfully, page scope: 46/50
genre=fiction, new book has been fetched sucessfully, page scope: 41/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=crime, new book has been fetched sucessfully, page scope: 49/50
genre=manga, new book has been fetched sucessfully, page scope: 46/50
genre=fantasy, new book has been fetched sucessfully, page scope: 47/50
genre=horror, new book has been fetched sucessfully, page scope: 48/50
genre=fiction, new book has been fetched sucessfully, page scope: 42/50
genre=crime, new book has been fetched sucessfully, page scope: 50/50
fetching genre=crime, page=22
genre=manga, new book has been fetched sucessfully, page scope: 47/50
genre=fantasy, new book has been fetched sucessfully, page scope: 48/50
genre=horror, new book has been fetched sucessfully, page scope: 49/50
genre=fiction, new book has been fetched sucessfully, page scope: 43/50
genre=manga, new book has been fetched sucessfully, page scope: 48/50
genre=crime, new book has been fetched sucessfully, page scope: 1/50
genre=fantasy, new book has been fetched sucessfully, page scope: 49/50
genre=fiction, new book has been fetched sucessfully, page scope: 44/50
genre=manga, new book has been fetched sucessfully, page scope: 49/50
genre=horror, new book has been fetched sucessfully, page scope: 50/50
fetching genre=horror, page=22
genre=crime, new book has been fetched sucessfully, page scope: 2/50
genre=fantasy, new book has been fetched sucessfully, page scope: 50/50
fetching genre=fantasy, page=22
genre=fiction, new book has been fetched sucessfully, page scope: 45/50
genre=manga, new book has been fetched sucessfully, page scope: 50/50
fetching genre=manga, page=22
genre=crime, new book has been fetched sucessfully, page scope: 3/50
genre=horror, new book has been fetched sucessfully, page scope: 1/50
genre=fiction, new book has been fetched sucessfully, page scope: 46/50
genre=fantasy, new book has been fetched sucessfully, page scope: 1/50
genre=manga, new book has been fetched sucessfully, page scope: 1/50
genre=crime, new book has been fetched sucessfully, page scope: 4/50
genre=horror, new book has been fetched sucessfully, page scope: 2/50
genre=fiction, new book has been fetched sucessfully, page scope: 47/50
genre=fantasy, new book has been fetched sucessfully, page scope: 2/50
genre=manga, new book has been fetched sucessfully, page scope: 2/50
genre=fiction, new book has been fetched sucessfully, page scope: 48/50
genre=crime, new book has been fetched sucessfully, page scope: 5/50
genre=horror, new book has been fetched sucessfully, page scope: 3/50
genre=fantasy, new book has been fetched sucessfully, page scope: 3/50
genre=manga, new book has been fetched sucessfully, page scope: 3/50
genre=fiction, new book has been fetched sucessfully, page scope: 49/50
genre=crime, new book has been fetched sucessfully, page scope: 6/50
genre=horror, new book has been fetched sucessfully, page scope: 4/50
genre=manga, new book has been fetched sucessfully, page scope: 4/50
genre=fantasy, new book has been fetched sucessfully, page scope: 4/50
genre=fiction, new book has been fetched sucessfully, page scope: 50/50
fetching genre=fiction, page=22
genre=crime, new book has been fetched sucessfully, page scope: 7/50
genre=horror, new book has been fetched sucessfully, page scope: 5/50
genre=manga, new book has been fetched sucessfully, page scope: 5/50
genre=fantasy, new book has been fetched sucessfully, page scope: 5/50
genre=crime, new book has been fetched sucessfully, page scope: 8/50
genre=horror, new book has been fetched sucessfully, page scope: 6/50
genre=manga, new book has been fetched sucessfully, page scope: 6/50
genre=fantasy, new book has been fetched sucessfully, page scope: 6/50
genre=crime, new book has been fetched sucessfully, page scope: 9/50
genre=fiction, new book has been fetched sucessfully, page scope: 1/50
genre=horror, new book has been fetched sucessfully, page scope: 7/50
genre=manga, new book has been fetched sucessfully, page scope: 7/50
genre=crime, new book has been fetched sucessfully, page scope: 10/50
genre=fantasy, new book has been fetched sucessfully, page scope: 7/50
genre=fiction, new book has been fetched sucessfully, page scope: 2/50
genre=manga, new book has been fetched sucessfully, page scope: 8/50
genre=horror, new book has been fetched sucessfully, page scope: 8/50
genre=crime, new book has been fetched sucessfully, page scope: 11/50
genre=fantasy, new book has been fetched sucessfully, page scope: 8/50
genre=fiction, new book has been fetched sucessfully, page scope: 3/50
genre=manga, new book has been fetched sucessfully, page scope: 9/50
genre=crime, new book has been fetched sucessfully, page scope: 12/50
genre=horror, new book has been fetched sucessfully, page scope: 9/50
genre=fiction, new book has been fetched sucessfully, page scope: 4/50
genre=fantasy, new book has been fetched sucessfully, page scope: 9/50
genre=manga, new book has been fetched sucessfully, page scope: 10/50
genre=horror, new book has been fetched sucessfully, page scope: 10/50
genre=crime, new book has been fetched sucessfully, page scope: 13/50
genre=fiction, new book has been fetched sucessfully, page scope: 5/50
genre=fantasy, new book has been fetched sucessfully, page scope: 10/50
genre=manga, new book has been fetched sucessfully, page scope: 11/50
genre=crime, new book has been fetched sucessfully, page scope: 14/50
genre=horror, new book has been fetched sucessfully, page scope: 11/50
genre=fiction, new book has been fetched sucessfully, page scope: 6/50
genre=fantasy, new book has been fetched sucessfully, page scope: 11/50
genre=manga, new book has been fetched sucessfully, page scope: 12/50
genre=crime, new book has been fetched sucessfully, page scope: 15/50
genre=fiction, new book has been fetched sucessfully, page scope: 7/50
genre=horror, new book has been fetched sucessfully, page scope: 12/50
genre=fantasy, new book has been fetched sucessfully, page scope: 12/50
genre=manga, new book has been fetched sucessfully, page scope: 13/50
genre=crime, new book has been fetched sucessfully, page scope: 16/50
genre=fiction, new book has been fetched sucessfully, page scope: 8/50
genre=horror, new book has been fetched sucessfully, page scope: 13/50
genre=fantasy, new book has been fetched sucessfully, page scope: 13/50
genre=manga, new book has been fetched sucessfully, page scope: 14/50
genre=crime, new book has been fetched sucessfully, page scope: 17/50
genre=fiction, new book has been fetched sucessfully, page scope: 9/50
genre=horror, new book has been fetched sucessfully, page scope: 14/50
genre=manga, new book has been fetched sucessfully, page scope: 15/50
genre=crime, new book has been fetched sucessfully, page scope: 18/50
genre=fiction, new book has been fetched sucessfully, page scope: 10/50
genre=fantasy, new book has been fetched sucessfully, page scope: 14/50
genre=horror, new book has been fetched sucessfully, page scope: 15/50
genre=manga, new book has been fetched sucessfully, page scope: 16/50
genre=fiction, new book has been fetched sucessfully, page scope: 11/50
genre=crime, new book has been fetched sucessfully, page scope: 19/50
genre=fantasy, new book has been fetched sucessfully, page scope: 15/50
genre=horror, new book has been fetched sucessfully, page scope: 16/50
genre=manga, new book has been fetched sucessfully, page scope: 17/50
genre=fiction, new book has been fetched sucessfully, page scope: 12/50
genre=fantasy, new book has been fetched sucessfully, page scope: 16/50genre=crime, new book has been fetched sucessfully, page scope: 20/50

genre=horror, new book has been fetched sucessfully, page scope: 17/50
genre=manga, new book has been fetched sucessfully, page scope: 18/50
genre=fiction, new book has been fetched sucessfully, page scope: 13/50
genre=crime, new book has been fetched sucessfully, page scope: 21/50
genre=fantasy, new book has been fetched sucessfully, page scope: 17/50
genre=horror, new book has been fetched sucessfully, page scope: 18/50
genre=manga, new book has been fetched sucessfully, page scope: 19/50
genre=fiction, new book has been fetched sucessfully, page scope: 14/50
genre=crime, new book has been fetched sucessfully, page scope: 22/50
genre=fantasy, new book has been fetched sucessfully, page scope: 18/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=horror, new book has been fetched sucessfully, page scope: 19/50
genre=manga, new book has been fetched sucessfully, page scope: 20/50
genre=fiction, new book has been fetched sucessfully, page scope: 15/50
genre=crime, new book has been fetched sucessfully, page scope: 23/50
genre=horror, new book has been fetched sucessfully, page scope: 20/50
genre=fantasy, new book has been fetched sucessfully, page scope: 19/50
genre=manga, new book has been fetched sucessfully, page scope: 21/50
genre=crime, new book has been fetched sucessfully, page scope: 24/50
genre=fiction, new book has been fetched sucessfully, page scope: 16/50
genre=horror, new book has been fetched sucessfully, page scope: 21/50
genre=fantasy, new book has been fetched sucessfully, page scope: 20/50
genre=manga, new book has been fetched sucessfully, page scope: 22/50
genre=crime, new book has been fetched sucessfully, page scope: 25/50
genre=horror, new book has been fetched sucessfully, page scope: 22/50
genre=fiction, new book has been fetched sucessfully, page scope: 17/50
genre=manga, new book has been fetched sucessfully, page scope: 23/50
genre=crime, new book has been fetched sucessfully, page scope: 26/50
genre=fantasy, new book has been fetched sucessfully, page scope: 21/50
genre=fiction, new book has been fetched sucessfully, page scope: 18/50
genre=manga, new book has been fetched sucessfully, page scope: 24/50
genre=fantasy, new book has been fetched sucessfully, page scope: 22/50
genre=crime, new book has been fetched sucessfully, page scope: 27/50
genre=fiction, new book has been fetched sucessfully, page scope: 19/50
genre=manga, new book has been fetched sucessfully, page scope: 25/50
genre=fantasy, new book has been fetched sucessfully, page scope: 23/50
genre=crime, new book has been fetched sucessfully, page scope: 28/50
genre=manga, new book has been fetched sucessfully, page scope: 26/50
genre=fiction, new book has been fetched sucessfully, page scope: 20/50
genre=fantasy, new book has been fetched sucessfully, page scope: 24/50
genre=crime, new book has been fetched sucessfully, page scope: 29/50
genre=fiction, new book has been fetched sucessfully, page scope: 21/50
genre=manga, new book has been fetched sucessfully, page scope: 27/50
genre=crime, new book has been fetched sucessfully, page scope: 30/50
genre=fantasy, new book has been fetched sucessfully, page scope: 25/50
genre=fiction, new book has been fetched sucessfully, page scope: 22/50
genre=manga, new book has been fetched sucessfully, page scope: 28/50
genre=crime, new book has been fetched sucessfully, page scope: 31/50
genre=fiction, new book has been fetched sucessfully, page scope: 23/50
genre=fantasy, new book has been fetched sucessfully, page scope: 26/50
genre=manga, new book has been fetched sucessfully, page scope: 29/50
genre=crime, new book has been fetched sucessfully, page scope: 32/50
genre=fiction, new book has been fetched sucessfully, page scope: 24/50
genre=manga, new book has been fetched sucessfully, page scope: 30/50
genre=fantasy, new book has been fetched sucessfully, page scope: 27/50
genre=crime, new book has been fetched sucessfully, page scope: 33/50
genre=fiction, new book has been fetched sucessfully, page scope: 25/50
genre=manga, new book has been fetched sucessfully, page scope: 31/50
genre=fantasy, new book has been fetched sucessfully, page scope: 28/50
genre=horror, new book has been fetched sucessfully, page scope: 23/50
genre=crime, new book has been fetched sucessfully, page scope: 34/50
genre=fiction, new book has been fetched sucessfully, page scope: 26/50
genre=manga, new book has been fetched sucessfully, page scope: 32/50
genre=fantasy, new book has been fetched sucessfully, page scope: 29/50
genre=horror, new book has been fetched sucessfully, page scope: 24/50
genre=fiction, new book has been fetched sucessfully, page scope: 27/50
genre=crime, new book has been fetched sucessfully, page scope: 35/50
genre=manga, new book has been fetched sucessfully, page scope: 33/50
genre=fantasy, new book has been fetched sucessfully, page scope: 30/50
genre=crime, new book has been fetched sucessfully, page scope: 36/50
genre=horror, new book has been fetched sucessfully, page scope: 25/50
genre=manga, new book has been fetched sucessfully, page scope: 34/50
genre=fiction, new book has been fetched sucessfully, page scope: 28/50
genre=fantasy, new book has been fetched sucessfully, page scope: 31/50
genre=horror, new book has been fetched sucessfully, page scope: 26/50
genre=manga, new book has been fetched sucessfully, page scope: 35/50
genre=fiction, new book has been fetched sucessfully, page scope: 29/50
genre=crime, new book has been fetched sucessfully, page scope: 37/50
genre=fantasy, new book has been fetched sucessfully, page scope: 32/50
genre=manga, new book has been fetched sucessfully, page scope: 36/50
genre=horror, new book has been fetched sucessfully, page scope: 27/50
genre=crime, new book has been fetched sucessfully, page scope: 38/50genre=fiction, new book has been fetched sucessfully, page scope: 30/50

genre=fantasy, new book has been fetched sucessfully, page scope: 33/50
genre=manga, new book has been fetched sucessfully, page scope: 37/50
genre=horror, new book has been fetched sucessfully, page scope: 28/50
genre=fiction, new book has been fetched sucessfully, page scope: 31/50
genre=crime, new book has been fetched sucessfully, page scope: 39/50
genre=fantasy, new book has been fetched sucessfully, page scope: 34/50
genre=manga, new book has been fetched sucessfully, page scope: 38/50
genre=horror, new book has been fetched sucessfully, page scope: 29/50
genre=fiction, new book has been fetched sucessfully, page scope: 32/50
genre=crime, new book has been fetched sucessfully, page scope: 40/50
genre=fantasy, new book has been fetched sucessfully, page scope: 35/50
genre=manga, new book has been fetched sucessfully, page scope: 39/50
genre=horror, new book has been fetched sucessfully, page scope: 30/50
genre=fiction, new book has been fetched sucessfully, page scope: 33/50
genre=crime, new book has been fetched sucessfully, page scope: 41/50
genre=fantasy, new book has been fetched sucessfully, page scope: 36/50
genre=manga, new book has been fetched sucessfully, page scope: 40/50
genre=horror, new book has been fetched sucessfully, page scope: 31/50
genre=fiction, new book has been fetched sucessfully, page scope: 34/50
genre=crime, new book has been fetched sucessfully, page scope: 42/50
genre=fantasy, new book has been fetched sucessfully, page scope: 37/50
genre=manga, new book has been fetched sucessfully, page scope: 41/50
genre=horror, new book has been fetched sucessfully, page scope: 32/50
genre=fiction, new book has been fetched sucessfully, page scope: 35/50
genre=crime, new book has been fetched sucessfully, page scope: 43/50
genre=manga, new book has been fetched sucessfully, page scope: 42/50
genre=fantasy, new book has been fetched sucessfully, page scope: 38/50
genre=horror, new book has been fetched sucessfully, page scope: 33/50
genre=fiction, new book has been fetched sucessfully, page scope: 36/50
genre=crime, new book has been fetched sucessfully, page scope: 44/50
genre=manga, new book has been fetched sucessfully, page scope: 43/50
genre=fantasy, new book has been fetched sucessfully, page scope: 39/50
genre=fiction, new book has been fetched sucessfully, page scope: 37/50
genre=horror, new book has been fetched sucessfully, page scope: 34/50
genre=crime, new book has been fetched sucessfully, page scope: 45/50
genre=manga, new book has been fetched sucessfully, page scope: 44/50
genre=fantasy, new book has been fetched sucessfully, page scope: 40/50
genre=fiction, new book has been fetched sucessfully, page scope: 38/50
genre=horror, new book has been fetched sucessfully, page scope: 35/50
genre=crime, new book has been fetched sucessfully, page scope: 46/50
genre=manga, new book has been fetched sucessfully, page scope: 45/50
genre=fantasy, new book has been fetched sucessfully, page scope: 41/50
genre=fiction, new book has been fetched sucessfully, page scope: 39/50
genre=crime, new book has been fetched sucessfully, page scope: 47/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=horror, new book has been fetched sucessfully, page scope: 36/50
genre=manga, new book has been fetched sucessfully, page scope: 46/50
genre=fantasy, new book has been fetched sucessfully, page scope: 42/50
genre=fiction, new book has been fetched sucessfully, page scope: 40/50
genre=crime, new book has been fetched sucessfully, page scope: 48/50
genre=horror, new book has been fetched sucessfully, page scope: 37/50
genre=manga, new book has been fetched sucessfully, page scope: 47/50
genre=crime, new book has been fetched sucessfully, page scope: 49/50
genre=fiction, new book has been fetched sucessfully, page scope: 41/50
genre=fantasy, new book has been fetched sucessfully, page scope: 43/50
genre=manga, new book has been fetched sucessfully, page scope: 48/50
genre=horror, new book has been fetched sucessfully, page scope: 38/50
genre=fiction, new book has been fetched sucessfully, page scope: 42/50
genre=crime, new book has been fetched sucessfully, page scope: 50/50
fetching genre=crime, page=23
genre=fantasy, new book has been fetched sucessfully, page scope: 44/50
genre=manga, new book has been fetched sucessfully, page scope: 49/50
genre=horror, new book has been fetched sucessfully, page scope: 39/50
genre=fiction, new book has been fetched sucessfully, page scope: 43/50
genre=manga, new book has been fetched sucessfully, page scope: 50/50
fetching genre=manga, page=23
genre=fantasy, new book has been fetched sucessfully, page scope: 45/50
genre=crime, new book has been fetched sucessfully, page scope: 1/50
genre=horror, new book has been fetched sucessfully, page scope: 40/50
genre=fiction, new book has been fetched sucessfully, page scope: 44/50
genre=fantasy, new book has been fetched sucessfully, page scope: 46/50
genre=manga, new book has been fetched sucessfully, page scope: 1/50
genre=crime, new book has been fetched sucessfully, page scope: 2/50
genre=horror, new book has been fetched sucessfully, page scope: 41/50
genre=fantasy, new book has been fetched sucessfully, page scope: 47/50
genre=fiction, new book has been fetched sucessfully, page scope: 45/50
genre=manga, new book has been fetched sucessfully, page scope: 2/50
genre=horror, new book has been fetched sucessfully, page scope: 42/50
genre=crime, new book has been fetched sucessfully, page scope: 3/50
genre=fiction, new book has been fetched sucessfully, page scope: 46/50
genre=manga, new book has been fetched sucessfully, page scope: 3/50
genre=horror, new book has been fetched sucessfully, page scope: 43/50
genre=crime, new book has been fetched sucessfully, page scope: 4/50
genre=fiction, new book has been fetched sucessfully, page scope: 47/50
genre=manga, new book has been fetched sucessfully, page scope: 4/50
genre=crime, new book has been fetched sucessfully, page scope: 5/50
genre=horror, new book has been fetched sucessfully, page scope: 44/50
genre=manga, new book has been fetched sucessfully, page scope: 5/50
genre=fiction, new book has been fetched sucessfully, page scope: 48/50
genre=horror, new book has been fetched sucessfully, page scope: 45/50
genre=crime, new book has been fetched sucessfully, page scope: 6/50
genre=manga, new book has been fetched sucessfully, page scope: 6/50
genre=fiction, new book has been fetched sucessfully, page scope: 49/50
genre=horror, new book has been fetched sucessfully, page scope: 46/50
genre=crime, new book has been fetched sucessfully, page scope: 7/50
genre=manga, new book has been fetched sucessfully, page scope: 7/50
genre=fiction, new book has been fetched sucessfully, page scope: 50/50
fetching genre=fiction, page=23
genre=horror, new book has been fetched sucessfully, page scope: 47/50
genre=crime, new book has been fetched sucessfully, page scope: 8/50
genre=manga, new book has been fetched sucessfully, page scope: 8/50
genre=horror, new book has been fetched sucessfully, page scope: 48/50
genre=crime, new book has been fetched sucessfully, page scope: 9/50
genre=fiction, new book has been fetched sucessfully, page scope: 1/50
genre=manga, new book has been fetched sucessfully, page scope: 9/50
genre=horror, new book has been fetched sucessfully, page scope: 49/50
genre=crime, new book has been fetched sucessfully, page scope: 10/50
genre=manga, new book has been fetched sucessfully, page scope: 10/50
genre=fiction, new book has been fetched sucessfully, page scope: 2/50
genre=fantasy, new book has been fetched sucessfully, page scope: 48/50
genre=crime, new book has been fetched sucessfully, page scope: 11/50
genre=horror, new book has been fetched sucessfully, page scope: 50/50
fetching genre=horror, page=23
genre=manga, new book has been fetched sucessfully, page scope: 11/50
genre=fiction, new book has been fetched sucessfully, page scope: 3/50
genre=fantasy, new book has been fetched sucessfully, page scope: 49/50
genre=crime, new book has been fetched sucessfully, page scope: 12/50
genre=manga, new book has been fetched sucessfully, page scope: 12/50
genre=horror, new book has been fetched sucessfully, page scope: 1/50
genre=fiction, new book has been fetched sucessfully, page scope: 4/50
genre=fantasy, new book has been fetched sucessfully, page scope: 50/50
fetching genre=fantasy, page=23
genre=crime, new book has been fetched sucessfully, page scope: 13/50
genre=manga, new book has been fetched sucessfully, page scope: 13/50
genre=fiction, new book has been fetched sucessfully, page scope: 5/50
genre=crime, new book has been fetched sucessfully, page scope: 14/50
genre=horror, new book has been fetched sucessfully, page scope: 2/50
genre=fantasy, new book has been fetched sucessfully, page scope: 1/50
genre=manga, new book has been fetched sucessfully, page scope: 14/50
genre=crime, new book has been fetched sucessfully, page scope: 15/50
genre=fantasy, new book has been fetched sucessfully, page scope: 2/50
genre=manga, new book has been fetched sucessfully, page scope: 15/50
genre=horror, new book has been fetched sucessfully, page scope: 3/50
genre=crime, new book has been fetched sucessfully, page scope: 16/50
genre=manga, new book has been fetched sucessfully, page scope: 16/50
genre=horror, new book has been fetched sucessfully, page scope: 4/50
genre=fantasy, new book has been fetched sucessfully, page scope: 3/50
genre=crime, new book has been fetched sucessfully, page scope: 17/50
genre=manga, new book has been fetched sucessfully, page scope: 17/50
genre=horror, new book has been fetched sucessfully, page scope: 5/50
genre=fantasy, new book has been fetched sucessfully, page scope: 4/50
genre=crime, new book has been fetched sucessfully, page scope: 18/50
genre=manga, new book has been fetched sucessfully, page scope: 18/50
genre=horror, new book has been fetched sucessfully, page scope: 6/50
genre=fantasy, new book has been fetched sucessfully, page scope: 5/50
genre=manga, new book has been fetched sucessfully, page scope: 19/50
genre=horror, new book has been fetched sucessfully, page scope: 7/50
genre=crime, new book has been fetched sucessfully, page scope: 19/50
genre=fantasy, new book has been fetched sucessfully, page scope: 6/50
genre=manga, new book has been fetched sucessfully, page scope: 20/50
genre=horror, new book has been fetched sucessfully, page scope: 8/50
genre=crime, new book has been fetched sucessfully, page scope: 20/50
genre=fantasy, new book has been fetched sucessfully, page scope: 7/50
genre=manga, new book has been fetched sucessfully, page scope: 21/50
genre=horror, new book has been fetched sucessfully, page scope: 9/50
genre=fiction, new book has been fetched sucessfully, page scope: 6/50
genre=fantasy, new book has been fetched sucessfully, page scope: 8/50
genre=manga, new book has been fetched sucessfully, page scope: 22/50
genre=horror, new book has been fetched sucessfully, page scope: 10/50
genre=fiction, new book has been fetched sucessfully, page scope: 7/50
genre=manga, new book has been fetched sucessfully, page scope: 23/50
genre=fantasy, new book has been fetched sucessfully, page scope: 9/50
genre=horror, new book has been fetched sucessfully, page scope: 11/50
genre=fiction, new book has been fetched sucessfully, page scope: 8/50
genre=manga, new book has been fetched sucessfully, page scope: 24/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=horror, new book has been fetched sucessfully, page scope: 12/50
genre=fiction, new book has been fetched sucessfully, page scope: 9/50
genre=fantasy, new book has been fetched sucessfully, page scope: 10/50
genre=manga, new book has been fetched sucessfully, page scope: 25/50
genre=fiction, new book has been fetched sucessfully, page scope: 10/50genre=fantasy, new book has been fetched sucessfully, page scope: 11/50

genre=horror, new book has been fetched sucessfully, page scope: 13/50
genre=manga, new book has been fetched sucessfully, page scope: 26/50
genre=fantasy, new book has been fetched sucessfully, page scope: 12/50
genre=horror, new book has been fetched sucessfully, page scope: 14/50
genre=fiction, new book has been fetched sucessfully, page scope: 11/50
genre=fantasy, new book has been fetched sucessfully, page scope: 13/50
genre=horror, new book has been fetched sucessfully, page scope: 15/50
genre=fiction, new book has been fetched sucessfully, page scope: 12/50
genre=crime, new book has been fetched sucessfully, page scope: 21/50
genre=horror, new book has been fetched sucessfully, page scope: 16/50
genre=fantasy, new book has been fetched sucessfully, page scope: 14/50
genre=fiction, new book has been fetched sucessfully, page scope: 13/50
genre=crime, new book has been fetched sucessfully, page scope: 22/50
genre=fiction, new book has been fetched sucessfully, page scope: 14/50
genre=horror, new book has been fetched sucessfully, page scope: 17/50
genre=fantasy, new book has been fetched sucessfully, page scope: 15/50
genre=crime, new book has been fetched sucessfully, page scope: 23/50
genre=fiction, new book has been fetched sucessfully, page scope: 15/50
genre=horror, new book has been fetched sucessfully, page scope: 18/50
genre=fantasy, new book has been fetched sucessfully, page scope: 16/50
genre=horror, new book has been fetched sucessfully, page scope: 19/50
genre=fiction, new book has been fetched sucessfully, page scope: 16/50
genre=fantasy, new book has been fetched sucessfully, page scope: 17/50
genre=crime, new book has been fetched sucessfully, page scope: 24/50
genre=fiction, new book has been fetched sucessfully, page scope: 17/50
genre=horror, new book has been fetched sucessfully, page scope: 20/50
genre=crime, new book has been fetched sucessfully, page scope: 25/50
genre=fantasy, new book has been fetched sucessfully, page scope: 18/50
genre=fiction, new book has been fetched sucessfully, page scope: 18/50
genre=manga, new book has been fetched sucessfully, page scope: 27/50
genre=horror, new book has been fetched sucessfully, page scope: 21/50
genre=crime, new book has been fetched sucessfully, page scope: 26/50
genre=fantasy, new book has been fetched sucessfully, page scope: 19/50
genre=fiction, new book has been fetched sucessfully, page scope: 19/50
genre=manga, new book has been fetched sucessfully, page scope: 28/50
genre=horror, new book has been fetched sucessfully, page scope: 22/50
genre=crime, new book has been fetched sucessfully, page scope: 27/50
genre=manga, new book has been fetched sucessfully, page scope: 29/50
genre=horror, new book has been fetched sucessfully, page scope: 23/50
genre=fiction, new book has been fetched sucessfully, page scope: 20/50
genre=fantasy, new book has been fetched sucessfully, page scope: 20/50
genre=crime, new book has been fetched sucessfully, page scope: 28/50
genre=manga, new book has been fetched sucessfully, page scope: 30/50
genre=fiction, new book has been fetched sucessfully, page scope: 21/50
genre=crime, new book has been fetched sucessfully, page scope: 29/50
genre=horror, new book has been fetched sucessfully, page scope: 24/50
genre=fantasy, new book has been fetched sucessfully, page scope: 21/50
genre=manga, new book has been fetched sucessfully, page scope: 31/50
genre=fiction, new book has been fetched sucessfully, page scope: 22/50
genre=horror, new book has been fetched sucessfully, page scope: 25/50
genre=crime, new book has been fetched sucessfully, page scope: 30/50
genre=fiction, new book has been fetched sucessfully, page scope: 23/50
genre=manga, new book has been fetched sucessfully, page scope: 32/50
genre=horror, new book has been fetched sucessfully, page scope: 26/50
genre=crime, new book has been fetched sucessfully, page scope: 31/50
genre=fiction, new book has been fetched sucessfully, page scope: 24/50
genre=manga, new book has been fetched sucessfully, page scope: 33/50
genre=horror, new book has been fetched sucessfully, page scope: 27/50
genre=fiction, new book has been fetched sucessfully, page scope: 25/50
genre=crime, new book has been fetched sucessfully, page scope: 32/50
genre=manga, new book has been fetched sucessfully, page scope: 34/50
genre=horror, new book has been fetched sucessfully, page scope: 28/50
genre=manga, new book has been fetched sucessfully, page scope: 35/50
genre=fiction, new book has been fetched sucessfully, page scope: 26/50
genre=crime, new book has been fetched sucessfully, page scope: 33/50
genre=horror, new book has been fetched sucessfully, page scope: 29/50
genre=manga, new book has been fetched sucessfully, page scope: 36/50
genre=horror, new book has been fetched sucessfully, page scope: 30/50
genre=fiction, new book has been fetched sucessfully, page scope: 27/50
genre=crime, new book has been fetched sucessfully, page scope: 34/50
genre=manga, new book has been fetched sucessfully, page scope: 37/50
genre=horror, new book has been fetched sucessfully, page scope: 31/50
genre=fiction, new book has been fetched sucessfully, page scope: 28/50
genre=crime, new book has been fetched sucessfully, page scope: 35/50
genre=manga, new book has been fetched sucessfully, page scope: 38/50
genre=horror, new book has been fetched sucessfully, page scope: 32/50
genre=fiction, new book has been fetched sucessfully, page scope: 29/50
genre=manga, new book has been fetched sucessfully, page scope: 39/50
genre=crime, new book has been fetched sucessfully, page scope: 36/50
genre=fantasy, new book has been fetched sucessfully, page scope: 22/50
genre=horror, new book has been fetched sucessfully, page scope: 33/50
genre=fiction, new book has been fetched sucessfully, page scope: 30/50
genre=crime, new book has been fetched sucessfully, page scope: 37/50
genre=manga, new book has been fetched sucessfully, page scope: 40/50
genre=fantasy, new book has been fetched sucessfully, page scope: 23/50
genre=horror, new book has been fetched sucessfully, page scope: 34/50
genre=fiction, new book has been fetched sucessfully, page scope: 31/50
genre=manga, new book has been fetched sucessfully, page scope: 41/50
genre=fantasy, new book has been fetched sucessfully, page scope: 24/50
genre=crime, new book has been fetched sucessfully, page scope: 38/50
genre=fiction, new book has been fetched sucessfully, page scope: 32/50
genre=horror, new book has been fetched sucessfully, page scope: 35/50
genre=manga, new book has been fetched sucessfully, page scope: 42/50
genre=crime, new book has been fetched sucessfully, page scope: 39/50
genre=fantasy, new book has been fetched sucessfully, page scope: 25/50
genre=horror, new book has been fetched sucessfully, page scope: 36/50
genre=fiction, new book has been fetched sucessfully, page scope: 33/50
genre=manga, new book has been fetched sucessfully, page scope: 43/50
genre=crime, new book has been fetched sucessfully, page scope: 40/50
genre=fantasy, new book has been fetched sucessfully, page scope: 26/50
genre=fiction, new book has been fetched sucessfully, page scope: 34/50
genre=horror, new book has been fetched sucessfully, page scope: 37/50
genre=crime, new book has been fetched sucessfully, page scope: 41/50
genre=manga, new book has been fetched sucessfully, page scope: 44/50
genre=fantasy, new book has been fetched sucessfully, page scope: 27/50
genre=horror, new book has been fetched sucessfully, page scope: 38/50
genre=fiction, new book has been fetched sucessfully, page scope: 35/50
genre=crime, new book has been fetched sucessfully, page scope: 42/50
genre=manga, new book has been fetched sucessfully, page scope: 45/50
genre=fantasy, new book has been fetched sucessfully, page scope: 28/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=crime, new book has been fetched sucessfully, page scope: 43/50
genre=horror, new book has been fetched sucessfully, page scope: 39/50
genre=fiction, new book has been fetched sucessfully, page scope: 36/50
genre=manga, new book has been fetched sucessfully, page scope: 46/50
genre=fantasy, new book has been fetched sucessfully, page scope: 29/50
genre=crime, new book has been fetched sucessfully, page scope: 44/50
genre=fiction, new book has been fetched sucessfully, page scope: 37/50
genre=horror, new book has been fetched sucessfully, page scope: 40/50
genre=manga, new book has been fetched sucessfully, page scope: 47/50
genre=crime, new book has been fetched sucessfully, page scope: 45/50
genre=fantasy, new book has been fetched sucessfully, page scope: 30/50
genre=fiction, new book has been fetched sucessfully, page scope: 38/50
genre=manga, new book has been fetched sucessfully, page scope: 48/50
genre=horror, new book has been fetched sucessfully, page scope: 41/50
genre=crime, new book has been fetched sucessfully, page scope: 46/50
genre=horror, new book has been fetched sucessfully, page scope: 42/50
genre=manga, new book has been fetched sucessfully, page scope: 49/50
genre=fiction, new book has been fetched sucessfully, page scope: 39/50
genre=fantasy, new book has been fetched sucessfully, page scope: 31/50
genre=horror, new book has been fetched sucessfully, page scope: 43/50
genre=crime, new book has been fetched sucessfully, page scope: 47/50
genre=fiction, new book has been fetched sucessfully, page scope: 40/50
genre=manga, new book has been fetched sucessfully, page scope: 50/50
fetching genre=manga, page=24
genre=fantasy, new book has been fetched sucessfully, page scope: 32/50
genre=horror, new book has been fetched sucessfully, page scope: 44/50
genre=crime, new book has been fetched sucessfully, page scope: 48/50
genre=fiction, new book has been fetched sucessfully, page scope: 41/50
genre=fantasy, new book has been fetched sucessfully, page scope: 33/50
genre=manga, new book has been fetched sucessfully, page scope: 1/50
genre=horror, new book has been fetched sucessfully, page scope: 45/50
genre=crime, new book has been fetched sucessfully, page scope: 49/50
genre=fiction, new book has been fetched sucessfully, page scope: 42/50
genre=fantasy, new book has been fetched sucessfully, page scope: 34/50
genre=manga, new book has been fetched sucessfully, page scope: 2/50
genre=horror, new book has been fetched sucessfully, page scope: 46/50
genre=crime, new book has been fetched sucessfully, page scope: 50/50
fetching genre=crime, page=24
genre=fantasy, new book has been fetched sucessfully, page scope: 35/50
genre=horror, new book has been fetched sucessfully, page scope: 47/50
genre=fiction, new book has been fetched sucessfully, page scope: 43/50
genre=manga, new book has been fetched sucessfully, page scope: 3/50
genre=crime, new book has been fetched sucessfully, page scope: 1/50
genre=manga, new book has been fetched sucessfully, page scope: 4/50
genre=horror, new book has been fetched sucessfully, page scope: 48/50
genre=fiction, new book has been fetched sucessfully, page scope: 44/50
genre=fantasy, new book has been fetched sucessfully, page scope: 36/50
genre=crime, new book has been fetched sucessfully, page scope: 2/50
genre=manga, new book has been fetched sucessfully, page scope: 5/50
genre=horror, new book has been fetched sucessfully, page scope: 49/50
genre=fiction, new book has been fetched sucessfully, page scope: 45/50
genre=fantasy, new book has been fetched sucessfully, page scope: 37/50
genre=horror, new book has been fetched sucessfully, page scope: 50/50
fetching genre=horror, page=24
genre=manga, new book has been fetched sucessfully, page scope: 6/50
genre=crime, new book has been fetched sucessfully, page scope: 3/50
genre=fiction, new book has been fetched sucessfully, page scope: 46/50
genre=fantasy, new book has been fetched sucessfully, page scope: 38/50
genre=manga, new book has been fetched sucessfully, page scope: 7/50
genre=crime, new book has been fetched sucessfully, page scope: 4/50
genre=horror, new book has been fetched sucessfully, page scope: 1/49
genre=fiction, new book has been fetched sucessfully, page scope: 47/50
genre=fantasy, new book has been fetched sucessfully, page scope: 39/50
genre=manga, new book has been fetched sucessfully, page scope: 8/50
genre=crime, new book has been fetched sucessfully, page scope: 5/50
genre=fiction, new book has been fetched sucessfully, page scope: 48/50
genre=horror, new book has been fetched sucessfully, page scope: 2/49
genre=fantasy, new book has been fetched sucessfully, page scope: 40/50
genre=manga, new book has been fetched sucessfully, page scope: 9/50
genre=crime, new book has been fetched sucessfully, page scope: 6/50
genre=horror, new book has been fetched sucessfully, page scope: 3/49
genre=fantasy, new book has been fetched sucessfully, page scope: 41/50
genre=fiction, new book has been fetched sucessfully, page scope: 49/50
genre=manga, new book has been fetched sucessfully, page scope: 10/50
genre=crime, new book has been fetched sucessfully, page scope: 7/50
genre=fantasy, new book has been fetched sucessfully, page scope: 42/50
genre=horror, new book has been fetched sucessfully, page scope: 4/49
genre=manga, new book has been fetched sucessfully, page scope: 11/50
genre=fiction, new book has been fetched sucessfully, page scope: 50/50
fetching genre=fiction, page=24
genre=crime, new book has been fetched sucessfully, page scope: 8/50
genre=manga, new book has been fetched sucessfully, page scope: 12/50
genre=fantasy, new book has been fetched sucessfully, page scope: 43/50
genre=horror, new book has been fetched sucessfully, page scope: 5/49
genre=crime, new book has been fetched sucessfully, page scope: 9/50
genre=fiction, new book has been fetched sucessfully, page scope: 1/50
genre=manga, new book has been fetched sucessfully, page scope: 13/50
genre=horror, new book has been fetched sucessfully, page scope: 6/49
genre=fantasy, new book has been fetched sucessfully, page scope: 44/50
genre=fiction, new book has been fetched sucessfully, page scope: 2/50genre=manga, new book has been fetched sucessfully, page scope: 14/50

genre=crime, new book has been fetched sucessfully, page scope: 10/50
genre=horror, new book has been fetched sucessfully, page scope: 7/49
genre=fantasy, new book has been fetched sucessfully, page scope: 45/50
genre=fiction, new book has been fetched sucessfully, page scope: 3/50
genre=manga, new book has been fetched sucessfully, page scope: 15/50
genre=crime, new book has been fetched sucessfully, page scope: 11/50
genre=horror, new book has been fetched sucessfully, page scope: 8/49
genre=fantasy, new book has been fetched sucessfully, page scope: 46/50
genre=manga, new book has been fetched sucessfully, page scope: 16/50
genre=crime, new book has been fetched sucessfully, page scope: 12/50
genre=fiction, new book has been fetched sucessfully, page scope: 4/50
genre=horror, new book has been fetched sucessfully, page scope: 9/49
genre=fantasy, new book has been fetched sucessfully, page scope: 47/50
genre=manga, new book has been fetched sucessfully, page scope: 17/50
genre=crime, new book has been fetched sucessfully, page scope: 13/50
genre=horror, new book has been fetched sucessfully, page scope: 10/49
genre=fiction, new book has been fetched sucessfully, page scope: 5/50
genre=fantasy, new book has been fetched sucessfully, page scope: 48/50
genre=manga, new book has been fetched sucessfully, page scope: 18/50
genre=horror, new book has been fetched sucessfully, page scope: 11/49
genre=crime, new book has been fetched sucessfully, page scope: 14/50
genre=fiction, new book has been fetched sucessfully, page scope: 6/50
genre=manga, new book has been fetched sucessfully, page scope: 19/50
genre=horror, new book has been fetched sucessfully, page scope: 12/49
genre=fantasy, new book has been fetched sucessfully, page scope: 49/50
genre=fiction, new book has been fetched sucessfully, page scope: 7/50
genre=crime, new book has been fetched sucessfully, page scope: 15/50
genre=manga, new book has been fetched sucessfully, page scope: 20/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=fantasy, new book has been fetched sucessfully, page scope: 50/50
fetching genre=fantasy, page=24
genre=horror, new book has been fetched sucessfully, page scope: 13/49
genre=fiction, new book has been fetched sucessfully, page scope: 8/50
genre=crime, new book has been fetched sucessfully, page scope: 16/50
genre=manga, new book has been fetched sucessfully, page scope: 21/50
genre=horror, new book has been fetched sucessfully, page scope: 14/49
genre=crime, new book has been fetched sucessfully, page scope: 17/50
genre=fiction, new book has been fetched sucessfully, page scope: 9/50
genre=fantasy, new book has been fetched sucessfully, page scope: 1/49
genre=manga, new book has been fetched sucessfully, page scope: 22/50
genre=horror, new book has been fetched sucessfully, page scope: 15/49
genre=crime, new book has been fetched sucessfully, page scope: 18/50
genre=fantasy, new book has been fetched sucessfully, page scope: 2/49
genre=fiction, new book has been fetched sucessfully, page scope: 10/50
genre=manga, new book has been fetched sucessfully, page scope: 23/50
genre=horror, new book has been fetched sucessfully, page scope: 16/49
genre=crime, new book has been fetched sucessfully, page scope: 19/50
genre=fantasy, new book has been fetched sucessfully, page scope: 3/49
genre=fiction, new book has been fetched sucessfully, page scope: 11/50
genre=horror, new book has been fetched sucessfully, page scope: 17/49
genre=manga, new book has been fetched sucessfully, page scope: 24/50
genre=crime, new book has been fetched sucessfully, page scope: 20/50
genre=fiction, new book has been fetched sucessfully, page scope: 12/50
genre=fantasy, new book has been fetched sucessfully, page scope: 4/49
genre=manga, new book has been fetched sucessfully, page scope: 25/50
genre=crime, new book has been fetched sucessfully, page scope: 21/50genre=horror, new book has been fetched sucessfully, page scope: 18/49

genre=fiction, new book has been fetched sucessfully, page scope: 13/50
genre=fantasy, new book has been fetched sucessfully, page scope: 5/49
genre=manga, new book has been fetched sucessfully, page scope: 26/50genre=crime, new book has been fetched sucessfully, page scope: 22/50

genre=horror, new book has been fetched sucessfully, page scope: 19/49
genre=fiction, new book has been fetched sucessfully, page scope: 14/50
genre=fantasy, new book has been fetched sucessfully, page scope: 6/49
genre=manga, new book has been fetched sucessfully, page scope: 27/50
genre=horror, new book has been fetched sucessfully, page scope: 20/49
genre=crime, new book has been fetched sucessfully, page scope: 23/50
genre=fiction, new book has been fetched sucessfully, page scope: 15/50
genre=fantasy, new book has been fetched sucessfully, page scope: 7/49
genre=manga, new book has been fetched sucessfully, page scope: 28/50
genre=crime, new book has been fetched sucessfully, page scope: 24/50
genre=fiction, new book has been fetched sucessfully, page scope: 16/50
genre=horror, new book has been fetched sucessfully, page scope: 21/49
genre=fantasy, new book has been fetched sucessfully, page scope: 8/49
genre=manga, new book has been fetched sucessfully, page scope: 29/50
genre=crime, new book has been fetched sucessfully, page scope: 25/50
genre=fiction, new book has been fetched sucessfully, page scope: 17/50
genre=horror, new book has been fetched sucessfully, page scope: 22/49
genre=manga, new book has been fetched sucessfully, page scope: 30/50
genre=fantasy, new book has been fetched sucessfully, page scope: 9/49
genre=crime, new book has been fetched sucessfully, page scope: 26/50
genre=fiction, new book has been fetched sucessfully, page scope: 18/50
genre=horror, new book has been fetched sucessfully, page scope: 23/49
genre=manga, new book has been fetched sucessfully, page scope: 31/50
genre=fantasy, new book has been fetched sucessfully, page scope: 10/49
genre=crime, new book has been fetched sucessfully, page scope: 27/50
genre=fiction, new book has been fetched sucessfully, page scope: 19/50
genre=manga, new book has been fetched sucessfully, page scope: 32/50
genre=horror, new book has been fetched sucessfully, page scope: 24/49
genre=fantasy, new book has been fetched sucessfully, page scope: 11/49
genre=crime, new book has been fetched sucessfully, page scope: 28/50
genre=fiction, new book has been fetched sucessfully, page scope: 20/50
genre=manga, new book has been fetched sucessfully, page scope: 33/50
genre=horror, new book has been fetched sucessfully, page scope: 25/49
genre=fantasy, new book has been fetched sucessfully, page scope: 12/49
genre=crime, new book has been fetched sucessfully, page scope: 29/50
genre=manga, new book has been fetched sucessfully, page scope: 34/50
genre=fiction, new book has been fetched sucessfully, page scope: 21/50
genre=horror, new book has been fetched sucessfully, page scope: 26/49
genre=crime, new book has been fetched sucessfully, page scope: 30/50
genre=manga, new book has been fetched sucessfully, page scope: 35/50
genre=fantasy, new book has been fetched sucessfully, page scope: 13/49
genre=fiction, new book has been fetched sucessfully, page scope: 22/50
genre=horror, new book has been fetched sucessfully, page scope: 27/49
genre=manga, new book has been fetched sucessfully, page scope: 36/50
genre=fantasy, new book has been fetched sucessfully, page scope: 14/49
genre=crime, new book has been fetched sucessfully, page scope: 31/50
genre=fiction, new book has been fetched sucessfully, page scope: 23/50
genre=horror, new book has been fetched sucessfully, page scope: 28/49
genre=manga, new book has been fetched sucessfully, page scope: 37/50
genre=fiction, new book has been fetched sucessfully, page scope: 24/50
genre=fantasy, new book has been fetched sucessfully, page scope: 15/49
genre=crime, new book has been fetched sucessfully, page scope: 32/50
genre=horror, new book has been fetched sucessfully, page scope: 29/49
genre=manga, new book has been fetched sucessfully, page scope: 38/50
genre=fiction, new book has been fetched sucessfully, page scope: 25/50
genre=crime, new book has been fetched sucessfully, page scope: 33/50
genre=manga, new book has been fetched sucessfully, page scope: 39/50
genre=horror, new book has been fetched sucessfully, page scope: 30/49
genre=fantasy, new book has been fetched sucessfully, page scope: 16/49
genre=fiction, new book has been fetched sucessfully, page scope: 26/50
genre=manga, new book has been fetched sucessfully, page scope: 40/50
genre=crime, new book has been fetched sucessfully, page scope: 34/50
genre=horror, new book has been fetched sucessfully, page scope: 31/49
genre=fiction, new book has been fetched sucessfully, page scope: 27/50
genre=manga, new book has been fetched sucessfully, page scope: 41/50
genre=crime, new book has been fetched sucessfully, page scope: 35/50
genre=horror, new book has been fetched sucessfully, page scope: 32/49
genre=manga, new book has been fetched sucessfully, page scope: 42/50
genre=fiction, new book has been fetched sucessfully, page scope: 28/50
genre=crime, new book has been fetched sucessfully, page scope: 36/50
genre=horror, new book has been fetched sucessfully, page scope: 33/49
genre=manga, new book has been fetched sucessfully, page scope: 43/50
genre=fiction, new book has been fetched sucessfully, page scope: 29/50
genre=crime, new book has been fetched sucessfully, page scope: 37/50
genre=horror, new book has been fetched sucessfully, page scope: 34/49
genre=manga, new book has been fetched sucessfully, page scope: 44/50
genre=fiction, new book has been fetched sucessfully, page scope: 30/50
genre=crime, new book has been fetched sucessfully, page scope: 38/50
genre=horror, new book has been fetched sucessfully, page scope: 35/49
genre=manga, new book has been fetched sucessfully, page scope: 45/50
genre=fiction, new book has been fetched sucessfully, page scope: 31/50
genre=crime, new book has been fetched sucessfully, page scope: 39/50
genre=horror, new book has been fetched sucessfully, page scope: 36/49
genre=manga, new book has been fetched sucessfully, page scope: 46/50
genre=fiction, new book has been fetched sucessfully, page scope: 32/50genre=crime, new book has been fetched sucessfully, page scope: 40/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=horror, new book has been fetched sucessfully, page scope: 37/49
genre=crime, new book has been fetched sucessfully, page scope: 41/50
genre=manga, new book has been fetched sucessfully, page scope: 47/50
genre=fiction, new book has been fetched sucessfully, page scope: 33/50
genre=horror, new book has been fetched sucessfully, page scope: 38/49
genre=manga, new book has been fetched sucessfully, page scope: 48/50
genre=crime, new book has been fetched sucessfully, page scope: 42/50
genre=fiction, new book has been fetched sucessfully, page scope: 34/50
genre=horror, new book has been fetched sucessfully, page scope: 39/49
genre=fantasy, new book has been fetched sucessfully, page scope: 17/49
genre=manga, new book has been fetched sucessfully, page scope: 49/50
genre=crime, new book has been fetched sucessfully, page scope: 43/50
genre=fiction, new book has been fetched sucessfully, page scope: 35/50
genre=horror, new book has been fetched sucessfully, page scope: 40/49
genre=fantasy, new book has been fetched sucessfully, page scope: 18/49
genre=manga, new book has been fetched sucessfully, page scope: 50/50
fetching genre=manga, page=25
genre=crime, new book has been fetched sucessfully, page scope: 44/50
genre=fiction, new book has been fetched sucessfully, page scope: 36/50
genre=horror, new book has been fetched sucessfully, page scope: 41/49
genre=fantasy, new book has been fetched sucessfully, page scope: 19/49
genre=manga, new book has been fetched sucessfully, page scope: 1/50
genre=crime, new book has been fetched sucessfully, page scope: 45/50
genre=fiction, new book has been fetched sucessfully, page scope: 37/50
genre=horror, new book has been fetched sucessfully, page scope: 42/49
genre=fantasy, new book has been fetched sucessfully, page scope: 20/49
genre=manga, new book has been fetched sucessfully, page scope: 2/50
genre=crime, new book has been fetched sucessfully, page scope: 46/50
genre=fiction, new book has been fetched sucessfully, page scope: 38/50
genre=horror, new book has been fetched sucessfully, page scope: 43/49
genre=fantasy, new book has been fetched sucessfully, page scope: 21/49
genre=manga, new book has been fetched sucessfully, page scope: 3/50
genre=crime, new book has been fetched sucessfully, page scope: 47/50
genre=horror, new book has been fetched sucessfully, page scope: 44/49
genre=fiction, new book has been fetched sucessfully, page scope: 39/50
genre=manga, new book has been fetched sucessfully, page scope: 4/50
genre=fantasy, new book has been fetched sucessfully, page scope: 22/49
genre=crime, new book has been fetched sucessfully, page scope: 48/50
genre=horror, new book has been fetched sucessfully, page scope: 45/49
genre=fiction, new book has been fetched sucessfully, page scope: 40/50
genre=manga, new book has been fetched sucessfully, page scope: 5/50
genre=fantasy, new book has been fetched sucessfully, page scope: 23/49
genre=crime, new book has been fetched sucessfully, page scope: 49/50
genre=manga, new book has been fetched sucessfully, page scope: 6/50
genre=fiction, new book has been fetched sucessfully, page scope: 41/50
genre=horror, new book has been fetched sucessfully, page scope: 46/49
genre=fantasy, new book has been fetched sucessfully, page scope: 24/49
genre=crime, new book has been fetched sucessfully, page scope: 50/50
fetching genre=crime, page=25
genre=manga, new book has been fetched sucessfully, page scope: 7/50
genre=fiction, new book has been fetched sucessfully, page scope: 42/50
genre=horror, new book has been fetched sucessfully, page scope: 47/49
genre=fantasy, new book has been fetched sucessfully, page scope: 25/49
genre=manga, new book has been fetched sucessfully, page scope: 8/50
genre=fiction, new book has been fetched sucessfully, page scope: 43/50
genre=crime, new book has been fetched sucessfully, page scope: 1/50
genre=horror, new book has been fetched sucessfully, page scope: 48/49
genre=fantasy, new book has been fetched sucessfully, page scope: 26/49
genre=manga, new book has been fetched sucessfully, page scope: 9/50
genre=fiction, new book has been fetched sucessfully, page scope: 44/50
genre=crime, new book has been fetched sucessfully, page scope: 2/50
genre=horror, new book has been fetched sucessfully, page scope: 49/49
work on genre: horror has been finished
genre=manga, new book has been fetched sucessfully, page scope: 10/50
genre=fantasy, new book has been fetched sucessfully, page scope: 27/49
genre=fiction, new book has been fetched sucessfully, page scope: 45/50
genre=crime, new book has been fetched sucessfully, page scope: 3/50
genre=manga, new book has been fetched sucessfully, page scope: 11/50
genre=fantasy, new book has been fetched sucessfully, page scope: 28/49
genre=fiction, new book has been fetched sucessfully, page scope: 46/50
genre=crime, new book has been fetched sucessfully, page scope: 4/50
genre=manga, new book has been fetched sucessfully, page scope: 12/50
genre=fiction, new book has been fetched sucessfully, page scope: 47/50
genre=fantasy, new book has been fetched sucessfully, page scope: 29/49
genre=crime, new book has been fetched sucessfully, page scope: 5/50
genre=manga, new book has been fetched sucessfully, page scope: 13/50
genre=fantasy, new book has been fetched sucessfully, page scope: 30/49
genre=manga, new book has been fetched sucessfully, page scope: 14/50
genre=crime, new book has been fetched sucessfully, page scope: 6/50
genre=fantasy, new book has been fetched sucessfully, page scope: 31/49
genre=manga, new book has been fetched sucessfully, page scope: 15/50
genre=crime, new book has been fetched sucessfully, page scope: 7/50
genre=fantasy, new book has been fetched sucessfully, page scope: 32/49
genre=manga, new book has been fetched sucessfully, page scope: 16/50
genre=crime, new book has been fetched sucessfully, page scope: 8/50
genre=fantasy, new book has been fetched sucessfully, page scope: 33/49
genre=manga, new book has been fetched sucessfully, page scope: 17/50
genre=crime, new book has been fetched sucessfully, page scope: 9/50
genre=manga, new book has been fetched sucessfully, page scope: 18/50
genre=fantasy, new book has been fetched sucessfully, page scope: 34/49
genre=crime, new book has been fetched sucessfully, page scope: 10/50
genre=manga, new book has been fetched sucessfully, page scope: 19/50
genre=crime, new book has been fetched sucessfully, page scope: 11/50
genre=fantasy, new book has been fetched sucessfully, page scope: 35/49
genre=manga, new book has been fetched sucessfully, page scope: 20/50
genre=crime, new book has been fetched sucessfully, page scope: 12/50
genre=manga, new book has been fetched sucessfully, page scope: 21/50
genre=crime, new book has been fetched sucessfully, page scope: 13/50
genre=manga, new book has been fetched sucessfully, page scope: 22/50
genre=fiction, new book has been fetched sucessfully, page scope: 48/50
genre=crime, new book has been fetched sucessfully, page scope: 14/50
genre=manga, new book has been fetched sucessfully, page scope: 23/50
genre=fiction, new book has been fetched sucessfully, page scope: 49/50
genre=crime, new book has been fetched sucessfully, page scope: 15/50
genre=manga, new book has been fetched sucessfully, page scope: 24/50
genre=fiction, new book has been fetched sucessfully, page scope: 50/50
fetching genre=fiction, page=25
genre=crime, new book has been fetched sucessfully, page scope: 16/50
genre=manga, new book has been fetched sucessfully, page scope: 25/50
genre=crime, new book has been fetched sucessfully, page scope: 17/50
genre=manga, new book has been fetched sucessfully, page scope: 26/50
genre=fiction, new book has been fetched sucessfully, page scope: 1/50
genre=crime, new book has been fetched sucessfully, page scope: 18/50
genre=manga, new book has been fetched sucessfully, page scope: 27/50
genre=fiction, new book has been fetched sucessfully, page scope: 2/50
genre=crime, new book has been fetched sucessfully, page scope: 19/50
genre=manga, new book has been fetched sucessfully, page scope: 28/50
genre=fiction, new book has been fetched sucessfully, page scope: 3/50
genre=manga, new book has been fetched sucessfully, page scope: 29/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=fiction, new book has been fetched sucessfully, page scope: 4/50
genre=fantasy, new book has been fetched sucessfully, page scope: 36/49
genre=fiction, new book has been fetched sucessfully, page scope: 5/50
genre=manga, new book has been fetched sucessfully, page scope: 30/50
genre=fantasy, new book has been fetched sucessfully, page scope: 37/49
genre=fiction, new book has been fetched sucessfully, page scope: 6/50
genre=manga, new book has been fetched sucessfully, page scope: 31/50
genre=fantasy, new book has been fetched sucessfully, page scope: 38/49
genre=fiction, new book has been fetched sucessfully, page scope: 7/50
genre=manga, new book has been fetched sucessfully, page scope: 32/50
genre=fantasy, new book has been fetched sucessfully, page scope: 39/49genre=fiction, new book has been fetched sucessfully, page scope: 8/50

genre=manga, new book has been fetched sucessfully, page scope: 33/50
genre=manga, new book has been fetched sucessfully, page scope: 34/50
genre=fantasy, new book has been fetched sucessfully, page scope: 40/49
genre=fiction, new book has been fetched sucessfully, page scope: 9/50
genre=manga, new book has been fetched sucessfully, page scope: 35/50
genre=fantasy, new book has been fetched sucessfully, page scope: 41/49
genre=fiction, new book has been fetched sucessfully, page scope: 10/50
genre=manga, new book has been fetched sucessfully, page scope: 36/50
genre=fantasy, new book has been fetched sucessfully, page scope: 42/49
genre=fiction, new book has been fetched sucessfully, page scope: 11/50
genre=crime, new book has been fetched sucessfully, page scope: 20/50
genre=manga, new book has been fetched sucessfully, page scope: 37/50
genre=fantasy, new book has been fetched sucessfully, page scope: 43/49
genre=fiction, new book has been fetched sucessfully, page scope: 12/50
genre=manga, new book has been fetched sucessfully, page scope: 38/50
genre=crime, new book has been fetched sucessfully, page scope: 21/50
genre=fiction, new book has been fetched sucessfully, page scope: 13/50
genre=fantasy, new book has been fetched sucessfully, page scope: 44/49
genre=manga, new book has been fetched sucessfully, page scope: 39/50
genre=crime, new book has been fetched sucessfully, page scope: 22/50
genre=fiction, new book has been fetched sucessfully, page scope: 14/50
genre=fantasy, new book has been fetched sucessfully, page scope: 45/49
genre=manga, new book has been fetched sucessfully, page scope: 40/50
genre=crime, new book has been fetched sucessfully, page scope: 23/50
genre=fiction, new book has been fetched sucessfully, page scope: 15/50
genre=fantasy, new book has been fetched sucessfully, page scope: 46/49
genre=manga, new book has been fetched sucessfully, page scope: 41/50
genre=crime, new book has been fetched sucessfully, page scope: 24/50
genre=fiction, new book has been fetched sucessfully, page scope: 16/50
genre=fantasy, new book has been fetched sucessfully, page scope: 47/49
genre=fiction, new book has been fetched sucessfully, page scope: 17/50
genre=crime, new book has been fetched sucessfully, page scope: 25/50
genre=fantasy, new book has been fetched sucessfully, page scope: 48/49
genre=crime, new book has been fetched sucessfully, page scope: 26/50
genre=fiction, new book has been fetched sucessfully, page scope: 18/50
genre=fantasy, new book has been fetched sucessfully, page scope: 49/49
work on genre: fantasy has been finished
genre=crime, new book has been fetched sucessfully, page scope: 27/50
genre=fiction, new book has been fetched sucessfully, page scope: 19/50
genre=crime, new book has been fetched sucessfully, page scope: 28/50
genre=fiction, new book has been fetched sucessfully, page scope: 20/50
genre=crime, new book has been fetched sucessfully, page scope: 29/50
genre=fiction, new book has been fetched sucessfully, page scope: 21/50
genre=crime, new book has been fetched sucessfully, page scope: 30/50
genre=fiction, new book has been fetched sucessfully, page scope: 22/50
genre=crime, new book has been fetched sucessfully, page scope: 31/50
genre=fiction, new book has been fetched sucessfully, page scope: 23/50
genre=crime, new book has been fetched sucessfully, page scope: 32/50
genre=fiction, new book has been fetched sucessfully, page scope: 24/50
genre=crime, new book has been fetched sucessfully, page scope: 33/50
genre=fiction, new book has been fetched sucessfully, page scope: 25/50
genre=manga, new book has been fetched sucessfully, page scope: 42/50
genre=crime, new book has been fetched sucessfully, page scope: 34/50
genre=fiction, new book has been fetched sucessfully, page scope: 26/50
genre=manga, new book has been fetched sucessfully, page scope: 43/50
genre=crime, new book has been fetched sucessfully, page scope: 35/50
genre=fiction, new book has been fetched sucessfully, page scope: 27/50
genre=crime, new book has been fetched sucessfully, page scope: 36/50
genre=manga, new book has been fetched sucessfully, page scope: 44/50
genre=fiction, new book has been fetched sucessfully, page scope: 28/50
genre=manga, new book has been fetched sucessfully, page scope: 45/50
genre=fiction, new book has been fetched sucessfully, page scope: 29/50
genre=crime, new book has been fetched sucessfully, page scope: 37/50
genre=manga, new book has been fetched sucessfully, page scope: 46/50
genre=fiction, new book has been fetched sucessfully, page scope: 30/50
genre=crime, new book has been fetched sucessfully, page scope: 38/50
genre=fiction, new book has been fetched sucessfully, page scope: 31/50
genre=manga, new book has been fetched sucessfully, page scope: 47/50
genre=crime, new book has been fetched sucessfully, page scope: 39/50
genre=fiction, new book has been fetched sucessfully, page scope: 32/50
genre=manga, new book has been fetched sucessfully, page scope: 48/50
genre=crime, new book has been fetched sucessfully, page scope: 40/50
genre=manga, new book has been fetched sucessfully, page scope: 49/50
genre=fiction, new book has been fetched sucessfully, page scope: 33/50
genre=crime, new book has been fetched sucessfully, page scope: 41/50
genre=manga, new book has been fetched sucessfully, page scope: 50/50
fetching genre=manga, page=26
genre=fiction, new book has been fetched sucessfully, page scope: 34/50
work on genre: manga has been finished
genre=crime, new book has been fetched sucessfully, page scope: 42/50
genre=fiction, new book has been fetched sucessfully, page scope: 35/50
genre=crime, new book has been fetched sucessfully, page scope: 43/50
genre=fiction, new book has been fetched sucessfully, page scope: 36/50
genre=crime, new book has been fetched sucessfully, page scope: 44/50
genre=fiction, new book has been fetched sucessfully, page scope: 37/50
genre=crime, new book has been fetched sucessfully, page scope: 45/50
genre=fiction, new book has been fetched sucessfully, page scope: 38/50
genre=crime, new book has been fetched sucessfully, page scope: 46/50
genre=fiction, new book has been fetched sucessfully, page scope: 39/50
genre=crime, new book has been fetched sucessfully, page scope: 47/50
genre=fiction, new book has been fetched sucessfully, page scope: 40/50
genre=crime, new book has been fetched sucessfully, page scope: 48/50
genre=fiction, new book has been fetched sucessfully, page scope: 41/50
genre=crime, new book has been fetched sucessfully, page scope: 49/50
genre=fiction, new book has been fetched sucessfully, page scope: 42/50
genre=crime, new book has been fetched sucessfully, page scope: 50/50
fetching genre=crime, page=26
work on genre: crime has been finished
genre=fiction, new book has been fetched sucessfully, page scope: 43/50
genre=fiction, new book has been fetched sucessfully, page scope: 44/50
genre=fiction, new book has been fetched sucessfully, page scope: 45/50
genre=fiction, new book has been fetched sucessfully, page scope: 46/50
genre=fiction, new book has been fetched sucessfully, page scope: 47/50
genre=fiction, new book has been fetched sucessfully, page scope: 48/50
genre=fiction, new book has been fetched sucessfully, page scope: 49/50
genre=fiction, new book has been fetched sucessfully, page scope: 50/50
fetching genre=fiction, page=26
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>work on genre: fiction has been finished
end genre bucket: [&#39;fantasy&#39;, &#39;crime&#39;, &#39;fiction&#39;, &#39;horror&#39;, &#39;manga&#39;]
start genre bucket: [&#39;psychology&#39;, &#39;travel&#39;, &#39;thriller&#39;, &#39;adult&#39;, &#39;sport&#39;]
start working on genre: psychology
fetching genre=psychology, page=21
start working on genre: travel
fetching genre=travel, page=21
start working on genre: thriller
fetching genre=thriller, page=21
start working on genre: adult
fetching genre=adult, page=21
start working on genre: sport
fetching genre=sport, page=21
genre=sport, new book has been fetched sucessfully, page scope: 1/50
genre=travel, new book has been fetched sucessfully, page scope: 1/50
genre=psychology, new book has been fetched sucessfully, page scope: 1/50
genre=adult, new book has been fetched sucessfully, page scope: 1/50
genre=thriller, new book has been fetched sucessfully, page scope: 1/50
genre=travel, new book has been fetched sucessfully, page scope: 2/50
genre=sport, new book has been fetched sucessfully, page scope: 2/50
genre=psychology, new book has been fetched sucessfully, page scope: 2/50
genre=adult, new book has been fetched sucessfully, page scope: 2/50
genre=thriller, new book has been fetched sucessfully, page scope: 2/50
genre=psychology, new book has been fetched sucessfully, page scope: 3/50
genre=travel, new book has been fetched sucessfully, page scope: 3/50
genre=adult, new book has been fetched sucessfully, page scope: 3/50
genre=sport, new book has been fetched sucessfully, page scope: 3/50
genre=thriller, new book has been fetched sucessfully, page scope: 3/50
genre=psychology, new book has been fetched sucessfully, page scope: 4/50
genre=travel, new book has been fetched sucessfully, page scope: 4/50
genre=adult, new book has been fetched sucessfully, page scope: 4/50
genre=sport, new book has been fetched sucessfully, page scope: 4/50
genre=psychology, new book has been fetched sucessfully, page scope: 5/50
genre=thriller, new book has been fetched sucessfully, page scope: 4/50
genre=travel, new book has been fetched sucessfully, page scope: 5/50
genre=sport, new book has been fetched sucessfully, page scope: 5/50
genre=psychology, new book has been fetched sucessfully, page scope: 6/50
genre=travel, new book has been fetched sucessfully, page scope: 6/50
genre=adult, new book has been fetched sucessfully, page scope: 5/50
genre=thriller, new book has been fetched sucessfully, page scope: 5/50
genre=psychology, new book has been fetched sucessfully, page scope: 7/50
genre=travel, new book has been fetched sucessfully, page scope: 7/50
genre=sport, new book has been fetched sucessfully, page scope: 6/50
genre=thriller, new book has been fetched sucessfully, page scope: 6/50
genre=psychology, new book has been fetched sucessfully, page scope: 8/50
genre=travel, new book has been fetched sucessfully, page scope: 8/50
genre=sport, new book has been fetched sucessfully, page scope: 7/50
genre=thriller, new book has been fetched sucessfully, page scope: 7/50
genre=psychology, new book has been fetched sucessfully, page scope: 9/50
genre=travel, new book has been fetched sucessfully, page scope: 9/50
genre=sport, new book has been fetched sucessfully, page scope: 8/50
genre=psychology, new book has been fetched sucessfully, page scope: 10/50
genre=thriller, new book has been fetched sucessfully, page scope: 8/50
genre=travel, new book has been fetched sucessfully, page scope: 10/50
genre=sport, new book has been fetched sucessfully, page scope: 9/50
genre=psychology, new book has been fetched sucessfully, page scope: 11/50
genre=thriller, new book has been fetched sucessfully, page scope: 9/50
genre=travel, new book has been fetched sucessfully, page scope: 11/50
genre=psychology, new book has been fetched sucessfully, page scope: 12/50
genre=travel, new book has been fetched sucessfully, page scope: 12/50
genre=thriller, new book has been fetched sucessfully, page scope: 10/50
genre=sport, new book has been fetched sucessfully, page scope: 10/50
genre=psychology, new book has been fetched sucessfully, page scope: 13/50
genre=travel, new book has been fetched sucessfully, page scope: 13/50
genre=thriller, new book has been fetched sucessfully, page scope: 11/50
genre=sport, new book has been fetched sucessfully, page scope: 11/50
genre=psychology, new book has been fetched sucessfully, page scope: 14/50
genre=travel, new book has been fetched sucessfully, page scope: 14/50
genre=sport, new book has been fetched sucessfully, page scope: 12/50
genre=thriller, new book has been fetched sucessfully, page scope: 12/50
genre=psychology, new book has been fetched sucessfully, page scope: 15/50
genre=travel, new book has been fetched sucessfully, page scope: 15/50
genre=sport, new book has been fetched sucessfully, page scope: 13/50
genre=adult, new book has been fetched sucessfully, page scope: 6/50
genre=psychology, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 13/50
genre=travel, new book has been fetched sucessfully, page scope: 16/50
genre=psychology, new book has been fetched sucessfully, page scope: 17/50
genre=sport, new book has been fetched sucessfully, page scope: 14/50
genre=travel, new book has been fetched sucessfully, page scope: 17/50
genre=thriller, new book has been fetched sucessfully, page scope: 14/50
genre=adult, new book has been fetched sucessfully, page scope: 7/50
genre=psychology, new book has been fetched sucessfully, page scope: 18/50
genre=sport, new book has been fetched sucessfully, page scope: 15/50
genre=travel, new book has been fetched sucessfully, page scope: 18/50
genre=thriller, new book has been fetched sucessfully, page scope: 15/50
genre=adult, new book has been fetched sucessfully, page scope: 8/50
genre=psychology, new book has been fetched sucessfully, page scope: 19/50
genre=travel, new book has been fetched sucessfully, page scope: 19/50
genre=sport, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 16/50
genre=adult, new book has been fetched sucessfully, page scope: 9/50
genre=psychology, new book has been fetched sucessfully, page scope: 20/50
genre=travel, new book has been fetched sucessfully, page scope: 20/50
genre=sport, new book has been fetched sucessfully, page scope: 17/50
genre=thriller, new book has been fetched sucessfully, page scope: 17/50
genre=psychology, new book has been fetched sucessfully, page scope: 21/50
genre=adult, new book has been fetched sucessfully, page scope: 10/50
genre=travel, new book has been fetched sucessfully, page scope: 21/50
genre=thriller, new book has been fetched sucessfully, page scope: 18/50
genre=sport, new book has been fetched sucessfully, page scope: 18/50
genre=psychology, new book has been fetched sucessfully, page scope: 22/50
genre=adult, new book has been fetched sucessfully, page scope: 11/50
genre=travel, new book has been fetched sucessfully, page scope: 22/50
genre=thriller, new book has been fetched sucessfully, page scope: 19/50
genre=sport, new book has been fetched sucessfully, page scope: 19/50
genre=psychology, new book has been fetched sucessfully, page scope: 23/50
genre=travel, new book has been fetched sucessfully, page scope: 23/50
genre=adult, new book has been fetched sucessfully, page scope: 12/50
genre=sport, new book has been fetched sucessfully, page scope: 20/50
genre=thriller, new book has been fetched sucessfully, page scope: 20/50
genre=psychology, new book has been fetched sucessfully, page scope: 24/50
genre=travel, new book has been fetched sucessfully, page scope: 24/50
genre=sport, new book has been fetched sucessfully, page scope: 21/50
genre=adult, new book has been fetched sucessfully, page scope: 13/50
genre=thriller, new book has been fetched sucessfully, page scope: 21/50
genre=psychology, new book has been fetched sucessfully, page scope: 25/50
genre=travel, new book has been fetched sucessfully, page scope: 25/50
genre=sport, new book has been fetched sucessfully, page scope: 22/50
genre=adult, new book has been fetched sucessfully, page scope: 14/50
genre=psychology, new book has been fetched sucessfully, page scope: 26/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=thriller, new book has been fetched sucessfully, page scope: 22/50
genre=travel, new book has been fetched sucessfully, page scope: 26/50
genre=sport, new book has been fetched sucessfully, page scope: 23/50
genre=psychology, new book has been fetched sucessfully, page scope: 27/50
genre=adult, new book has been fetched sucessfully, page scope: 15/50
genre=thriller, new book has been fetched sucessfully, page scope: 23/50
genre=sport, new book has been fetched sucessfully, page scope: 24/50
genre=psychology, new book has been fetched sucessfully, page scope: 28/50
genre=adult, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 24/50
genre=sport, new book has been fetched sucessfully, page scope: 25/50
genre=psychology, new book has been fetched sucessfully, page scope: 29/50
genre=adult, new book has been fetched sucessfully, page scope: 17/50
genre=psychology, new book has been fetched sucessfully, page scope: 30/50
genre=thriller, new book has been fetched sucessfully, page scope: 25/50
genre=sport, new book has been fetched sucessfully, page scope: 26/50
genre=adult, new book has been fetched sucessfully, page scope: 18/50
genre=psychology, new book has been fetched sucessfully, page scope: 31/50
genre=thriller, new book has been fetched sucessfully, page scope: 26/50
genre=sport, new book has been fetched sucessfully, page scope: 27/50
genre=adult, new book has been fetched sucessfully, page scope: 19/50
genre=psychology, new book has been fetched sucessfully, page scope: 32/50
genre=sport, new book has been fetched sucessfully, page scope: 28/50
genre=psychology, new book has been fetched sucessfully, page scope: 33/50
genre=adult, new book has been fetched sucessfully, page scope: 20/50
genre=sport, new book has been fetched sucessfully, page scope: 29/50
genre=psychology, new book has been fetched sucessfully, page scope: 34/50
genre=adult, new book has been fetched sucessfully, page scope: 21/50
genre=psychology, new book has been fetched sucessfully, page scope: 35/50
genre=sport, new book has been fetched sucessfully, page scope: 30/50
genre=adult, new book has been fetched sucessfully, page scope: 22/50
genre=sport, new book has been fetched sucessfully, page scope: 31/50
genre=psychology, new book has been fetched sucessfully, page scope: 36/50
genre=sport, new book has been fetched sucessfully, page scope: 32/50
genre=travel, new book has been fetched sucessfully, page scope: 27/50
genre=psychology, new book has been fetched sucessfully, page scope: 37/50
genre=adult, new book has been fetched sucessfully, page scope: 23/50
genre=travel, new book has been fetched sucessfully, page scope: 28/50
genre=psychology, new book has been fetched sucessfully, page scope: 38/50
genre=sport, new book has been fetched sucessfully, page scope: 33/50
genre=adult, new book has been fetched sucessfully, page scope: 24/50
genre=travel, new book has been fetched sucessfully, page scope: 29/50
genre=psychology, new book has been fetched sucessfully, page scope: 39/50
genre=sport, new book has been fetched sucessfully, page scope: 34/50
genre=travel, new book has been fetched sucessfully, page scope: 30/50
genre=adult, new book has been fetched sucessfully, page scope: 25/50
genre=sport, new book has been fetched sucessfully, page scope: 35/50
genre=psychology, new book has been fetched sucessfully, page scope: 40/50
genre=travel, new book has been fetched sucessfully, page scope: 31/50
genre=psychology, new book has been fetched sucessfully, page scope: 41/50
genre=sport, new book has been fetched sucessfully, page scope: 36/50
genre=adult, new book has been fetched sucessfully, page scope: 26/50
genre=travel, new book has been fetched sucessfully, page scope: 32/50
genre=thriller, new book has been fetched sucessfully, page scope: 27/50
genre=psychology, new book has been fetched sucessfully, page scope: 42/50
genre=adult, new book has been fetched sucessfully, page scope: 27/50
genre=sport, new book has been fetched sucessfully, page scope: 37/50
genre=travel, new book has been fetched sucessfully, page scope: 33/50
genre=thriller, new book has been fetched sucessfully, page scope: 28/50
genre=psychology, new book has been fetched sucessfully, page scope: 43/50
genre=sport, new book has been fetched sucessfully, page scope: 38/50
genre=adult, new book has been fetched sucessfully, page scope: 28/50
genre=travel, new book has been fetched sucessfully, page scope: 34/50
genre=psychology, new book has been fetched sucessfully, page scope: 44/50
genre=thriller, new book has been fetched sucessfully, page scope: 29/50
genre=sport, new book has been fetched sucessfully, page scope: 39/50
genre=travel, new book has been fetched sucessfully, page scope: 35/50
genre=adult, new book has been fetched sucessfully, page scope: 29/50
genre=psychology, new book has been fetched sucessfully, page scope: 45/50
genre=thriller, new book has been fetched sucessfully, page scope: 30/50
genre=sport, new book has been fetched sucessfully, page scope: 40/50
genre=adult, new book has been fetched sucessfully, page scope: 30/50
genre=psychology, new book has been fetched sucessfully, page scope: 46/50
genre=sport, new book has been fetched sucessfully, page scope: 41/50
genre=thriller, new book has been fetched sucessfully, page scope: 31/50
genre=adult, new book has been fetched sucessfully, page scope: 31/50
genre=psychology, new book has been fetched sucessfully, page scope: 47/50
genre=thriller, new book has been fetched sucessfully, page scope: 32/50
genre=sport, new book has been fetched sucessfully, page scope: 42/50
genre=psychology, new book has been fetched sucessfully, page scope: 48/50
genre=adult, new book has been fetched sucessfully, page scope: 32/50
genre=thriller, new book has been fetched sucessfully, page scope: 33/50
genre=psychology, new book has been fetched sucessfully, page scope: 49/50
genre=sport, new book has been fetched sucessfully, page scope: 43/50
genre=thriller, new book has been fetched sucessfully, page scope: 34/50
genre=psychology, new book has been fetched sucessfully, page scope: 50/50
fetching genre=psychology, page=22
genre=sport, new book has been fetched sucessfully, page scope: 44/50
genre=thriller, new book has been fetched sucessfully, page scope: 35/50
genre=psychology, new book has been fetched sucessfully, page scope: 1/50
genre=sport, new book has been fetched sucessfully, page scope: 45/50
genre=thriller, new book has been fetched sucessfully, page scope: 36/50
genre=psychology, new book has been fetched sucessfully, page scope: 2/50
genre=sport, new book has been fetched sucessfully, page scope: 46/50
genre=psychology, new book has been fetched sucessfully, page scope: 3/50
genre=sport, new book has been fetched sucessfully, page scope: 47/50
genre=thriller, new book has been fetched sucessfully, page scope: 37/50
genre=psychology, new book has been fetched sucessfully, page scope: 4/50
genre=sport, new book has been fetched sucessfully, page scope: 48/50
genre=thriller, new book has been fetched sucessfully, page scope: 38/50
genre=travel, new book has been fetched sucessfully, page scope: 36/50
genre=psychology, new book has been fetched sucessfully, page scope: 5/50
genre=sport, new book has been fetched sucessfully, page scope: 49/50
genre=travel, new book has been fetched sucessfully, page scope: 37/50
genre=psychology, new book has been fetched sucessfully, page scope: 6/50
genre=sport, new book has been fetched sucessfully, page scope: 50/50
fetching genre=sport, page=22
genre=psychology, new book has been fetched sucessfully, page scope: 7/50
genre=sport, new book has been fetched sucessfully, page scope: 1/50
genre=psychology, new book has been fetched sucessfully, page scope: 8/50
genre=sport, new book has been fetched sucessfully, page scope: 2/50
genre=adult, new book has been fetched sucessfully, page scope: 33/50
genre=psychology, new book has been fetched sucessfully, page scope: 9/50
genre=psychology, new book has been fetched sucessfully, page scope: 10/50
genre=adult, new book has been fetched sucessfully, page scope: 34/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=psychology, new book has been fetched sucessfully, page scope: 11/50
genre=adult, new book has been fetched sucessfully, page scope: 35/50
genre=psychology, new book has been fetched sucessfully, page scope: 12/50
genre=adult, new book has been fetched sucessfully, page scope: 36/50
genre=psychology, new book has been fetched sucessfully, page scope: 13/50
genre=adult, new book has been fetched sucessfully, page scope: 37/50
genre=psychology, new book has been fetched sucessfully, page scope: 14/50
genre=adult, new book has been fetched sucessfully, page scope: 38/50
genre=psychology, new book has been fetched sucessfully, page scope: 15/50
genre=psychology, new book has been fetched sucessfully, page scope: 16/50
genre=adult, new book has been fetched sucessfully, page scope: 39/50
genre=thriller, new book has been fetched sucessfully, page scope: 39/50
genre=travel, new book has been fetched sucessfully, page scope: 38/50
genre=psychology, new book has been fetched sucessfully, page scope: 17/50
genre=adult, new book has been fetched sucessfully, page scope: 40/50
genre=thriller, new book has been fetched sucessfully, page scope: 40/50
genre=travel, new book has been fetched sucessfully, page scope: 39/50
genre=psychology, new book has been fetched sucessfully, page scope: 18/50
genre=thriller, new book has been fetched sucessfully, page scope: 41/50
genre=adult, new book has been fetched sucessfully, page scope: 41/50
genre=travel, new book has been fetched sucessfully, page scope: 40/50
genre=sport, new book has been fetched sucessfully, page scope: 3/50
genre=psychology, new book has been fetched sucessfully, page scope: 19/50
genre=sport, new book has been fetched sucessfully, page scope: 4/50
genre=adult, new book has been fetched sucessfully, page scope: 42/50
genre=travel, new book has been fetched sucessfully, page scope: 41/50
genre=thriller, new book has been fetched sucessfully, page scope: 42/50
genre=psychology, new book has been fetched sucessfully, page scope: 20/50
genre=sport, new book has been fetched sucessfully, page scope: 5/50
genre=adult, new book has been fetched sucessfully, page scope: 43/50
genre=travel, new book has been fetched sucessfully, page scope: 42/50
genre=thriller, new book has been fetched sucessfully, page scope: 43/50
genre=psychology, new book has been fetched sucessfully, page scope: 21/50
genre=sport, new book has been fetched sucessfully, page scope: 6/50
genre=travel, new book has been fetched sucessfully, page scope: 43/50
genre=adult, new book has been fetched sucessfully, page scope: 44/50
genre=sport, new book has been fetched sucessfully, page scope: 7/50
genre=psychology, new book has been fetched sucessfully, page scope: 22/50
genre=thriller, new book has been fetched sucessfully, page scope: 44/50
genre=travel, new book has been fetched sucessfully, page scope: 44/50
genre=sport, new book has been fetched sucessfully, page scope: 8/50
genre=adult, new book has been fetched sucessfully, page scope: 45/50
genre=psychology, new book has been fetched sucessfully, page scope: 23/50
genre=thriller, new book has been fetched sucessfully, page scope: 45/50
genre=travel, new book has been fetched sucessfully, page scope: 45/50
genre=sport, new book has been fetched sucessfully, page scope: 9/50
genre=adult, new book has been fetched sucessfully, page scope: 46/50
genre=psychology, new book has been fetched sucessfully, page scope: 24/50
genre=thriller, new book has been fetched sucessfully, page scope: 46/50
genre=sport, new book has been fetched sucessfully, page scope: 10/50
genre=travel, new book has been fetched sucessfully, page scope: 46/50
genre=adult, new book has been fetched sucessfully, page scope: 47/50
genre=psychology, new book has been fetched sucessfully, page scope: 25/50
genre=thriller, new book has been fetched sucessfully, page scope: 47/50
genre=travel, new book has been fetched sucessfully, page scope: 47/50
genre=sport, new book has been fetched sucessfully, page scope: 11/50
genre=psychology, new book has been fetched sucessfully, page scope: 26/50
genre=adult, new book has been fetched sucessfully, page scope: 48/50
genre=sport, new book has been fetched sucessfully, page scope: 12/50
genre=thriller, new book has been fetched sucessfully, page scope: 48/50
genre=travel, new book has been fetched sucessfully, page scope: 48/50
genre=psychology, new book has been fetched sucessfully, page scope: 27/50
genre=adult, new book has been fetched sucessfully, page scope: 49/50
genre=sport, new book has been fetched sucessfully, page scope: 13/50
genre=travel, new book has been fetched sucessfully, page scope: 49/50
genre=thriller, new book has been fetched sucessfully, page scope: 49/50
genre=psychology, new book has been fetched sucessfully, page scope: 28/50
genre=sport, new book has been fetched sucessfully, page scope: 14/50
genre=travel, new book has been fetched sucessfully, page scope: 50/50
fetching genre=travel, page=22
genre=thriller, new book has been fetched sucessfully, page scope: 50/50
fetching genre=thriller, page=22
genre=sport, new book has been fetched sucessfully, page scope: 15/50
genre=psychology, new book has been fetched sucessfully, page scope: 29/50
genre=sport, new book has been fetched sucessfully, page scope: 16/50
genre=travel, new book has been fetched sucessfully, page scope: 1/50
genre=psychology, new book has been fetched sucessfully, page scope: 30/50
genre=thriller, new book has been fetched sucessfully, page scope: 1/50
genre=sport, new book has been fetched sucessfully, page scope: 17/50
genre=travel, new book has been fetched sucessfully, page scope: 2/50
genre=psychology, new book has been fetched sucessfully, page scope: 31/50
genre=thriller, new book has been fetched sucessfully, page scope: 2/50
genre=sport, new book has been fetched sucessfully, page scope: 18/50
genre=travel, new book has been fetched sucessfully, page scope: 3/50
genre=thriller, new book has been fetched sucessfully, page scope: 3/50
genre=psychology, new book has been fetched sucessfully, page scope: 32/50
genre=sport, new book has been fetched sucessfully, page scope: 19/50
genre=travel, new book has been fetched sucessfully, page scope: 4/50
genre=thriller, new book has been fetched sucessfully, page scope: 4/50
genre=psychology, new book has been fetched sucessfully, page scope: 33/50
genre=sport, new book has been fetched sucessfully, page scope: 20/50
genre=thriller, new book has been fetched sucessfully, page scope: 5/50
genre=travel, new book has been fetched sucessfully, page scope: 5/50
genre=psychology, new book has been fetched sucessfully, page scope: 34/50
genre=sport, new book has been fetched sucessfully, page scope: 21/50
genre=psychology, new book has been fetched sucessfully, page scope: 35/50
genre=travel, new book has been fetched sucessfully, page scope: 6/50
genre=thriller, new book has been fetched sucessfully, page scope: 6/50
genre=psychology, new book has been fetched sucessfully, page scope: 36/50
genre=travel, new book has been fetched sucessfully, page scope: 7/50
genre=thriller, new book has been fetched sucessfully, page scope: 7/50
genre=sport, new book has been fetched sucessfully, page scope: 22/50
genre=adult, new book has been fetched sucessfully, page scope: 50/50
fetching genre=adult, page=22
genre=travel, new book has been fetched sucessfully, page scope: 8/50
genre=psychology, new book has been fetched sucessfully, page scope: 37/50
genre=sport, new book has been fetched sucessfully, page scope: 23/50
genre=thriller, new book has been fetched sucessfully, page scope: 8/50
genre=adult, new book has been fetched sucessfully, page scope: 1/50
genre=travel, new book has been fetched sucessfully, page scope: 9/50
genre=psychology, new book has been fetched sucessfully, page scope: 38/50
genre=thriller, new book has been fetched sucessfully, page scope: 9/50
genre=sport, new book has been fetched sucessfully, page scope: 24/50
genre=psychology, new book has been fetched sucessfully, page scope: 39/50
genre=travel, new book has been fetched sucessfully, page scope: 10/50
genre=adult, new book has been fetched sucessfully, page scope: 2/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=thriller, new book has been fetched sucessfully, page scope: 10/50
genre=travel, new book has been fetched sucessfully, page scope: 11/50
genre=sport, new book has been fetched sucessfully, page scope: 25/50
genre=psychology, new book has been fetched sucessfully, page scope: 40/50
genre=adult, new book has been fetched sucessfully, page scope: 3/50
genre=thriller, new book has been fetched sucessfully, page scope: 11/50
genre=travel, new book has been fetched sucessfully, page scope: 12/50
genre=psychology, new book has been fetched sucessfully, page scope: 41/50
genre=sport, new book has been fetched sucessfully, page scope: 26/50
genre=adult, new book has been fetched sucessfully, page scope: 4/50
genre=travel, new book has been fetched sucessfully, page scope: 13/50
genre=thriller, new book has been fetched sucessfully, page scope: 12/50
genre=psychology, new book has been fetched sucessfully, page scope: 42/50
genre=adult, new book has been fetched sucessfully, page scope: 5/50
genre=travel, new book has been fetched sucessfully, page scope: 14/50
genre=sport, new book has been fetched sucessfully, page scope: 27/50
genre=psychology, new book has been fetched sucessfully, page scope: 43/50
genre=thriller, new book has been fetched sucessfully, page scope: 13/50
genre=travel, new book has been fetched sucessfully, page scope: 15/50
genre=sport, new book has been fetched sucessfully, page scope: 28/50
genre=psychology, new book has been fetched sucessfully, page scope: 44/50
genre=thriller, new book has been fetched sucessfully, page scope: 14/50
genre=sport, new book has been fetched sucessfully, page scope: 29/50
genre=travel, new book has been fetched sucessfully, page scope: 16/50
genre=psychology, new book has been fetched sucessfully, page scope: 45/50
genre=thriller, new book has been fetched sucessfully, page scope: 15/50
genre=travel, new book has been fetched sucessfully, page scope: 17/50
genre=sport, new book has been fetched sucessfully, page scope: 30/50
genre=psychology, new book has been fetched sucessfully, page scope: 46/50
genre=thriller, new book has been fetched sucessfully, page scope: 16/50
genre=travel, new book has been fetched sucessfully, page scope: 18/50
genre=psychology, new book has been fetched sucessfully, page scope: 47/50
genre=sport, new book has been fetched sucessfully, page scope: 31/50
genre=thriller, new book has been fetched sucessfully, page scope: 17/50
genre=travel, new book has been fetched sucessfully, page scope: 19/50
genre=psychology, new book has been fetched sucessfully, page scope: 48/50
genre=sport, new book has been fetched sucessfully, page scope: 32/50
genre=thriller, new book has been fetched sucessfully, page scope: 18/50
genre=travel, new book has been fetched sucessfully, page scope: 20/50
genre=sport, new book has been fetched sucessfully, page scope: 33/50
genre=psychology, new book has been fetched sucessfully, page scope: 49/50
genre=thriller, new book has been fetched sucessfully, page scope: 19/50
genre=travel, new book has been fetched sucessfully, page scope: 21/50
genre=psychology, new book has been fetched sucessfully, page scope: 50/50
fetching genre=psychology, page=23
genre=sport, new book has been fetched sucessfully, page scope: 34/50
genre=travel, new book has been fetched sucessfully, page scope: 22/50
genre=thriller, new book has been fetched sucessfully, page scope: 20/50
genre=sport, new book has been fetched sucessfully, page scope: 35/50
genre=psychology, new book has been fetched sucessfully, page scope: 1/50
genre=adult, new book has been fetched sucessfully, page scope: 6/50
genre=travel, new book has been fetched sucessfully, page scope: 23/50
genre=thriller, new book has been fetched sucessfully, page scope: 21/50
genre=psychology, new book has been fetched sucessfully, page scope: 2/50
genre=sport, new book has been fetched sucessfully, page scope: 36/50
genre=travel, new book has been fetched sucessfully, page scope: 24/50
genre=adult, new book has been fetched sucessfully, page scope: 7/50
genre=thriller, new book has been fetched sucessfully, page scope: 22/50
genre=psychology, new book has been fetched sucessfully, page scope: 3/50
genre=travel, new book has been fetched sucessfully, page scope: 25/50
genre=sport, new book has been fetched sucessfully, page scope: 37/50
genre=adult, new book has been fetched sucessfully, page scope: 8/50
genre=thriller, new book has been fetched sucessfully, page scope: 23/50
genre=psychology, new book has been fetched sucessfully, page scope: 4/50
genre=travel, new book has been fetched sucessfully, page scope: 26/50
genre=thriller, new book has been fetched sucessfully, page scope: 24/50
genre=sport, new book has been fetched sucessfully, page scope: 38/50genre=adult, new book has been fetched sucessfully, page scope: 9/50

genre=psychology, new book has been fetched sucessfully, page scope: 5/50
genre=travel, new book has been fetched sucessfully, page scope: 27/50
genre=thriller, new book has been fetched sucessfully, page scope: 25/50
genre=psychology, new book has been fetched sucessfully, page scope: 6/50
genre=adult, new book has been fetched sucessfully, page scope: 10/50
genre=sport, new book has been fetched sucessfully, page scope: 39/50
genre=travel, new book has been fetched sucessfully, page scope: 28/50
genre=psychology, new book has been fetched sucessfully, page scope: 7/50
genre=thriller, new book has been fetched sucessfully, page scope: 26/50
genre=adult, new book has been fetched sucessfully, page scope: 11/50
genre=travel, new book has been fetched sucessfully, page scope: 29/50
genre=sport, new book has been fetched sucessfully, page scope: 40/50
genre=psychology, new book has been fetched sucessfully, page scope: 8/50
genre=thriller, new book has been fetched sucessfully, page scope: 27/50
genre=travel, new book has been fetched sucessfully, page scope: 30/50
genre=adult, new book has been fetched sucessfully, page scope: 12/50
genre=sport, new book has been fetched sucessfully, page scope: 41/50
genre=psychology, new book has been fetched sucessfully, page scope: 9/50
genre=travel, new book has been fetched sucessfully, page scope: 31/50
genre=thriller, new book has been fetched sucessfully, page scope: 28/50
genre=adult, new book has been fetched sucessfully, page scope: 13/50
genre=psychology, new book has been fetched sucessfully, page scope: 10/50
genre=travel, new book has been fetched sucessfully, page scope: 32/50
genre=sport, new book has been fetched sucessfully, page scope: 42/50
genre=thriller, new book has been fetched sucessfully, page scope: 29/50
genre=adult, new book has been fetched sucessfully, page scope: 14/50
genre=sport, new book has been fetched sucessfully, page scope: 43/50
genre=travel, new book has been fetched sucessfully, page scope: 33/50
genre=psychology, new book has been fetched sucessfully, page scope: 11/50
genre=thriller, new book has been fetched sucessfully, page scope: 30/50
genre=adult, new book has been fetched sucessfully, page scope: 15/50
genre=travel, new book has been fetched sucessfully, page scope: 34/50
genre=psychology, new book has been fetched sucessfully, page scope: 12/50
genre=sport, new book has been fetched sucessfully, page scope: 44/50
genre=thriller, new book has been fetched sucessfully, page scope: 31/50
genre=adult, new book has been fetched sucessfully, page scope: 16/50
genre=travel, new book has been fetched sucessfully, page scope: 35/50
genre=psychology, new book has been fetched sucessfully, page scope: 13/50
genre=thriller, new book has been fetched sucessfully, page scope: 32/50
genre=sport, new book has been fetched sucessfully, page scope: 45/50
genre=adult, new book has been fetched sucessfully, page scope: 17/50
genre=travel, new book has been fetched sucessfully, page scope: 36/50
genre=psychology, new book has been fetched sucessfully, page scope: 14/50
genre=thriller, new book has been fetched sucessfully, page scope: 33/50
genre=sport, new book has been fetched sucessfully, page scope: 46/50
genre=adult, new book has been fetched sucessfully, page scope: 18/50
genre=travel, new book has been fetched sucessfully, page scope: 37/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=psychology, new book has been fetched sucessfully, page scope: 15/50
genre=thriller, new book has been fetched sucessfully, page scope: 34/50
genre=sport, new book has been fetched sucessfully, page scope: 47/50
genre=travel, new book has been fetched sucessfully, page scope: 38/50
genre=adult, new book has been fetched sucessfully, page scope: 19/50
genre=psychology, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 35/50
genre=travel, new book has been fetched sucessfully, page scope: 39/50
genre=sport, new book has been fetched sucessfully, page scope: 48/50
genre=psychology, new book has been fetched sucessfully, page scope: 17/50
genre=adult, new book has been fetched sucessfully, page scope: 20/50
genre=travel, new book has been fetched sucessfully, page scope: 40/50
genre=thriller, new book has been fetched sucessfully, page scope: 36/50
genre=sport, new book has been fetched sucessfully, page scope: 49/50
genre=adult, new book has been fetched sucessfully, page scope: 21/50
genre=psychology, new book has been fetched sucessfully, page scope: 18/50
genre=thriller, new book has been fetched sucessfully, page scope: 37/50
genre=travel, new book has been fetched sucessfully, page scope: 41/50
genre=adult, new book has been fetched sucessfully, page scope: 22/50
genre=sport, new book has been fetched sucessfully, page scope: 50/50
fetching genre=sport, page=23
genre=psychology, new book has been fetched sucessfully, page scope: 19/50
genre=travel, new book has been fetched sucessfully, page scope: 42/50
genre=thriller, new book has been fetched sucessfully, page scope: 38/50
genre=adult, new book has been fetched sucessfully, page scope: 23/50
genre=psychology, new book has been fetched sucessfully, page scope: 20/50
genre=sport, new book has been fetched sucessfully, page scope: 1/50
genre=travel, new book has been fetched sucessfully, page scope: 43/50
genre=adult, new book has been fetched sucessfully, page scope: 24/50
genre=thriller, new book has been fetched sucessfully, page scope: 39/50
genre=psychology, new book has been fetched sucessfully, page scope: 21/50
genre=travel, new book has been fetched sucessfully, page scope: 44/50
genre=sport, new book has been fetched sucessfully, page scope: 2/50
genre=adult, new book has been fetched sucessfully, page scope: 25/50
genre=psychology, new book has been fetched sucessfully, page scope: 22/50
genre=thriller, new book has been fetched sucessfully, page scope: 40/50
genre=travel, new book has been fetched sucessfully, page scope: 45/50
genre=sport, new book has been fetched sucessfully, page scope: 3/50
genre=psychology, new book has been fetched sucessfully, page scope: 23/50
genre=travel, new book has been fetched sucessfully, page scope: 46/50
genre=thriller, new book has been fetched sucessfully, page scope: 41/50
genre=adult, new book has been fetched sucessfully, page scope: 26/50
genre=sport, new book has been fetched sucessfully, page scope: 4/50
genre=psychology, new book has been fetched sucessfully, page scope: 24/50
genre=travel, new book has been fetched sucessfully, page scope: 47/50
genre=thriller, new book has been fetched sucessfully, page scope: 42/50
genre=sport, new book has been fetched sucessfully, page scope: 5/50
genre=adult, new book has been fetched sucessfully, page scope: 27/50
genre=psychology, new book has been fetched sucessfully, page scope: 25/50
genre=travel, new book has been fetched sucessfully, page scope: 48/50
genre=thriller, new book has been fetched sucessfully, page scope: 43/50
genre=psychology, new book has been fetched sucessfully, page scope: 26/50
genre=sport, new book has been fetched sucessfully, page scope: 6/50
genre=adult, new book has been fetched sucessfully, page scope: 28/50
genre=thriller, new book has been fetched sucessfully, page scope: 44/50
genre=psychology, new book has been fetched sucessfully, page scope: 27/50
genre=sport, new book has been fetched sucessfully, page scope: 7/50
genre=adult, new book has been fetched sucessfully, page scope: 29/50
genre=psychology, new book has been fetched sucessfully, page scope: 28/50
genre=thriller, new book has been fetched sucessfully, page scope: 45/50
genre=sport, new book has been fetched sucessfully, page scope: 8/50
genre=adult, new book has been fetched sucessfully, page scope: 30/50
genre=psychology, new book has been fetched sucessfully, page scope: 29/50
genre=thriller, new book has been fetched sucessfully, page scope: 46/50
genre=sport, new book has been fetched sucessfully, page scope: 9/50
genre=psychology, new book has been fetched sucessfully, page scope: 30/50
genre=adult, new book has been fetched sucessfully, page scope: 31/50
genre=thriller, new book has been fetched sucessfully, page scope: 47/50
genre=psychology, new book has been fetched sucessfully, page scope: 31/50
genre=sport, new book has been fetched sucessfully, page scope: 10/50
genre=adult, new book has been fetched sucessfully, page scope: 32/50
genre=thriller, new book has been fetched sucessfully, page scope: 48/50
genre=psychology, new book has been fetched sucessfully, page scope: 32/50
genre=sport, new book has been fetched sucessfully, page scope: 11/50
genre=adult, new book has been fetched sucessfully, page scope: 33/50
genre=thriller, new book has been fetched sucessfully, page scope: 49/50
genre=psychology, new book has been fetched sucessfully, page scope: 33/50
genre=sport, new book has been fetched sucessfully, page scope: 12/50
genre=adult, new book has been fetched sucessfully, page scope: 34/50
genre=thriller, new book has been fetched sucessfully, page scope: 50/50
fetching genre=thriller, page=23
genre=psychology, new book has been fetched sucessfully, page scope: 34/50
genre=sport, new book has been fetched sucessfully, page scope: 13/50
genre=adult, new book has been fetched sucessfully, page scope: 35/50
genre=psychology, new book has been fetched sucessfully, page scope: 35/50
genre=travel, new book has been fetched sucessfully, page scope: 49/50
genre=thriller, new book has been fetched sucessfully, page scope: 1/50
genre=psychology, new book has been fetched sucessfully, page scope: 36/50
genre=travel, new book has been fetched sucessfully, page scope: 50/50
fetching genre=travel, page=23
genre=sport, new book has been fetched sucessfully, page scope: 14/50
genre=adult, new book has been fetched sucessfully, page scope: 36/50
genre=thriller, new book has been fetched sucessfully, page scope: 2/50
genre=travel, new book has been fetched sucessfully, page scope: 1/50
genre=psychology, new book has been fetched sucessfully, page scope: 37/50
genre=sport, new book has been fetched sucessfully, page scope: 15/50
genre=adult, new book has been fetched sucessfully, page scope: 37/50
genre=thriller, new book has been fetched sucessfully, page scope: 3/50
genre=psychology, new book has been fetched sucessfully, page scope: 38/50
genre=travel, new book has been fetched sucessfully, page scope: 2/50
genre=sport, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 4/50
genre=adult, new book has been fetched sucessfully, page scope: 38/50
genre=psychology, new book has been fetched sucessfully, page scope: 39/50
genre=travel, new book has been fetched sucessfully, page scope: 3/50
genre=sport, new book has been fetched sucessfully, page scope: 17/50
genre=thriller, new book has been fetched sucessfully, page scope: 5/50
genre=psychology, new book has been fetched sucessfully, page scope: 40/50
genre=adult, new book has been fetched sucessfully, page scope: 39/50
genre=travel, new book has been fetched sucessfully, page scope: 4/50
genre=sport, new book has been fetched sucessfully, page scope: 18/50
genre=psychology, new book has been fetched sucessfully, page scope: 41/50
genre=travel, new book has been fetched sucessfully, page scope: 5/50
genre=adult, new book has been fetched sucessfully, page scope: 40/50
genre=thriller, new book has been fetched sucessfully, page scope: 6/50
genre=sport, new book has been fetched sucessfully, page scope: 19/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=psychology, new book has been fetched sucessfully, page scope: 42/50
genre=thriller, new book has been fetched sucessfully, page scope: 7/50
genre=travel, new book has been fetched sucessfully, page scope: 6/50
genre=adult, new book has been fetched sucessfully, page scope: 41/50
genre=psychology, new book has been fetched sucessfully, page scope: 43/50
genre=sport, new book has been fetched sucessfully, page scope: 20/50
genre=thriller, new book has been fetched sucessfully, page scope: 8/50
genre=travel, new book has been fetched sucessfully, page scope: 7/50
genre=adult, new book has been fetched sucessfully, page scope: 42/50
genre=thriller, new book has been fetched sucessfully, page scope: 9/50
genre=sport, new book has been fetched sucessfully, page scope: 21/50
genre=travel, new book has been fetched sucessfully, page scope: 8/50
genre=adult, new book has been fetched sucessfully, page scope: 43/50
genre=thriller, new book has been fetched sucessfully, page scope: 10/50
genre=travel, new book has been fetched sucessfully, page scope: 9/50
genre=sport, new book has been fetched sucessfully, page scope: 22/50
genre=adult, new book has been fetched sucessfully, page scope: 44/50
genre=travel, new book has been fetched sucessfully, page scope: 10/50
genre=thriller, new book has been fetched sucessfully, page scope: 11/50
genre=sport, new book has been fetched sucessfully, page scope: 23/50
genre=adult, new book has been fetched sucessfully, page scope: 45/50
genre=travel, new book has been fetched sucessfully, page scope: 11/50
genre=thriller, new book has been fetched sucessfully, page scope: 12/50
genre=adult, new book has been fetched sucessfully, page scope: 46/50
genre=sport, new book has been fetched sucessfully, page scope: 24/50
genre=travel, new book has been fetched sucessfully, page scope: 12/50
genre=adult, new book has been fetched sucessfully, page scope: 47/50
genre=thriller, new book has been fetched sucessfully, page scope: 13/50
genre=sport, new book has been fetched sucessfully, page scope: 25/50
genre=travel, new book has been fetched sucessfully, page scope: 13/50
genre=adult, new book has been fetched sucessfully, page scope: 48/50
genre=thriller, new book has been fetched sucessfully, page scope: 14/50
genre=travel, new book has been fetched sucessfully, page scope: 14/50
genre=sport, new book has been fetched sucessfully, page scope: 26/50
genre=adult, new book has been fetched sucessfully, page scope: 49/50
genre=thriller, new book has been fetched sucessfully, page scope: 15/50
genre=travel, new book has been fetched sucessfully, page scope: 15/50
genre=sport, new book has been fetched sucessfully, page scope: 27/50
genre=psychology, new book has been fetched sucessfully, page scope: 44/50
genre=travel, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 16/50
genre=adult, new book has been fetched sucessfully, page scope: 50/50
fetching genre=adult, page=23
genre=sport, new book has been fetched sucessfully, page scope: 28/50
genre=psychology, new book has been fetched sucessfully, page scope: 45/50
genre=travel, new book has been fetched sucessfully, page scope: 17/50
genre=thriller, new book has been fetched sucessfully, page scope: 17/50
genre=psychology, new book has been fetched sucessfully, page scope: 46/50
genre=sport, new book has been fetched sucessfully, page scope: 29/50
genre=adult, new book has been fetched sucessfully, page scope: 1/50
genre=travel, new book has been fetched sucessfully, page scope: 18/50
genre=thriller, new book has been fetched sucessfully, page scope: 18/50
genre=psychology, new book has been fetched sucessfully, page scope: 47/50
genre=adult, new book has been fetched sucessfully, page scope: 2/50
genre=travel, new book has been fetched sucessfully, page scope: 19/50
genre=sport, new book has been fetched sucessfully, page scope: 30/50
genre=thriller, new book has been fetched sucessfully, page scope: 19/50
genre=psychology, new book has been fetched sucessfully, page scope: 48/50
genre=adult, new book has been fetched sucessfully, page scope: 3/50
genre=travel, new book has been fetched sucessfully, page scope: 20/50
genre=sport, new book has been fetched sucessfully, page scope: 31/50
genre=thriller, new book has been fetched sucessfully, page scope: 20/50
genre=adult, new book has been fetched sucessfully, page scope: 4/50
genre=travel, new book has been fetched sucessfully, page scope: 21/50
genre=psychology, new book has been fetched sucessfully, page scope: 49/50
genre=adult, new book has been fetched sucessfully, page scope: 5/50
genre=travel, new book has been fetched sucessfully, page scope: 22/50
genre=thriller, new book has been fetched sucessfully, page scope: 21/50
genre=sport, new book has been fetched sucessfully, page scope: 32/50
genre=psychology, new book has been fetched sucessfully, page scope: 50/50
fetching genre=psychology, page=24
genre=adult, new book has been fetched sucessfully, page scope: 6/50
genre=travel, new book has been fetched sucessfully, page scope: 23/50
genre=sport, new book has been fetched sucessfully, page scope: 33/50
genre=psychology, new book has been fetched sucessfully, page scope: 1/50
genre=thriller, new book has been fetched sucessfully, page scope: 22/50
genre=adult, new book has been fetched sucessfully, page scope: 7/50
genre=travel, new book has been fetched sucessfully, page scope: 24/50
genre=sport, new book has been fetched sucessfully, page scope: 34/50
genre=psychology, new book has been fetched sucessfully, page scope: 2/50
genre=thriller, new book has been fetched sucessfully, page scope: 23/50
genre=adult, new book has been fetched sucessfully, page scope: 8/50
genre=sport, new book has been fetched sucessfully, page scope: 35/50
genre=travel, new book has been fetched sucessfully, page scope: 25/50
genre=psychology, new book has been fetched sucessfully, page scope: 3/50
genre=sport, new book has been fetched sucessfully, page scope: 36/50
genre=travel, new book has been fetched sucessfully, page scope: 26/50
genre=thriller, new book has been fetched sucessfully, page scope: 24/50
genre=adult, new book has been fetched sucessfully, page scope: 9/50
genre=psychology, new book has been fetched sucessfully, page scope: 4/50
genre=sport, new book has been fetched sucessfully, page scope: 37/50
genre=travel, new book has been fetched sucessfully, page scope: 27/50
genre=thriller, new book has been fetched sucessfully, page scope: 25/50
genre=adult, new book has been fetched sucessfully, page scope: 10/50
genre=psychology, new book has been fetched sucessfully, page scope: 5/50
genre=sport, new book has been fetched sucessfully, page scope: 38/50
genre=travel, new book has been fetched sucessfully, page scope: 28/50
genre=adult, new book has been fetched sucessfully, page scope: 11/50
genre=thriller, new book has been fetched sucessfully, page scope: 26/50
genre=psychology, new book has been fetched sucessfully, page scope: 6/50
genre=sport, new book has been fetched sucessfully, page scope: 39/50
genre=travel, new book has been fetched sucessfully, page scope: 29/50
genre=adult, new book has been fetched sucessfully, page scope: 12/50
genre=psychology, new book has been fetched sucessfully, page scope: 7/50
genre=sport, new book has been fetched sucessfully, page scope: 40/50
genre=thriller, new book has been fetched sucessfully, page scope: 27/50
genre=travel, new book has been fetched sucessfully, page scope: 30/50
genre=adult, new book has been fetched sucessfully, page scope: 13/50
genre=psychology, new book has been fetched sucessfully, page scope: 8/50
genre=travel, new book has been fetched sucessfully, page scope: 31/50
genre=sport, new book has been fetched sucessfully, page scope: 41/50
genre=psychology, new book has been fetched sucessfully, page scope: 9/50
genre=thriller, new book has been fetched sucessfully, page scope: 28/50
genre=adult, new book has been fetched sucessfully, page scope: 14/50
genre=travel, new book has been fetched sucessfully, page scope: 32/50
genre=sport, new book has been fetched sucessfully, page scope: 42/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=adult, new book has been fetched sucessfully, page scope: 15/50genre=psychology, new book has been fetched sucessfully, page scope: 10/50

genre=thriller, new book has been fetched sucessfully, page scope: 29/50
genre=travel, new book has been fetched sucessfully, page scope: 33/50
genre=sport, new book has been fetched sucessfully, page scope: 43/50
genre=psychology, new book has been fetched sucessfully, page scope: 11/50
genre=adult, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 30/50
genre=travel, new book has been fetched sucessfully, page scope: 34/50
genre=psychology, new book has been fetched sucessfully, page scope: 12/50
genre=adult, new book has been fetched sucessfully, page scope: 17/50
genre=sport, new book has been fetched sucessfully, page scope: 44/50
genre=thriller, new book has been fetched sucessfully, page scope: 31/50
genre=travel, new book has been fetched sucessfully, page scope: 35/50
genre=psychology, new book has been fetched sucessfully, page scope: 13/50
genre=adult, new book has been fetched sucessfully, page scope: 18/50
genre=thriller, new book has been fetched sucessfully, page scope: 32/50
genre=travel, new book has been fetched sucessfully, page scope: 36/50
genre=sport, new book has been fetched sucessfully, page scope: 45/50
genre=psychology, new book has been fetched sucessfully, page scope: 14/50
genre=adult, new book has been fetched sucessfully, page scope: 19/50
genre=travel, new book has been fetched sucessfully, page scope: 37/50
genre=thriller, new book has been fetched sucessfully, page scope: 33/50
genre=sport, new book has been fetched sucessfully, page scope: 46/50
genre=psychology, new book has been fetched sucessfully, page scope: 15/50
genre=adult, new book has been fetched sucessfully, page scope: 20/50
genre=travel, new book has been fetched sucessfully, page scope: 38/50
genre=thriller, new book has been fetched sucessfully, page scope: 34/50
genre=psychology, new book has been fetched sucessfully, page scope: 16/50
genre=adult, new book has been fetched sucessfully, page scope: 21/50
genre=sport, new book has been fetched sucessfully, page scope: 47/50
genre=travel, new book has been fetched sucessfully, page scope: 39/50
genre=thriller, new book has been fetched sucessfully, page scope: 35/50
genre=psychology, new book has been fetched sucessfully, page scope: 17/50
genre=adult, new book has been fetched sucessfully, page scope: 22/50
genre=travel, new book has been fetched sucessfully, page scope: 40/50
genre=sport, new book has been fetched sucessfully, page scope: 48/50
genre=psychology, new book has been fetched sucessfully, page scope: 18/50
genre=thriller, new book has been fetched sucessfully, page scope: 36/50
genre=adult, new book has been fetched sucessfully, page scope: 23/50
genre=sport, new book has been fetched sucessfully, page scope: 49/50
genre=travel, new book has been fetched sucessfully, page scope: 41/50
genre=psychology, new book has been fetched sucessfully, page scope: 19/50
genre=thriller, new book has been fetched sucessfully, page scope: 37/50
genre=adult, new book has been fetched sucessfully, page scope: 24/50
genre=travel, new book has been fetched sucessfully, page scope: 42/50
genre=psychology, new book has been fetched sucessfully, page scope: 20/50
genre=sport, new book has been fetched sucessfully, page scope: 50/50
fetching genre=sport, page=24
genre=thriller, new book has been fetched sucessfully, page scope: 38/50
genre=adult, new book has been fetched sucessfully, page scope: 25/50
genre=psychology, new book has been fetched sucessfully, page scope: 21/50
genre=travel, new book has been fetched sucessfully, page scope: 43/50
genre=sport, new book has been fetched sucessfully, page scope: 1/50
genre=thriller, new book has been fetched sucessfully, page scope: 39/50
genre=psychology, new book has been fetched sucessfully, page scope: 22/50
genre=travel, new book has been fetched sucessfully, page scope: 44/50
genre=adult, new book has been fetched sucessfully, page scope: 26/50
genre=thriller, new book has been fetched sucessfully, page scope: 40/50
genre=psychology, new book has been fetched sucessfully, page scope: 23/50
genre=sport, new book has been fetched sucessfully, page scope: 2/50
genre=travel, new book has been fetched sucessfully, page scope: 45/50
genre=adult, new book has been fetched sucessfully, page scope: 27/50
genre=thriller, new book has been fetched sucessfully, page scope: 41/50
genre=sport, new book has been fetched sucessfully, page scope: 3/50
genre=psychology, new book has been fetched sucessfully, page scope: 24/50
genre=travel, new book has been fetched sucessfully, page scope: 46/50
genre=thriller, new book has been fetched sucessfully, page scope: 42/50
genre=adult, new book has been fetched sucessfully, page scope: 28/50
genre=sport, new book has been fetched sucessfully, page scope: 4/50
genre=travel, new book has been fetched sucessfully, page scope: 47/50
genre=psychology, new book has been fetched sucessfully, page scope: 25/50
genre=adult, new book has been fetched sucessfully, page scope: 29/50
genre=travel, new book has been fetched sucessfully, page scope: 48/50
genre=sport, new book has been fetched sucessfully, page scope: 5/50genre=psychology, new book has been fetched sucessfully, page scope: 26/50

genre=thriller, new book has been fetched sucessfully, page scope: 43/50
genre=adult, new book has been fetched sucessfully, page scope: 30/50
genre=travel, new book has been fetched sucessfully, page scope: 49/50
genre=psychology, new book has been fetched sucessfully, page scope: 27/50
genre=sport, new book has been fetched sucessfully, page scope: 6/50
genre=thriller, new book has been fetched sucessfully, page scope: 44/50
genre=adult, new book has been fetched sucessfully, page scope: 31/50
genre=travel, new book has been fetched sucessfully, page scope: 50/50
fetching genre=travel, page=24
genre=thriller, new book has been fetched sucessfully, page scope: 45/50
genre=psychology, new book has been fetched sucessfully, page scope: 28/50
genre=sport, new book has been fetched sucessfully, page scope: 7/50
genre=adult, new book has been fetched sucessfully, page scope: 32/50
genre=travel, new book has been fetched sucessfully, page scope: 1/50
genre=psychology, new book has been fetched sucessfully, page scope: 29/50
genre=thriller, new book has been fetched sucessfully, page scope: 46/50
genre=adult, new book has been fetched sucessfully, page scope: 33/50
genre=sport, new book has been fetched sucessfully, page scope: 8/50
genre=psychology, new book has been fetched sucessfully, page scope: 30/50
genre=travel, new book has been fetched sucessfully, page scope: 2/50
genre=thriller, new book has been fetched sucessfully, page scope: 47/50
genre=adult, new book has been fetched sucessfully, page scope: 34/50
genre=sport, new book has been fetched sucessfully, page scope: 9/50
genre=travel, new book has been fetched sucessfully, page scope: 3/50
genre=psychology, new book has been fetched sucessfully, page scope: 31/50
genre=thriller, new book has been fetched sucessfully, page scope: 48/50
genre=adult, new book has been fetched sucessfully, page scope: 35/50
genre=travel, new book has been fetched sucessfully, page scope: 4/50
genre=psychology, new book has been fetched sucessfully, page scope: 32/50
genre=sport, new book has been fetched sucessfully, page scope: 10/50
genre=thriller, new book has been fetched sucessfully, page scope: 49/50
genre=sport, new book has been fetched sucessfully, page scope: 11/50
genre=travel, new book has been fetched sucessfully, page scope: 5/50
genre=psychology, new book has been fetched sucessfully, page scope: 33/50
genre=adult, new book has been fetched sucessfully, page scope: 36/50
genre=thriller, new book has been fetched sucessfully, page scope: 50/50
fetching genre=thriller, page=24
genre=sport, new book has been fetched sucessfully, page scope: 12/50
genre=travel, new book has been fetched sucessfully, page scope: 6/50
genre=psychology, new book has been fetched sucessfully, page scope: 34/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=adult, new book has been fetched sucessfully, page scope: 37/50
genre=thriller, new book has been fetched sucessfully, page scope: 1/50
genre=travel, new book has been fetched sucessfully, page scope: 7/50
genre=sport, new book has been fetched sucessfully, page scope: 13/50genre=psychology, new book has been fetched sucessfully, page scope: 35/50

genre=adult, new book has been fetched sucessfully, page scope: 38/50
genre=travel, new book has been fetched sucessfully, page scope: 8/50
genre=thriller, new book has been fetched sucessfully, page scope: 2/50
genre=psychology, new book has been fetched sucessfully, page scope: 36/50
genre=sport, new book has been fetched sucessfully, page scope: 14/50
genre=adult, new book has been fetched sucessfully, page scope: 39/50
genre=travel, new book has been fetched sucessfully, page scope: 9/50
genre=psychology, new book has been fetched sucessfully, page scope: 37/50
genre=thriller, new book has been fetched sucessfully, page scope: 3/50
genre=sport, new book has been fetched sucessfully, page scope: 15/50
genre=adult, new book has been fetched sucessfully, page scope: 40/50
genre=travel, new book has been fetched sucessfully, page scope: 10/50
genre=psychology, new book has been fetched sucessfully, page scope: 38/50
genre=sport, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 4/50
genre=travel, new book has been fetched sucessfully, page scope: 11/50
genre=adult, new book has been fetched sucessfully, page scope: 41/50
genre=psychology, new book has been fetched sucessfully, page scope: 39/50
genre=sport, new book has been fetched sucessfully, page scope: 17/50
genre=travel, new book has been fetched sucessfully, page scope: 12/50
genre=psychology, new book has been fetched sucessfully, page scope: 40/50
genre=adult, new book has been fetched sucessfully, page scope: 42/50
genre=thriller, new book has been fetched sucessfully, page scope: 5/50
genre=sport, new book has been fetched sucessfully, page scope: 18/50
genre=travel, new book has been fetched sucessfully, page scope: 13/50
genre=adult, new book has been fetched sucessfully, page scope: 43/50
genre=psychology, new book has been fetched sucessfully, page scope: 41/50
genre=thriller, new book has been fetched sucessfully, page scope: 6/50
genre=sport, new book has been fetched sucessfully, page scope: 19/50
genre=travel, new book has been fetched sucessfully, page scope: 14/50
genre=psychology, new book has been fetched sucessfully, page scope: 42/50
genre=adult, new book has been fetched sucessfully, page scope: 44/50
genre=thriller, new book has been fetched sucessfully, page scope: 7/50
genre=travel, new book has been fetched sucessfully, page scope: 15/50
genre=sport, new book has been fetched sucessfully, page scope: 20/50
genre=psychology, new book has been fetched sucessfully, page scope: 43/50
genre=thriller, new book has been fetched sucessfully, page scope: 8/50
genre=adult, new book has been fetched sucessfully, page scope: 45/50
genre=travel, new book has been fetched sucessfully, page scope: 16/50
genre=sport, new book has been fetched sucessfully, page scope: 21/50genre=psychology, new book has been fetched sucessfully, page scope: 44/50

genre=thriller, new book has been fetched sucessfully, page scope: 9/50
genre=travel, new book has been fetched sucessfully, page scope: 17/50
genre=adult, new book has been fetched sucessfully, page scope: 46/50
genre=psychology, new book has been fetched sucessfully, page scope: 45/50
genre=sport, new book has been fetched sucessfully, page scope: 22/50
genre=thriller, new book has been fetched sucessfully, page scope: 10/50
genre=travel, new book has been fetched sucessfully, page scope: 18/50
genre=psychology, new book has been fetched sucessfully, page scope: 46/50
genre=adult, new book has been fetched sucessfully, page scope: 47/50
genre=sport, new book has been fetched sucessfully, page scope: 23/50
genre=thriller, new book has been fetched sucessfully, page scope: 11/50
genre=travel, new book has been fetched sucessfully, page scope: 19/50
genre=psychology, new book has been fetched sucessfully, page scope: 47/50
genre=adult, new book has been fetched sucessfully, page scope: 48/50
genre=thriller, new book has been fetched sucessfully, page scope: 12/50
genre=travel, new book has been fetched sucessfully, page scope: 20/50
genre=sport, new book has been fetched sucessfully, page scope: 24/50
genre=psychology, new book has been fetched sucessfully, page scope: 48/50
genre=adult, new book has been fetched sucessfully, page scope: 49/50
genre=travel, new book has been fetched sucessfully, page scope: 21/50
genre=thriller, new book has been fetched sucessfully, page scope: 13/50
genre=sport, new book has been fetched sucessfully, page scope: 25/50
genre=psychology, new book has been fetched sucessfully, page scope: 49/50
genre=travel, new book has been fetched sucessfully, page scope: 22/50
genre=thriller, new book has been fetched sucessfully, page scope: 14/50
genre=sport, new book has been fetched sucessfully, page scope: 26/50
genre=psychology, new book has been fetched sucessfully, page scope: 50/50
fetching genre=psychology, page=25
genre=travel, new book has been fetched sucessfully, page scope: 23/50
genre=thriller, new book has been fetched sucessfully, page scope: 15/50
genre=sport, new book has been fetched sucessfully, page scope: 27/50
genre=travel, new book has been fetched sucessfully, page scope: 24/50
genre=psychology, new book has been fetched sucessfully, page scope: 1/50
genre=sport, new book has been fetched sucessfully, page scope: 28/50
genre=thriller, new book has been fetched sucessfully, page scope: 16/50
genre=travel, new book has been fetched sucessfully, page scope: 25/50
genre=psychology, new book has been fetched sucessfully, page scope: 2/50
genre=sport, new book has been fetched sucessfully, page scope: 29/50
genre=thriller, new book has been fetched sucessfully, page scope: 17/50
genre=psychology, new book has been fetched sucessfully, page scope: 3/50
genre=travel, new book has been fetched sucessfully, page scope: 26/50
genre=sport, new book has been fetched sucessfully, page scope: 30/50
genre=thriller, new book has been fetched sucessfully, page scope: 18/50
genre=psychology, new book has been fetched sucessfully, page scope: 4/50
genre=travel, new book has been fetched sucessfully, page scope: 27/50
genre=sport, new book has been fetched sucessfully, page scope: 31/50
genre=thriller, new book has been fetched sucessfully, page scope: 19/50
genre=psychology, new book has been fetched sucessfully, page scope: 5/50
genre=travel, new book has been fetched sucessfully, page scope: 28/50
genre=sport, new book has been fetched sucessfully, page scope: 32/50
genre=thriller, new book has been fetched sucessfully, page scope: 20/50
genre=psychology, new book has been fetched sucessfully, page scope: 6/50
genre=travel, new book has been fetched sucessfully, page scope: 29/50
genre=sport, new book has been fetched sucessfully, page scope: 33/50
genre=thriller, new book has been fetched sucessfully, page scope: 21/50
genre=adult, new book has been fetched sucessfully, page scope: 50/50
fetching genre=adult, page=24
genre=psychology, new book has been fetched sucessfully, page scope: 7/50
genre=sport, new book has been fetched sucessfully, page scope: 34/50
genre=travel, new book has been fetched sucessfully, page scope: 30/50
genre=thriller, new book has been fetched sucessfully, page scope: 22/50
genre=sport, new book has been fetched sucessfully, page scope: 35/50
genre=adult, new book has been fetched sucessfully, page scope: 1/50
genre=thriller, new book has been fetched sucessfully, page scope: 23/50
genre=travel, new book has been fetched sucessfully, page scope: 31/50
genre=sport, new book has been fetched sucessfully, page scope: 36/50
genre=adult, new book has been fetched sucessfully, page scope: 2/50
genre=thriller, new book has been fetched sucessfully, page scope: 24/50
genre=travel, new book has been fetched sucessfully, page scope: 32/50
genre=sport, new book has been fetched sucessfully, page scope: 37/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=adult, new book has been fetched sucessfully, page scope: 3/50
genre=thriller, new book has been fetched sucessfully, page scope: 25/50
genre=travel, new book has been fetched sucessfully, page scope: 33/50
genre=travel, new book has been fetched sucessfully, page scope: 34/50
genre=adult, new book has been fetched sucessfully, page scope: 4/50
genre=thriller, new book has been fetched sucessfully, page scope: 26/50
genre=sport, new book has been fetched sucessfully, page scope: 38/50
genre=travel, new book has been fetched sucessfully, page scope: 35/50
genre=adult, new book has been fetched sucessfully, page scope: 5/50
genre=thriller, new book has been fetched sucessfully, page scope: 27/50
genre=sport, new book has been fetched sucessfully, page scope: 39/50
genre=travel, new book has been fetched sucessfully, page scope: 36/50
genre=adult, new book has been fetched sucessfully, page scope: 6/50
genre=thriller, new book has been fetched sucessfully, page scope: 28/50
genre=sport, new book has been fetched sucessfully, page scope: 40/50
genre=travel, new book has been fetched sucessfully, page scope: 37/50
genre=sport, new book has been fetched sucessfully, page scope: 41/50
genre=adult, new book has been fetched sucessfully, page scope: 7/50
genre=thriller, new book has been fetched sucessfully, page scope: 29/50
genre=travel, new book has been fetched sucessfully, page scope: 38/50
genre=psychology, new book has been fetched sucessfully, page scope: 8/50
genre=sport, new book has been fetched sucessfully, page scope: 42/50
genre=adult, new book has been fetched sucessfully, page scope: 8/50
genre=thriller, new book has been fetched sucessfully, page scope: 30/50
genre=travel, new book has been fetched sucessfully, page scope: 39/50
genre=psychology, new book has been fetched sucessfully, page scope: 9/50
genre=sport, new book has been fetched sucessfully, page scope: 43/50
genre=adult, new book has been fetched sucessfully, page scope: 9/50genre=thriller, new book has been fetched sucessfully, page scope: 31/50

genre=travel, new book has been fetched sucessfully, page scope: 40/50
genre=psychology, new book has been fetched sucessfully, page scope: 10/50
genre=sport, new book has been fetched sucessfully, page scope: 44/50
genre=adult, new book has been fetched sucessfully, page scope: 10/50
genre=psychology, new book has been fetched sucessfully, page scope: 11/50
genre=thriller, new book has been fetched sucessfully, page scope: 32/50
genre=sport, new book has been fetched sucessfully, page scope: 45/50
genre=psychology, new book has been fetched sucessfully, page scope: 12/50
genre=travel, new book has been fetched sucessfully, page scope: 41/50
genre=adult, new book has been fetched sucessfully, page scope: 11/50
genre=thriller, new book has been fetched sucessfully, page scope: 33/50
genre=sport, new book has been fetched sucessfully, page scope: 46/50
genre=travel, new book has been fetched sucessfully, page scope: 42/50
genre=psychology, new book has been fetched sucessfully, page scope: 13/50
genre=thriller, new book has been fetched sucessfully, page scope: 34/50
genre=adult, new book has been fetched sucessfully, page scope: 12/50
genre=sport, new book has been fetched sucessfully, page scope: 47/50
genre=psychology, new book has been fetched sucessfully, page scope: 14/50
genre=adult, new book has been fetched sucessfully, page scope: 13/50
genre=travel, new book has been fetched sucessfully, page scope: 43/50
genre=thriller, new book has been fetched sucessfully, page scope: 35/50
genre=sport, new book has been fetched sucessfully, page scope: 48/50
genre=psychology, new book has been fetched sucessfully, page scope: 15/50
genre=travel, new book has been fetched sucessfully, page scope: 44/50
genre=adult, new book has been fetched sucessfully, page scope: 14/50
genre=thriller, new book has been fetched sucessfully, page scope: 36/50
genre=sport, new book has been fetched sucessfully, page scope: 49/50
genre=psychology, new book has been fetched sucessfully, page scope: 16/50
genre=adult, new book has been fetched sucessfully, page scope: 15/50
genre=travel, new book has been fetched sucessfully, page scope: 45/50
genre=thriller, new book has been fetched sucessfully, page scope: 37/50
genre=sport, new book has been fetched sucessfully, page scope: 50/50
fetching genre=sport, page=25
genre=psychology, new book has been fetched sucessfully, page scope: 17/50
genre=adult, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 38/50
genre=travel, new book has been fetched sucessfully, page scope: 46/50
genre=sport, new book has been fetched sucessfully, page scope: 1/50
genre=psychology, new book has been fetched sucessfully, page scope: 18/50
genre=adult, new book has been fetched sucessfully, page scope: 17/50
genre=travel, new book has been fetched sucessfully, page scope: 47/50
genre=thriller, new book has been fetched sucessfully, page scope: 39/50
genre=sport, new book has been fetched sucessfully, page scope: 2/50
genre=psychology, new book has been fetched sucessfully, page scope: 19/50
genre=travel, new book has been fetched sucessfully, page scope: 48/50
genre=adult, new book has been fetched sucessfully, page scope: 18/50
genre=sport, new book has been fetched sucessfully, page scope: 3/50
genre=thriller, new book has been fetched sucessfully, page scope: 40/50
genre=psychology, new book has been fetched sucessfully, page scope: 20/50
genre=travel, new book has been fetched sucessfully, page scope: 49/50
genre=adult, new book has been fetched sucessfully, page scope: 19/50
genre=thriller, new book has been fetched sucessfully, page scope: 41/50
genre=sport, new book has been fetched sucessfully, page scope: 4/50
genre=psychology, new book has been fetched sucessfully, page scope: 21/50
genre=travel, new book has been fetched sucessfully, page scope: 50/50
fetching genre=travel, page=25
genre=sport, new book has been fetched sucessfully, page scope: 5/50
genre=psychology, new book has been fetched sucessfully, page scope: 22/50
genre=thriller, new book has been fetched sucessfully, page scope: 42/50
genre=adult, new book has been fetched sucessfully, page scope: 20/50
genre=sport, new book has been fetched sucessfully, page scope: 6/50
genre=psychology, new book has been fetched sucessfully, page scope: 23/50
genre=travel, new book has been fetched sucessfully, page scope: 1/50
genre=thriller, new book has been fetched sucessfully, page scope: 43/50
genre=adult, new book has been fetched sucessfully, page scope: 21/50
genre=sport, new book has been fetched sucessfully, page scope: 7/50
genre=psychology, new book has been fetched sucessfully, page scope: 24/50
genre=travel, new book has been fetched sucessfully, page scope: 2/50
genre=thriller, new book has been fetched sucessfully, page scope: 44/50
genre=adult, new book has been fetched sucessfully, page scope: 22/50
genre=sport, new book has been fetched sucessfully, page scope: 8/50
genre=travel, new book has been fetched sucessfully, page scope: 3/50
genre=psychology, new book has been fetched sucessfully, page scope: 25/50
genre=thriller, new book has been fetched sucessfully, page scope: 45/50
genre=adult, new book has been fetched sucessfully, page scope: 23/50
genre=sport, new book has been fetched sucessfully, page scope: 9/50
genre=travel, new book has been fetched sucessfully, page scope: 4/50
genre=psychology, new book has been fetched sucessfully, page scope: 26/50
genre=thriller, new book has been fetched sucessfully, page scope: 46/50
genre=adult, new book has been fetched sucessfully, page scope: 24/50
genre=sport, new book has been fetched sucessfully, page scope: 10/50
genre=travel, new book has been fetched sucessfully, page scope: 5/50
genre=psychology, new book has been fetched sucessfully, page scope: 27/50
genre=thriller, new book has been fetched sucessfully, page scope: 47/50
genre=sport, new book has been fetched sucessfully, page scope: 11/50
genre=adult, new book has been fetched sucessfully, page scope: 25/50
genre=psychology, new book has been fetched sucessfully, page scope: 28/50
genre=travel, new book has been fetched sucessfully, page scope: 6/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=sport, new book has been fetched sucessfully, page scope: 12/50
genre=thriller, new book has been fetched sucessfully, page scope: 48/50
genre=adult, new book has been fetched sucessfully, page scope: 26/50
genre=travel, new book has been fetched sucessfully, page scope: 7/50
genre=psychology, new book has been fetched sucessfully, page scope: 29/50
genre=sport, new book has been fetched sucessfully, page scope: 13/50
genre=thriller, new book has been fetched sucessfully, page scope: 49/50
genre=travel, new book has been fetched sucessfully, page scope: 8/50
genre=psychology, new book has been fetched sucessfully, page scope: 30/50
genre=adult, new book has been fetched sucessfully, page scope: 27/50
genre=sport, new book has been fetched sucessfully, page scope: 14/50
genre=thriller, new book has been fetched sucessfully, page scope: 50/50
fetching genre=thriller, page=25
genre=psychology, new book has been fetched sucessfully, page scope: 31/50
genre=travel, new book has been fetched sucessfully, page scope: 9/50
genre=adult, new book has been fetched sucessfully, page scope: 28/50
genre=sport, new book has been fetched sucessfully, page scope: 15/50
genre=psychology, new book has been fetched sucessfully, page scope: 32/50
genre=travel, new book has been fetched sucessfully, page scope: 10/50
genre=thriller, new book has been fetched sucessfully, page scope: 1/50
genre=adult, new book has been fetched sucessfully, page scope: 29/50
genre=sport, new book has been fetched sucessfully, page scope: 16/50
genre=psychology, new book has been fetched sucessfully, page scope: 33/50
genre=travel, new book has been fetched sucessfully, page scope: 11/50
genre=thriller, new book has been fetched sucessfully, page scope: 2/50
genre=psychology, new book has been fetched sucessfully, page scope: 34/50
genre=sport, new book has been fetched sucessfully, page scope: 17/50
genre=travel, new book has been fetched sucessfully, page scope: 12/50
genre=adult, new book has been fetched sucessfully, page scope: 30/50
genre=thriller, new book has been fetched sucessfully, page scope: 3/50
genre=sport, new book has been fetched sucessfully, page scope: 18/50
genre=psychology, new book has been fetched sucessfully, page scope: 35/50
genre=travel, new book has been fetched sucessfully, page scope: 13/50
genre=adult, new book has been fetched sucessfully, page scope: 31/50
genre=thriller, new book has been fetched sucessfully, page scope: 4/50
genre=sport, new book has been fetched sucessfully, page scope: 19/50
genre=travel, new book has been fetched sucessfully, page scope: 14/50
genre=adult, new book has been fetched sucessfully, page scope: 32/50
genre=psychology, new book has been fetched sucessfully, page scope: 36/50
genre=thriller, new book has been fetched sucessfully, page scope: 5/50
genre=sport, new book has been fetched sucessfully, page scope: 20/50
genre=travel, new book has been fetched sucessfully, page scope: 15/50
genre=adult, new book has been fetched sucessfully, page scope: 33/50
genre=psychology, new book has been fetched sucessfully, page scope: 37/50
genre=travel, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 6/50
genre=sport, new book has been fetched sucessfully, page scope: 21/50
genre=psychology, new book has been fetched sucessfully, page scope: 38/50
genre=adult, new book has been fetched sucessfully, page scope: 34/50
genre=travel, new book has been fetched sucessfully, page scope: 17/50
genre=sport, new book has been fetched sucessfully, page scope: 22/50
genre=psychology, new book has been fetched sucessfully, page scope: 39/50
genre=thriller, new book has been fetched sucessfully, page scope: 7/50
genre=travel, new book has been fetched sucessfully, page scope: 18/50
genre=adult, new book has been fetched sucessfully, page scope: 35/50
genre=psychology, new book has been fetched sucessfully, page scope: 40/50
genre=sport, new book has been fetched sucessfully, page scope: 23/50
genre=travel, new book has been fetched sucessfully, page scope: 19/50
genre=thriller, new book has been fetched sucessfully, page scope: 8/50
genre=adult, new book has been fetched sucessfully, page scope: 36/50
genre=psychology, new book has been fetched sucessfully, page scope: 41/50
genre=sport, new book has been fetched sucessfully, page scope: 24/50
genre=travel, new book has been fetched sucessfully, page scope: 20/50
genre=thriller, new book has been fetched sucessfully, page scope: 9/50
genre=adult, new book has been fetched sucessfully, page scope: 37/50
genre=psychology, new book has been fetched sucessfully, page scope: 42/50
genre=sport, new book has been fetched sucessfully, page scope: 25/50
genre=travel, new book has been fetched sucessfully, page scope: 21/50
genre=psychology, new book has been fetched sucessfully, page scope: 43/50
genre=thriller, new book has been fetched sucessfully, page scope: 10/50
genre=adult, new book has been fetched sucessfully, page scope: 38/50
genre=travel, new book has been fetched sucessfully, page scope: 22/50genre=sport, new book has been fetched sucessfully, page scope: 26/50

genre=psychology, new book has been fetched sucessfully, page scope: 44/50
genre=adult, new book has been fetched sucessfully, page scope: 39/50
genre=thriller, new book has been fetched sucessfully, page scope: 11/50
genre=travel, new book has been fetched sucessfully, page scope: 23/50
genre=sport, new book has been fetched sucessfully, page scope: 27/50
genre=psychology, new book has been fetched sucessfully, page scope: 45/50
genre=travel, new book has been fetched sucessfully, page scope: 24/50
genre=thriller, new book has been fetched sucessfully, page scope: 12/50
genre=adult, new book has been fetched sucessfully, page scope: 40/50
genre=sport, new book has been fetched sucessfully, page scope: 28/50
genre=psychology, new book has been fetched sucessfully, page scope: 46/50
genre=travel, new book has been fetched sucessfully, page scope: 25/50
genre=adult, new book has been fetched sucessfully, page scope: 41/50genre=thriller, new book has been fetched sucessfully, page scope: 13/50

genre=psychology, new book has been fetched sucessfully, page scope: 47/50
genre=sport, new book has been fetched sucessfully, page scope: 29/50
genre=travel, new book has been fetched sucessfully, page scope: 26/50
genre=thriller, new book has been fetched sucessfully, page scope: 14/50
genre=adult, new book has been fetched sucessfully, page scope: 42/50
genre=psychology, new book has been fetched sucessfully, page scope: 48/50
genre=sport, new book has been fetched sucessfully, page scope: 30/50
genre=travel, new book has been fetched sucessfully, page scope: 27/50
genre=thriller, new book has been fetched sucessfully, page scope: 15/50
genre=psychology, new book has been fetched sucessfully, page scope: 49/50
genre=adult, new book has been fetched sucessfully, page scope: 43/50
genre=sport, new book has been fetched sucessfully, page scope: 31/50
genre=travel, new book has been fetched sucessfully, page scope: 28/50
genre=psychology, new book has been fetched sucessfully, page scope: 50/50
fetching genre=psychology, page=26
genre=thriller, new book has been fetched sucessfully, page scope: 16/50
work on genre: psychology has been finished
genre=adult, new book has been fetched sucessfully, page scope: 44/50
genre=sport, new book has been fetched sucessfully, page scope: 32/50
genre=travel, new book has been fetched sucessfully, page scope: 29/50
genre=thriller, new book has been fetched sucessfully, page scope: 17/50
genre=adult, new book has been fetched sucessfully, page scope: 45/50
genre=travel, new book has been fetched sucessfully, page scope: 30/50
genre=sport, new book has been fetched sucessfully, page scope: 33/50
genre=thriller, new book has been fetched sucessfully, page scope: 18/50
genre=adult, new book has been fetched sucessfully, page scope: 46/50
genre=travel, new book has been fetched sucessfully, page scope: 31/50
genre=sport, new book has been fetched sucessfully, page scope: 34/50
genre=thriller, new book has been fetched sucessfully, page scope: 19/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=adult, new book has been fetched sucessfully, page scope: 47/50
genre=sport, new book has been fetched sucessfully, page scope: 35/50
genre=travel, new book has been fetched sucessfully, page scope: 32/50
genre=thriller, new book has been fetched sucessfully, page scope: 20/50
genre=adult, new book has been fetched sucessfully, page scope: 48/50
genre=travel, new book has been fetched sucessfully, page scope: 33/50
genre=sport, new book has been fetched sucessfully, page scope: 36/50
genre=thriller, new book has been fetched sucessfully, page scope: 21/50
genre=sport, new book has been fetched sucessfully, page scope: 37/50
genre=travel, new book has been fetched sucessfully, page scope: 34/50
genre=adult, new book has been fetched sucessfully, page scope: 49/50
genre=thriller, new book has been fetched sucessfully, page scope: 22/50
genre=sport, new book has been fetched sucessfully, page scope: 38/50
genre=travel, new book has been fetched sucessfully, page scope: 35/50
genre=adult, new book has been fetched sucessfully, page scope: 50/50
fetching genre=adult, page=25
genre=thriller, new book has been fetched sucessfully, page scope: 23/50
genre=sport, new book has been fetched sucessfully, page scope: 39/50
genre=travel, new book has been fetched sucessfully, page scope: 36/50
genre=travel, new book has been fetched sucessfully, page scope: 37/50
genre=sport, new book has been fetched sucessfully, page scope: 40/50
genre=adult, new book has been fetched sucessfully, page scope: 1/50
genre=thriller, new book has been fetched sucessfully, page scope: 24/50
genre=travel, new book has been fetched sucessfully, page scope: 38/50
genre=sport, new book has been fetched sucessfully, page scope: 41/50
genre=thriller, new book has been fetched sucessfully, page scope: 25/50
genre=adult, new book has been fetched sucessfully, page scope: 2/50genre=travel, new book has been fetched sucessfully, page scope: 39/50

genre=sport, new book has been fetched sucessfully, page scope: 42/50
genre=thriller, new book has been fetched sucessfully, page scope: 26/50
genre=travel, new book has been fetched sucessfully, page scope: 40/50
genre=adult, new book has been fetched sucessfully, page scope: 3/50
genre=sport, new book has been fetched sucessfully, page scope: 43/50
genre=travel, new book has been fetched sucessfully, page scope: 41/50
genre=thriller, new book has been fetched sucessfully, page scope: 27/50
genre=adult, new book has been fetched sucessfully, page scope: 4/50
genre=sport, new book has been fetched sucessfully, page scope: 44/50
genre=travel, new book has been fetched sucessfully, page scope: 42/50
genre=thriller, new book has been fetched sucessfully, page scope: 28/50
genre=adult, new book has been fetched sucessfully, page scope: 5/50
genre=sport, new book has been fetched sucessfully, page scope: 45/50
genre=travel, new book has been fetched sucessfully, page scope: 43/50
genre=thriller, new book has been fetched sucessfully, page scope: 29/50
genre=adult, new book has been fetched sucessfully, page scope: 6/50
genre=sport, new book has been fetched sucessfully, page scope: 46/50
genre=travel, new book has been fetched sucessfully, page scope: 44/50
genre=thriller, new book has been fetched sucessfully, page scope: 30/50
genre=adult, new book has been fetched sucessfully, page scope: 7/50
genre=travel, new book has been fetched sucessfully, page scope: 45/50
genre=sport, new book has been fetched sucessfully, page scope: 47/50genre=thriller, new book has been fetched sucessfully, page scope: 31/50

genre=travel, new book has been fetched sucessfully, page scope: 46/50
genre=adult, new book has been fetched sucessfully, page scope: 8/50
genre=sport, new book has been fetched sucessfully, page scope: 48/50
genre=thriller, new book has been fetched sucessfully, page scope: 32/50
genre=travel, new book has been fetched sucessfully, page scope: 47/50
genre=adult, new book has been fetched sucessfully, page scope: 9/50
genre=sport, new book has been fetched sucessfully, page scope: 49/50
genre=thriller, new book has been fetched sucessfully, page scope: 33/50
genre=travel, new book has been fetched sucessfully, page scope: 48/50
genre=adult, new book has been fetched sucessfully, page scope: 10/50
genre=sport, new book has been fetched sucessfully, page scope: 50/50
fetching genre=sport, page=26
work on genre: sport has been finished
genre=travel, new book has been fetched sucessfully, page scope: 49/50
genre=thriller, new book has been fetched sucessfully, page scope: 34/50
genre=adult, new book has been fetched sucessfully, page scope: 11/50
genre=travel, new book has been fetched sucessfully, page scope: 50/50
fetching genre=travel, page=26
work on genre: travel has been finished
genre=adult, new book has been fetched sucessfully, page scope: 12/50
genre=thriller, new book has been fetched sucessfully, page scope: 35/50
genre=thriller, new book has been fetched sucessfully, page scope: 36/50
genre=adult, new book has been fetched sucessfully, page scope: 13/50
genre=thriller, new book has been fetched sucessfully, page scope: 37/50
genre=adult, new book has been fetched sucessfully, page scope: 14/50
genre=thriller, new book has been fetched sucessfully, page scope: 38/50
genre=adult, new book has been fetched sucessfully, page scope: 15/50
genre=thriller, new book has been fetched sucessfully, page scope: 39/50
genre=adult, new book has been fetched sucessfully, page scope: 16/50
genre=thriller, new book has been fetched sucessfully, page scope: 40/50
genre=adult, new book has been fetched sucessfully, page scope: 17/50
genre=thriller, new book has been fetched sucessfully, page scope: 41/50
genre=thriller, new book has been fetched sucessfully, page scope: 42/50
genre=adult, new book has been fetched sucessfully, page scope: 18/50
genre=thriller, new book has been fetched sucessfully, page scope: 43/50
genre=adult, new book has been fetched sucessfully, page scope: 19/50
genre=thriller, new book has been fetched sucessfully, page scope: 44/50
genre=adult, new book has been fetched sucessfully, page scope: 20/50
genre=thriller, new book has been fetched sucessfully, page scope: 45/50
genre=adult, new book has been fetched sucessfully, page scope: 21/50
genre=thriller, new book has been fetched sucessfully, page scope: 46/50
genre=adult, new book has been fetched sucessfully, page scope: 22/50
genre=thriller, new book has been fetched sucessfully, page scope: 47/50
genre=adult, new book has been fetched sucessfully, page scope: 23/50
genre=thriller, new book has been fetched sucessfully, page scope: 48/50
genre=adult, new book has been fetched sucessfully, page scope: 24/50
genre=thriller, new book has been fetched sucessfully, page scope: 49/50
genre=adult, new book has been fetched sucessfully, page scope: 25/50
genre=adult, new book has been fetched sucessfully, page scope: 26/50
genre=thriller, new book has been fetched sucessfully, page scope: 50/50
fetching genre=thriller, page=26
work on genre: thriller has been finished
genre=adult, new book has been fetched sucessfully, page scope: 27/50
genre=adult, new book has been fetched sucessfully, page scope: 28/50
genre=adult, new book has been fetched sucessfully, page scope: 29/50
genre=adult, new book has been fetched sucessfully, page scope: 30/50
genre=adult, new book has been fetched sucessfully, page scope: 31/50
genre=adult, new book has been fetched sucessfully, page scope: 32/50
genre=adult, new book has been fetched sucessfully, page scope: 33/50
genre=adult, new book has been fetched sucessfully, page scope: 34/50
genre=adult, new book has been fetched sucessfully, page scope: 35/50
genre=adult, new book has been fetched sucessfully, page scope: 36/50
genre=adult, new book has been fetched sucessfully, page scope: 37/50
genre=adult, new book has been fetched sucessfully, page scope: 38/50
genre=adult, new book has been fetched sucessfully, page scope: 39/50
genre=adult, new book has been fetched sucessfully, page scope: 40/50
genre=adult, new book has been fetched sucessfully, page scope: 41/50
genre=adult, new book has been fetched sucessfully, page scope: 42/50
genre=adult, new book has been fetched sucessfully, page scope: 43/50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>genre=adult, new book has been fetched sucessfully, page scope: 44/50
genre=adult, new book has been fetched sucessfully, page scope: 45/50
genre=adult, new book has been fetched sucessfully, page scope: 46/50
genre=adult, new book has been fetched sucessfully, page scope: 47/50
genre=adult, new book has been fetched sucessfully, page scope: 48/50
genre=adult, new book has been fetched sucessfully, page scope: 49/50
genre=adult, new book has been fetched sucessfully, page scope: 50/50
fetching genre=adult, page=26
work on genre: adult has been finished
end genre bucket: [&#39;psychology&#39;, &#39;travel&#39;, &#39;thriller&#39;, &#39;adult&#39;, &#39;sport&#39;]
done all target genres exploration
</pre></div>
</div>
</div>
</div>
<p><a id='concating_data'></a></p>
<h3>Now, let's concat all those genres dataframes into one single books dataframe</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_by_genre_dfs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">target_genres_to_explore</span><span class="p">:</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">genre</span><span class="si">}</span><span class="s2">_books&quot;</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;./books_by_genres/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">genre_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">books_by_genre_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">genre_df</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">books_by_genre_dfs</span><span class="p">)</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s2">&quot;./books.parquet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a id='data_scraped'></a></p>
<h3>Let's check how much data did we scrape before we start cleaning it (if needed)</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;./books.parquet&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;df shape:</span><span class="si">{</span><span class="n">books_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;data amount before cleaning: </span><span class="si">{</span><span class="s1">&#39;</span><span class="si">{:,}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">books_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">books_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2"> (rows * cols)&quot;</span><span class="p">)</span>
<span class="n">books_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df shape:(17787, 21)
data amount before cleaning: 373,527 (rows * cols)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>original_title</th>
      <th>rating</th>
      <th>ratings_count</th>
      <th>reviews_count</th>
      <th>book_format</th>
      <th>pages_count</th>
      <th>main_language</th>
      <th>editions_count</th>
      <th>has_awards</th>
      <th>...</th>
      <th>top_tagged_genre_2</th>
      <th>top_tagged_genre_3</th>
      <th>to_read_count</th>
      <th>currently_reading_count</th>
      <th>author_name</th>
      <th>author_followers_count</th>
      <th>author_books_count</th>
      <th>author_avg_rating</th>
      <th>author_ratings_count</th>
      <th>author_reviews_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Harry Potter and the Sorcerer's Stone</td>
      <td>Harry Potter and the Philosopher's Stone</td>
      <td>4.48</td>
      <td>8441371</td>
      <td>133336</td>
      <td>Hardcover</td>
      <td>309.0</td>
      <td>English</td>
      <td>943</td>
      <td>True</td>
      <td>...</td>
      <td>Fiction</td>
      <td>Young Adult</td>
      <td>1283076</td>
      <td>188035</td>
      <td>J.K. Rowling</td>
      <td>218277</td>
      <td>221</td>
      <td>4.46</td>
      <td>30437859</td>
      <td>680605</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Harry Potter and the Chamber of Secrets</td>
      <td>Harry Potter and the Chamber of Secrets</td>
      <td>4.43</td>
      <td>3257357</td>
      <td>64091</td>
      <td>Hardcover</td>
      <td>341.0</td>
      <td>English</td>
      <td>747</td>
      <td>True</td>
      <td>...</td>
      <td>Fiction</td>
      <td>Young Adult</td>
      <td>348492</td>
      <td>80951</td>
      <td>J.K. Rowling</td>
      <td>218277</td>
      <td>221</td>
      <td>4.46</td>
      <td>30437859</td>
      <td>680605</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Harry Potter and the Prisoner of Azkaban</td>
      <td>Harry Potter and the Prisoner of Azkaban</td>
      <td>4.58</td>
      <td>3415829</td>
      <td>67390</td>
      <td>Mass Market Paperback</td>
      <td>435.0</td>
      <td>English</td>
      <td>658</td>
      <td>True</td>
      <td>...</td>
      <td>Young Adult</td>
      <td>Fiction</td>
      <td>366354</td>
      <td>58830</td>
      <td>J.K. Rowling</td>
      <td>218277</td>
      <td>221</td>
      <td>4.46</td>
      <td>30437859</td>
      <td>680605</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Hobbit, or There and Back Again</td>
      <td>The Hobbit, or There and Back Again</td>
      <td>4.28</td>
      <td>3344315</td>
      <td>56741</td>
      <td>Paperback</td>
      <td>366.0</td>
      <td>English</td>
      <td>50</td>
      <td>True</td>
      <td>...</td>
      <td>Classics</td>
      <td>Fiction</td>
      <td>890447</td>
      <td>74818</td>
      <td>J.R.R. Tolkien</td>
      <td>63711</td>
      <td>396</td>
      <td>4.35</td>
      <td>9626760</td>
      <td>160876</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Harry Potter and the Goblet of Fire</td>
      <td>Harry Potter and the Goblet of Fire</td>
      <td>4.57</td>
      <td>3041195</td>
      <td>55963</td>
      <td>Paperback</td>
      <td>734.0</td>
      <td>English</td>
      <td>608</td>
      <td>True</td>
      <td>...</td>
      <td>Young Adult</td>
      <td>Fiction</td>
      <td>360512</td>
      <td>71532</td>
      <td>J.K. Rowling</td>
      <td>218277</td>
      <td>221</td>
      <td>4.46</td>
      <td>30437859</td>
      <td>680605</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Harry Potter and the Order of the Phoenix</td>
      <td>Harry Potter and the Order of the Phoenix</td>
      <td>4.50</td>
      <td>2912381</td>
      <td>51209</td>
      <td>Paperback</td>
      <td>870.0</td>
      <td>English</td>
      <td>140</td>
      <td>True</td>
      <td>...</td>
      <td>Young Adult</td>
      <td>Fiction</td>
      <td>407926</td>
      <td>62657</td>
      <td>J.K. Rowling</td>
      <td>218277</td>
      <td>221</td>
      <td>4.46</td>
      <td>30437859</td>
      <td>680605</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Harry Potter and the Half-Blood Prince</td>
      <td>Harry Potter and the Half-Blood Prince</td>
      <td>4.57</td>
      <td>2820532</td>
      <td>47036</td>
      <td>Paperback</td>
      <td>652.0</td>
      <td>English</td>
      <td>483</td>
      <td>True</td>
      <td>...</td>
      <td>Young Adult</td>
      <td>Fiction</td>
      <td>416502</td>
      <td>38601</td>
      <td>J.K. Rowling</td>
      <td>218277</td>
      <td>221</td>
      <td>4.46</td>
      <td>30437859</td>
      <td>680605</td>
    </tr>
    <tr>
      <th>7</th>
      <td>A Game of Thrones</td>
      <td>A Game of Thrones</td>
      <td>4.44</td>
      <td>2221292</td>
      <td>57478</td>
      <td>Mass Market Paperback</td>
      <td>835.0</td>
      <td>English</td>
      <td>424</td>
      <td>True</td>
      <td>...</td>
      <td>Fiction</td>
      <td>Fantasy</td>
      <td>888837</td>
      <td>103295</td>
      <td>George R.R. Martin</td>
      <td>100888</td>
      <td>676</td>
      <td>4.37</td>
      <td>6196387</td>
      <td>211312</td>
    </tr>
    <tr>
      <th>8</th>
      <td>The Fellowship of the Ring</td>
      <td>The Lord of the Rings: The Fellowship of the Ring</td>
      <td>4.38</td>
      <td>2563013</td>
      <td>28979</td>
      <td>Mass Market Paperback</td>
      <td>527.0</td>
      <td>English</td>
      <td>729</td>
      <td>True</td>
      <td>...</td>
      <td>Classics</td>
      <td>Fiction</td>
      <td>662233</td>
      <td>58356</td>
      <td>J.R.R. Tolkien</td>
      <td>63711</td>
      <td>396</td>
      <td>4.35</td>
      <td>9626760</td>
      <td>160876</td>
    </tr>
    <tr>
      <th>9</th>
      <td>A Clash of Kings</td>
      <td>A Clash of Kings</td>
      <td>4.41</td>
      <td>848546</td>
      <td>25166</td>
      <td>Paperback</td>
      <td>969.0</td>
      <td>English</td>
      <td>302</td>
      <td>True</td>
      <td>...</td>
      <td>Fiction</td>
      <td>Fantasy</td>
      <td>219395</td>
      <td>38197</td>
      <td>George R.R. Martin</td>
      <td>100888</td>
      <td>676</td>
      <td>4.37</td>
      <td>6196397</td>
      <td>211312</td>
    </tr>
  </tbody>
</table>
<p>10 rows Ã 21 columns</p>
</div></div></div>
</div>
<h3>Great!</h3>
<p>
    We finally scraped the data we were looking for we are now ready for the next step.
</p><p><a id='data_cleaning'></a></p>
<h2>Data Cleaning</h2>
<p>
    After the scraping process we could easily tell that some data is duplicated.<br>
    First, Let's clean these duplicate books.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span> <span class="o">=</span> <span class="n">books_df</span><span class="p">[</span><span class="o">~</span><span class="n">books_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="n">books_no_dup</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 17228 entries, 0 to 999
Data columns (total 21 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   title                    17228 non-null  object 
 1   original_title           15346 non-null  object 
 2   rating                   17228 non-null  float64
 3   ratings_count            17228 non-null  int64  
 4   reviews_count            17228 non-null  int64  
 5   book_format              17168 non-null  object 
 6   pages_count              17127 non-null  float64
 7   main_language            16355 non-null  object 
 8   editions_count           17228 non-null  int64  
 9   has_awards               17228 non-null  bool   
 10  top_tagged_genre_1       17228 non-null  object 
 11  top_tagged_genre_2       17226 non-null  object 
 12  top_tagged_genre_3       17224 non-null  object 
 13  to_read_count            17228 non-null  int64  
 14  currently_reading_count  17228 non-null  int64  
 15  author_name              17228 non-null  object 
 16  author_followers_count   17228 non-null  int64  
 17  author_books_count       17228 non-null  int64  
 18  author_avg_rating        17228 non-null  float64
 19  author_ratings_count     17228 non-null  int64  
 20  author_reviews_count     17228 non-null  int64  
dtypes: bool(1), float64(3), int64(9), object(8)
memory usage: 2.8+ MB
</pre></div>
</div>
</div>
</div>
<p>
    As can be seen we got rid of 559 rows of duplicated books just by using a built in pandas function called <strong>duplicated</strong>.<br>
    For more information see documentation: 
    <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.duplicated.html">Here</a>
</p><p><a id='corrupted_data_cleaning'></a></p>
<h3>Clean Corrupted Data</h3>
<p>
    Now that we know duplicates are gone, let's take a look at our DataFrame and see what defects in the data do we have.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>ratings_count</th>
      <th>reviews_count</th>
      <th>pages_count</th>
      <th>editions_count</th>
      <th>to_read_count</th>
      <th>currently_reading_count</th>
      <th>author_followers_count</th>
      <th>author_books_count</th>
      <th>author_avg_rating</th>
      <th>author_ratings_count</th>
      <th>author_reviews_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>17228.000000</td>
      <td>1.722800e+04</td>
      <td>17228.000000</td>
      <td>17127.000000</td>
      <td>17228.000000</td>
      <td>1.722800e+04</td>
      <td>17228.000000</td>
      <td>17228.000000</td>
      <td>17228.000000</td>
      <td>17228.000000</td>
      <td>1.722800e+04</td>
      <td>17228.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.047600</td>
      <td>1.106271e+05</td>
      <td>5728.685338</td>
      <td>358.469960</td>
      <td>132.433016</td>
      <td>6.842973e+04</td>
      <td>4469.086197</td>
      <td>24300.382633</td>
      <td>596.166705</td>
      <td>4.048028</td>
      <td>9.416101e+05</td>
      <td>46307.252612</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.249037</td>
      <td>3.450998e+05</td>
      <td>12772.222938</td>
      <td>215.448426</td>
      <td>623.350665</td>
      <td>1.479739e+05</td>
      <td>10662.045246</td>
      <td>94132.881836</td>
      <td>8738.137547</td>
      <td>0.206713</td>
      <td>2.487531e+06</td>
      <td>104226.208437</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.420000</td>
      <td>5.700000e+01</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>3.070000</td>
      <td>8.300000e+01</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.890000</td>
      <td>4.509750e+03</td>
      <td>320.000000</td>
      <td>245.000000</td>
      <td>12.000000</td>
      <td>4.646500e+03</td>
      <td>277.000000</td>
      <td>397.000000</td>
      <td>17.000000</td>
      <td>3.930000</td>
      <td>2.523675e+04</td>
      <td>2052.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.060000</td>
      <td>1.777550e+04</td>
      <td>1230.000000</td>
      <td>326.000000</td>
      <td>30.000000</td>
      <td>1.538600e+04</td>
      <td>1053.000000</td>
      <td>2247.000000</td>
      <td>47.000000</td>
      <td>4.050000</td>
      <td>1.502305e+05</td>
      <td>10727.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.210000</td>
      <td>7.563200e+04</td>
      <td>5038.000000</td>
      <td>419.000000</td>
      <td>72.000000</td>
      <td>6.373075e+04</td>
      <td>3786.000000</td>
      <td>11229.000000</td>
      <td>143.000000</td>
      <td>4.180000</td>
      <td>6.690410e+05</td>
      <td>39963.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.850000</td>
      <td>8.441371e+06</td>
      <td>183745.000000</td>
      <td>14777.000000</td>
      <td>13140.000000</td>
      <td>1.907997e+06</td>
      <td>188035.000000</td>
      <td>790691.000000</td>
      <td>192863.000000</td>
      <td>4.730000</td>
      <td>3.044132e+07</td>
      <td>712349.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>
    As can be seen, author_books_count max: 192,863 is too high, let's check what's the cause.<br>
    Approaching to this issue done by looking who is exactly this author with a huge amount of books.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_author_books_count</span> <span class="o">=</span> <span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_books_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">books_no_dup</span><span class="p">[</span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_books_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_author_books_count</span><span class="p">]</span>\
<span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;author_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;author_name&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Anonymous&#39;
</pre></div>
</div>
</div>
</div>
<p>
    Result was <strong>Anonymous</strong>, Pretty suspicious but we still didn't want to remove books which have no known author before we know how much will it affect our statistics.<br>
    let's look at the data of the books marked with the Anonymous author.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span><span class="p">[</span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_books_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_books_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;author_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>title                      The Holy Bible: English Standard Version
original_title                                                 None
rating                                                         4.54
ratings_count                                                 42733
reviews_count                                                  1685
book_format                                          Kindle Edition
pages_count                                                  1243.0
main_language                                               English
editions_count                                                  873
has_awards                                                    False
top_tagged_genre_1                                        Christian
top_tagged_genre_2                                         Religion
top_tagged_genre_3                                       Nonfiction
to_read_count                                                 16590
currently_reading_count                                       39370
author_name                                               Anonymous
author_followers_count                                         2769
author_books_count                                           192863
author_avg_rating                                              4.15
author_ratings_count                                        1547108
author_reviews_count                                          89271
Name: 136, dtype: object
</pre></div>
</div>
</div>
</div>
<p>
    As can be seen, there are a lot of coloums with suspicious values which may harm our outlier detection,<br>
    i.e: the median for author_books_count actually should be very low in compared to that.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_books_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>47.0
</pre></div>
</div>
</div>
</div>
<p>
    We were curious to see how many books out of the 17,228 books we have right now actually marked as Anonymous author.<br>
    Let's count how many books we have which are marked as Anonymous author.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span><span class="p">[</span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Anonymous&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(33, 21)
</pre></div>
</div>
</div>
</div>
<p>
    Not many books, 33 books out of 17,728 are not 1% out of the amount of books we own.<br>
    Let's remove them.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span> <span class="o">=</span> <span class="n">books_no_dup</span><span class="p">[</span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Anonymous&quot;</span><span class="p">]</span>

<span class="n">books_no_dup</span><span class="p">[</span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Anonymous&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 21)
</pre></div>
</div>
</div>
</div>
<p>
    Good, No more Anonymous authors, Let's re-check our DataFrame info again.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span><span class="p">[</span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_books_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_books_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;author_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>title                        Beowulf
original_title               Beowulf
rating                          3.46
ratings_count                 270311
reviews_count                   7784
book_format                Paperback
pages_count                    245.0
main_language                English
editions_count                  1269
has_awards                     False
top_tagged_genre_1          Classics
top_tagged_genre_2            Poetry
top_tagged_genre_3           Fiction
to_read_count                 114328
currently_reading_count         4662
author_name                  Unknown
author_followers_count          1409
author_books_count            162128
author_avg_rating               3.57
author_ratings_count          489820
author_reviews_count           22348
Name: 91, dtype: object
</pre></div>
</div>
</div>
</div>
<p>
    Again we found out the top number of books count is too high and stands at: 162,128.<br>
    That led us to do the same flow we did with Anonymous author but this time with <strong>Unknown</strong>
    author.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span><span class="p">[</span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 21)
</pre></div>
</div>
</div>
</div>
<p>
    Even less than previous cycle, 4 books total.<br>
    Let's remove them.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span> <span class="o">=</span> <span class="n">books_no_dup</span><span class="p">[</span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">]</span>

<span class="n">books_no_dup</span><span class="p">[</span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 21)
</pre></div>
</div>
</div>
</div>
<p>
    Let's take a another look at the info of the books count.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span><span class="p">[</span><span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_books_count&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">books_no_dup</span><span class="p">[</span><span class="s1">&#39;author_books_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;author_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>title                                The Tempest
original_title                              None
rating                                       3.8
ratings_count                             189407
reviews_count                               5067
book_format                Mass Market Paperback
pages_count                                218.0
main_language                            English
editions_count                              3433
has_awards                                 False
top_tagged_genre_1                      Classics
top_tagged_genre_2                         Plays
top_tagged_genre_3                         Drama
to_read_count                                653
currently_reading_count                     2789
author_name                  William Shakespeare
author_followers_count                     39153
author_books_count                          7041
author_avg_rating                           3.87
author_ratings_count                     7025736
author_reviews_count                      141564
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<h3>Success</h3>
<p>
    We finally got to the point where the number of books related to the author is reasonable and moreover the author is one of the 
    most popular authors ever lived (William Shakespeare).<br>
    <strong>Note: We did notice the enormous amount of editions count for our new top books count author, but it is a legit outlier</strong><br>
    So up next we thought to ourselves, orinial title field might be somewhere where a lot of "defected" data can be there.<br>
    Let's take a look there.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_no_dup</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 17191 entries, 0 to 999
Data columns (total 21 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   title                    17191 non-null  object 
 1   original_title           15320 non-null  object 
 2   rating                   17191 non-null  float64
 3   ratings_count            17191 non-null  int64  
 4   reviews_count            17191 non-null  int64  
 5   book_format              17132 non-null  object 
 6   pages_count              17090 non-null  float64
 7   main_language            16319 non-null  object 
 8   editions_count           17191 non-null  int64  
 9   has_awards               17191 non-null  bool   
 10  top_tagged_genre_1       17191 non-null  object 
 11  top_tagged_genre_2       17189 non-null  object 
 12  top_tagged_genre_3       17187 non-null  object 
 13  to_read_count            17191 non-null  int64  
 14  currently_reading_count  17191 non-null  int64  
 15  author_name              17191 non-null  object 
 16  author_followers_count   17191 non-null  int64  
 17  author_books_count       17191 non-null  int64  
 18  author_avg_rating        17191 non-null  float64
 19  author_ratings_count     17191 non-null  int64  
 20  author_reviews_count     17191 non-null  int64  
dtypes: bool(1), float64(3), int64(9), object(8)
memory usage: 2.8+ MB
</pre></div>
</div>
</div>
</div>
<p><a id='replace_missing_og'></a></p>
<h3>Replace missing Original title</h3>
<p>
    The numbers were speaking for themselves, we had around 2k books without original title.<br>
    So, maybe we want to save the 2k books which just don't have original_title.
    <br>
    logically, as we know our data, books with null og_title are just books that their title never changed.<br>
    Instead of having this data in that way ,we can:
        <br>
    1. Fill og_title with current title if original title is missing.
        <br>
    2. Create new flag col is_title_changed, which may perform in our later ML model.
        <br>
    <strong>Let's do it!</strong><br>
    First we add the title to all missing original_title books.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_df_with_og_title</span> <span class="o">=</span> <span class="n">books_no_dup</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s2">&quot;original_title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s2">&quot;original_title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span>
    <span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">],</span>
    <span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s2">&quot;original_title&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">books_df_with_og_title</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 17191 entries, 0 to 999
Data columns (total 21 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   title                    17191 non-null  object 
 1   original_title           17191 non-null  object 
 2   rating                   17191 non-null  float64
 3   ratings_count            17191 non-null  int64  
 4   reviews_count            17191 non-null  int64  
 5   book_format              17132 non-null  object 
 6   pages_count              17090 non-null  float64
 7   main_language            16319 non-null  object 
 8   editions_count           17191 non-null  int64  
 9   has_awards               17191 non-null  bool   
 10  top_tagged_genre_1       17191 non-null  object 
 11  top_tagged_genre_2       17189 non-null  object 
 12  top_tagged_genre_3       17187 non-null  object 
 13  to_read_count            17191 non-null  int64  
 14  currently_reading_count  17191 non-null  int64  
 15  author_name              17191 non-null  object 
 16  author_followers_count   17191 non-null  int64  
 17  author_books_count       17191 non-null  int64  
 18  author_avg_rating        17191 non-null  float64
 19  author_ratings_count     17191 non-null  int64  
 20  author_reviews_count     17191 non-null  int64  
dtypes: bool(1), float64(3), int64(9), object(8)
memory usage: 2.8+ MB
</pre></div>
</div>
</div>
</div>
<p>
    Now let's add the new is_title_changed flag mentioned.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s2">&quot;is_title_changed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s2">&quot;original_title&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_df_with_og_title</span><span class="p">[</span><span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s2">&quot;is_title_changed&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4576, 22)
</pre></div>
</div>
</div>
</div>
<p>
    As can be seen, only 4,576 books out of the list has their title changed.<br>
    This time what really caught our eyes in the info was the number of NA <strong>main_language</strong>, which we could see was not slightly lower than the title amount.
</p><p><a id='none_values'></a></p>
<h3>The numbers were not adding up</h3>
<p>
    Because of the main_language NA number we faced we raised to ourselves the following question?<br>
    Just how much data we actually own that has no NA values.<br>
    Let's check how many total books are there without any NA values.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_df_with_og_title</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 16205 entries, 0 to 999
Data columns (total 22 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   title                    16205 non-null  object 
 1   original_title           16205 non-null  object 
 2   rating                   16205 non-null  float64
 3   ratings_count            16205 non-null  int64  
 4   reviews_count            16205 non-null  int64  
 5   book_format              16205 non-null  object 
 6   pages_count              16205 non-null  float64
 7   main_language            16205 non-null  object 
 8   editions_count           16205 non-null  int64  
 9   has_awards               16205 non-null  bool   
 10  top_tagged_genre_1       16205 non-null  object 
 11  top_tagged_genre_2       16205 non-null  object 
 12  top_tagged_genre_3       16205 non-null  object 
 13  to_read_count            16205 non-null  int64  
 14  currently_reading_count  16205 non-null  int64  
 15  author_name              16205 non-null  object 
 16  author_followers_count   16205 non-null  int64  
 17  author_books_count       16205 non-null  int64  
 18  author_avg_rating        16205 non-null  float64
 19  author_ratings_count     16205 non-null  int64  
 20  author_reviews_count     16205 non-null  int64  
 21  is_title_changed         16205 non-null  bool   
dtypes: bool(2), float64(3), int64(9), object(8)
memory usage: 2.6+ MB
</pre></div>
</div>
</div>
</div>
<p>
    Out of 17,191 books we had, only 16,205 books are NA "free".<br>
    <h3>Facing NA values strategy</h3>
    Logically we knew not all NA values must be removed, but we also knew we should get our DataFrame rows to be aligned.<br>
    We also knew our goal was to get somehwere around 16,205 books, since this was the number of the books without any NA values.<br>
    Our strategy was to divide and conqurer each NA data per coloumn.<br>
    We started up by cleaning the main language which we already knew had NA values.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">books_df</span><span class="p">[</span><span class="s1">&#39;main_language&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Indonesian&#39;,
 &#39;Danish&#39;,
 &#39;English&#39;,
 &#39;Norwegian&#39;,
 &#39;Dutch&#39;,
 &#39;Portuguese&#39;,
 &#39;Arabic&#39;,
 None,
 &#39;Polish&#39;,
 &#39;Italian&#39;,
 &#39;Latvian&#39;,
 &#39;Scots&#39;,
 &#39;French&#39;,
 &#39;Spanish&#39;,
 &#39;Icelandic&#39;,
 &#39;Swedish&#39;,
 &#39;Finnish&#39;,
 &#39;German&#39;,
 &#39;Multiple languages&#39;,
 &#39;Korean&#39;,
 &#39;Vietnamese&#39;,
 &#39;Japanese&#39;]
</pre></div>
</div>
</div>
</div>
<p>
    As can be seen, there are alot of different languages (21, None excluded) Which are widely used across the world, so we decide that because:
    <br>
    1. There are few missing Languages
    <br>
    2. Picking just the most frequent one to fill null values is un-relible
    <br>
    We have chosen to drop the rows with missing main language.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_df_with_og_title</span> <span class="o">=</span> <span class="n">books_df_with_og_title</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;main_language&#39;</span><span class="p">])</span>
<span class="n">books_df_with_og_title</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 16319 entries, 0 to 999
Data columns (total 22 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   title                    16319 non-null  object 
 1   original_title           16319 non-null  object 
 2   rating                   16319 non-null  float64
 3   ratings_count            16319 non-null  int64  
 4   reviews_count            16319 non-null  int64  
 5   book_format              16278 non-null  object 
 6   pages_count              16242 non-null  float64
 7   main_language            16319 non-null  object 
 8   editions_count           16319 non-null  int64  
 9   has_awards               16319 non-null  bool   
 10  top_tagged_genre_1       16319 non-null  object 
 11  top_tagged_genre_2       16318 non-null  object 
 12  top_tagged_genre_3       16316 non-null  object 
 13  to_read_count            16319 non-null  int64  
 14  currently_reading_count  16319 non-null  int64  
 15  author_name              16319 non-null  object 
 16  author_followers_count   16319 non-null  int64  
 17  author_books_count       16319 non-null  int64  
 18  author_avg_rating        16319 non-null  float64
 19  author_ratings_count     16319 non-null  int64  
 20  author_reviews_count     16319 non-null  int64  
 21  is_title_changed         16319 non-null  bool   
dtypes: bool(2), float64(3), int64(9), object(8)
memory usage: 2.6+ MB
</pre></div>
</div>
</div>
</div>
<p>
The next NA values we dropped were top_tagged_genre_2 and top_tagged_genre_3.<br>
As can be seen, there are just 4 books which are missing second and third tag (out of 16k).<br>
let's drop it.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_df_with_og_title</span> <span class="o">=</span> <span class="n">books_df_with_og_title</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;top_tagged_genre_2&#39;</span><span class="p">,</span> <span class="s1">&#39;top_tagged_genre_3&#39;</span><span class="p">])</span>
<span class="n">books_df_with_og_title</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 16316 entries, 0 to 999
Data columns (total 22 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   title                    16316 non-null  object 
 1   original_title           16316 non-null  object 
 2   rating                   16316 non-null  float64
 3   ratings_count            16316 non-null  int64  
 4   reviews_count            16316 non-null  int64  
 5   book_format              16275 non-null  object 
 6   pages_count              16240 non-null  float64
 7   main_language            16316 non-null  object 
 8   editions_count           16316 non-null  int64  
 9   has_awards               16316 non-null  bool   
 10  top_tagged_genre_1       16316 non-null  object 
 11  top_tagged_genre_2       16316 non-null  object 
 12  top_tagged_genre_3       16316 non-null  object 
 13  to_read_count            16316 non-null  int64  
 14  currently_reading_count  16316 non-null  int64  
 15  author_name              16316 non-null  object 
 16  author_followers_count   16316 non-null  int64  
 17  author_books_count       16316 non-null  int64  
 18  author_avg_rating        16316 non-null  float64
 19  author_ratings_count     16316 non-null  int64  
 20  author_reviews_count     16316 non-null  int64  
 21  is_title_changed         16316 non-null  bool   
dtypes: bool(2), float64(3), int64(9), object(8)
memory usage: 2.6+ MB
</pre></div>
</div>
</div>
</div>
<p>
    As we were thinking the book_format and the pages_count are important and we don't want to drop it,
    <br>
    We were also thinking that replacing the followings will still keep our data relible:<br>
    <ol>
        <li>median/mean for the pages_count - Very common statistical approach.</li>
        <li>top for book_format - Since it was string format we thought the commonest is a reliable option.</li>
    </ol>
</p><h3>Mean or Median?</h3>
<p>
    In order to decide in which metric to replace page_count (mean/median) we want to replace NA values we wanted to base our decision over the distribution of the metric.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="nb">print</span><span class="p">(</span><span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">books_df_with_og_title</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
14777.0
</pre></div>
</div>
<img alt="_images/books research_106_1.png" src="_images/books research_106_1.png" />
</div>
</div>
<p>
As can be seen, the distribution can show us that there are many outliers (i.e: some having 14k when the most has less than 1k)
So we are going to use median (mean might be too high).
And as can be seen, the pages_count has wrong dtype, float instead of int, let's fix it too.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_df_without_missing_values</span> <span class="o">=</span> <span class="n">books_df_with_og_title</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">pages_count_median</span> <span class="o">=</span> <span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span>
    <span class="n">pages_count_median</span><span class="p">,</span>
    <span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">books_df_without_missing_values</span> <span class="o">=</span> <span class="n">books_df_without_missing_values</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s2">&quot;pages_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median </span><span class="si">{</span><span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">books_df_without_missing_values</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>median 327.0
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 16316 entries, 0 to 999
Data columns (total 22 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   title                    16316 non-null  object 
 1   original_title           16316 non-null  object 
 2   rating                   16316 non-null  float64
 3   ratings_count            16316 non-null  int64  
 4   reviews_count            16316 non-null  int64  
 5   book_format              16275 non-null  object 
 6   pages_count              16316 non-null  int64  
 7   main_language            16316 non-null  object 
 8   editions_count           16316 non-null  int64  
 9   has_awards               16316 non-null  bool   
 10  top_tagged_genre_1       16316 non-null  object 
 11  top_tagged_genre_2       16316 non-null  object 
 12  top_tagged_genre_3       16316 non-null  object 
 13  to_read_count            16316 non-null  int64  
 14  currently_reading_count  16316 non-null  int64  
 15  author_name              16316 non-null  object 
 16  author_followers_count   16316 non-null  int64  
 17  author_books_count       16316 non-null  int64  
 18  author_avg_rating        16316 non-null  float64
 19  author_ratings_count     16316 non-null  int64  
 20  author_reviews_count     16316 non-null  int64  
 21  is_title_changed         16316 non-null  bool   
dtypes: bool(2), float64(2), int64(10), object(8)
memory usage: 2.6+ MB
</pre></div>
</div>
</div>
</div>
<p>
Let's fix null of book_format, using top value as mentioned before.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">most_freq_book_format</span> <span class="o">=</span> <span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;book_format&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;book_format&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;book_format&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">most_freq_book_format</span><span class="p">)</span>
<span class="n">books_df_without_missing_values</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 16316 entries, 0 to 999
Data columns (total 22 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   title                    16316 non-null  object 
 1   original_title           16316 non-null  object 
 2   rating                   16316 non-null  float64
 3   ratings_count            16316 non-null  int64  
 4   reviews_count            16316 non-null  int64  
 5   book_format              16316 non-null  object 
 6   pages_count              16316 non-null  int64  
 7   main_language            16316 non-null  object 
 8   editions_count           16316 non-null  int64  
 9   has_awards               16316 non-null  bool   
 10  top_tagged_genre_1       16316 non-null  object 
 11  top_tagged_genre_2       16316 non-null  object 
 12  top_tagged_genre_3       16316 non-null  object 
 13  to_read_count            16316 non-null  int64  
 14  currently_reading_count  16316 non-null  int64  
 15  author_name              16316 non-null  object 
 16  author_followers_count   16316 non-null  int64  
 17  author_books_count       16316 non-null  int64  
 18  author_avg_rating        16316 non-null  float64
 19  author_ratings_count     16316 non-null  int64  
 20  author_reviews_count     16316 non-null  int64  
 21  is_title_changed         16316 non-null  bool   
dtypes: bool(2), float64(2), int64(10), object(8)
memory usage: 2.6+ MB
</pre></div>
</div>
</div>
</div>
<h3>Great</h3>
<p>We don't have any missing values anymore</p>
<p>However, We didn't finsih our cleaing session yet, we still may have some outliers (we sure do as we have seen in the historam for pages_count) to be cleaned.</p><p><a id='outliers_detection_eda'></a></p>
<h1>Pre-outliers cleaning EDA</h1>
<p>
    At this point we knew we had to get rid of outliers, we thought it will be the best to check the outliers and show them by doing some EDA.<br>
    Also, EDA shows us the current state of the data.
</p><p><a id='genre_distribution'></a></p>
<h3>Genres distribution</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;top_tagged_genre_1&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Genres Histogram&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Genre&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="s1">&#39;anchor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_114_0.png" src="_images/books research_114_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_genre_counts</span> <span class="o">=</span> <span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;top_tagged_genre_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="n">total_books</span> <span class="o">=</span> <span class="n">books_df_without_missing_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Genre: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">books_genre_counts</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">fig1</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">books_genre_counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">, </span><span class="si">%1.1f%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">l</span><span class="p">,</span> <span class="p">(</span><span class="n">v</span> <span class="o">/</span> <span class="n">total_books</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">books_genre_counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">books_genre_counts</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span>
    <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">},</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">fig1</span><span class="o">.</span><span class="n">transFigure</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_115_0.png" src="_images/books research_115_0.png" />
</div>
</div>
<p><a id='mean_rating_by_genre'></a></p>
<p>
   As can be seen, most of the books are either Fantasy or Nonfiction books.<br>
</p>
<h3>Mean rating by genre</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_rating_mean_by_genre</span> <span class="o">=</span> <span class="n">books_df_without_missing_values</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;top_tagged_genre_1&#39;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">books_rating_mean_by_genre</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;rating&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Genre: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">books_genre_counts</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">fig1</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">books_rating_mean_by_genre</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">, average=</span><span class="si">%1.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">l</span><span class="p">,</span> <span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">books_rating_mean_by_genre</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">books_rating_mean_by_genre</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())],</span>
    <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">},</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">fig1</span><span class="o">.</span><span class="n">transFigure</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_117_0.png" src="_images/books research_117_0.png" />
</div>
</div>
<p><a id='language_distribution'></a></p>
<p>
    As can be seen, some of the genres have average rating higher than the others.<br>
    Maybe maybe it could help us later in building a model.
</p>
<h3>Language ditribution</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;main_language&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Language Histogram&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Language&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="s1">&#39;anchor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_119_0.png" src="_images/books research_119_0.png" />
</div>
</div>
<p><a id='edition_count_to_rating'></a></p>
<p>
    Not to our surprise, by far the most used language is English, maybe it's related to the fact it's the most widely used language in the world.
</p>
<h3>Edition count to rating</h3>
<p>
    The idea behind this graph was to check for possible correlation between the two.<br>
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">books_df_without_missing_values</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;editions_count&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;has_awards&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Editions Count to Rating&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Editions Count&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Book Rating&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_121_0.png" src="_images/books research_121_0.png" />
</div>
</div>
<p>
    let's take a closer look at the graph.
</p>   <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">books_df_without_missing_values</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;editions_count&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;has_awards&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Editions Count to Rating&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Editions Count&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Book Rating&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_123_0.png" src="_images/books research_123_0.png" />
</div>
</div>
<p><a id='rating_to_award'></a></p>
<p>
    As can be seen, most of the books which having awards are having less than 250 editions (which makes sense).
</p>
<h3>Rating to award</h3>
<p>
    Another EDA which we thought will help us building a prediction model later on.
</p>   <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binned_books_df</span> <span class="o">=</span> <span class="n">books_df_without_missing_values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">binned_books_df</span><span class="p">[</span><span class="s1">&#39;binned_rating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">binned_books_df</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">binned_books_df</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;binned_rating&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;has_awards&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="s1">&#39;anchor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;min rating: </span><span class="si">{</span><span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_125_0.png" src="_images/books research_125_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min rating: 2.42
</pre></div>
</div>
</div>
</div>
<p><a id='pages_count_to_books_count'></a></p>
<p>
    As can be seen, altough books has atleast 2.42 rating, below the rating 3,there is not even a chance for getting award.<br>
    This information is great for us.
</p>
<h3>Pages count to books count</h3>
<p>
    As part of checking some more ideas of what can lead to outliers and help the prediction model we decided to check the books pages count and we then saw this.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Pages Count Histogram&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Pages Count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="s1">&#39;anchor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_127_0.png" src="_images/books research_127_0.png" />
</div>
</div>
<p>
    This kind of data is exactly why we need to remove outliers.<br>
    This leads us to show all the outliers which we might have, based on the data of each coloumn individually.<br>
    Anyway, altough because of the data spewing, we probably choose median over mean (which may be very high because of the outliers).
    </p><p>let's have a look on both</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mean: </span><span class="si">{</span><span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;median: </span><span class="si">{</span><span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mean: 358.440916891395
median: 327.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Pages Count Histogram&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Pages Count&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="s1">&#39;anchor&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_131_0.png" src="_images/books research_131_0.png" />
</div>
</div>
<p>It seems like the median is closer to the peak area more than the mean, however let's zoom in even further</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">books_df_without_missing_values</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Pages Count Histogram&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Pages Count&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="s1">&#39;anchor&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_133_0.png" src="_images/books research_133_0.png" />
</div>
</div>
<p>Now, as it can be seen: the median really is seem to be more common (even with the amount of records we have)</p><p><a id='dealing_with_outliers'></a></p>
<p>
    <h2>Dealing with outliers</h2>
    In this secion, we are going to:<br>
    <ol>
        <li>Detect Outliers in all of our numeruic data and present them by using Boxplots.</li>
        <li>Using IQR which is going to replace all numeric cols items which their values are below the 25 percentile or above 75 percentile with median.</li>
    </ol>    
</p>
<h3>Outliers detection</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">display_numeric_boxplots</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">excluded</span><span class="p">):</span>
    <span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">excluded</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">excluded</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">display_numeric_boxplots</span><span class="p">(</span><span class="n">books_df_without_missing_values</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="s1">&#39;author_avg_rating&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_136_0.png" src="_images/books research_136_0.png" />
<img alt="_images/books research_136_1.png" src="_images/books research_136_1.png" />
<img alt="_images/books research_136_2.png" src="_images/books research_136_2.png" />
<img alt="_images/books research_136_3.png" src="_images/books research_136_3.png" />
<img alt="_images/books research_136_4.png" src="_images/books research_136_4.png" />
<img alt="_images/books research_136_5.png" src="_images/books research_136_5.png" />
<img alt="_images/books research_136_6.png" src="_images/books research_136_6.png" />
<img alt="_images/books research_136_7.png" src="_images/books research_136_7.png" />
<img alt="_images/books research_136_8.png" src="_images/books research_136_8.png" />
<img alt="_images/books research_136_9.png" src="_images/books research_136_9.png" />
</div>
</div>
<p><a id='outliers_cleaning'></a></p>
<h3>Outliers Cleaning</h3>
<p>
    At first we wanted to do replacement of the values under Q1 and values above Q3 will be replaced with median.<br>
    Yet, this approach would have been unfair for the great authors such as: J.K rolling and William Shakespeare which earned their crowd population respectfully, By replacing their values with medians we would have ruin the data and may also harm our future prediction model.<br>
    So in order to keep our data as realistic as we can and at the same time remove outliers we decided to use capping instead of medians, that way the great authors will not be downgraded by too much.<br>
    Another approach we wanted to try out was z-score and mean, reason doing that was since we knew the z-score model keeps around 99% of the population as non-outliers (in case of normal distribution) it would detect "real" outliers.<br>
    So in order to decide which approach's data we want to use for the prediction model we decided to try them both and compare the data's skew after each of them.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">replace_top_outliers_iqr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">excluded</span><span class="p">):</span>
    <span class="n">updated_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">updated_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">excluded</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">excluded</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">Q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">updated_df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="mi">25</span><span class="p">)</span>
        <span class="n">Q3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">updated_df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="mi">75</span><span class="p">)</span>
        <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
        <span class="n">IQR_range</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
        <span class="n">updated_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">updated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Q1</span> <span class="o">-</span> <span class="n">IQR_range</span><span class="p">),</span> <span class="p">[</span><span class="n">col</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Q1</span>
        <span class="n">updated_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">updated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Q3</span> <span class="o">+</span> <span class="n">IQR_range</span><span class="p">),</span> <span class="p">[</span><span class="n">col</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Q3</span>
    <span class="k">return</span> <span class="n">updated_df</span>

<span class="k">def</span> <span class="nf">replace_outliers_with_mean_using_zscore</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">excluded</span><span class="p">):</span>
    <span class="n">updated_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">updated_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">excluded</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">excluded</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">excluded</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">updated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">-</span> <span class="n">updated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">updated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">outliers</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_score</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">updated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">updated_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;int64&#39;</span><span class="p">:</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
        <span class="n">updated_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">outliers</span><span class="p">,</span> <span class="p">[</span><span class="n">col</span><span class="p">]]</span> <span class="o">=</span> <span class="n">mean</span>
        
    <span class="k">return</span> <span class="n">updated_df</span>

<span class="n">excluded</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="s1">&#39;author_avg_rating&#39;</span><span class="p">]</span>

<span class="n">fixed_outliers_books_df_capped_iqr</span> <span class="o">=</span> <span class="n">replace_top_outliers_iqr</span><span class="p">(</span>
    <span class="n">books_df_without_missing_values</span><span class="p">,</span>
    <span class="n">excluded</span>
<span class="p">)</span>

<span class="n">fixed_outliers_books_df_zscore</span> <span class="o">=</span> <span class="n">replace_outliers_with_mean_using_zscore</span><span class="p">(</span>
    <span class="n">books_df_without_missing_values</span><span class="p">,</span>
    <span class="n">excluded</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">print_numeric_cols_skew</span><span class="p">(</span><span class="n">df</span><span class="p">):</span> 
    <span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
    
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;regular -------&quot;</span><span class="p">)</span>
<span class="n">print_numeric_cols_skew</span><span class="p">(</span><span class="n">books_df_without_missing_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;capped iqr -------&quot;</span><span class="p">)</span>
<span class="n">print_numeric_cols_skew</span><span class="p">(</span><span class="n">fixed_outliers_books_df_capped_iqr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;zscore -------&quot;</span><span class="p">)</span>
<span class="n">print_numeric_cols_skew</span><span class="p">(</span><span class="n">fixed_outliers_books_df_zscore</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>regular -------
rating: -0.31112862828346455
ratings_count: 8.971843702199587
reviews_count: 5.040289224487523
pages_count: 20.271276180496592
editions_count: 10.45877719581811
to_read_count: 4.8095183834963375
currently_reading_count: 6.375684822748882
author_followers_count: 6.67216557644158
author_books_count: 5.426577263012842
author_avg_rating: -0.2029748677016511
author_ratings_count: 5.437158078340494
author_reviews_count: 4.267591106533465
capped iqr -------
rating: -0.31112862828346455
ratings_count: 1.2871777171048828
reviews_count: 1.2535537900583364
pages_count: 0.2749065618694054
editions_count: 0.9910075427588525
to_read_count: 1.2256776927321846
currently_reading_count: 1.2561146907178304
author_followers_count: 1.3009672934651775
author_books_count: 1.1160845768959375
author_avg_rating: -0.2029748677016511
author_ratings_count: 1.232327895143438
author_reviews_count: 1.2460134977915578
zscore -------
rating: -0.31112862828346455
ratings_count: 3.4517930642515644
reviews_count: 2.7033645606673993
pages_count: 1.1107079617120574
editions_count: 6.783419898382299
to_read_count: 2.685722205512912
currently_reading_count: 2.8789407175416453
author_followers_count: 5.152810070780249
author_books_count: 3.243650785439516
author_avg_rating: -0.2029748677016511
author_ratings_count: 3.194439376643621
author_reviews_count: 2.8610773153908533
</pre></div>
</div>
</div>
</div>
<p>As expected, capped IQR seems to be the best when it comes to skewing consideration</p><p>now we can proceed.</p><p>Let's visualize again the problematic pages_count metric after outliers cleaning</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">fixed_outliers_books_df_capped_iqr</span><span class="p">[</span><span class="s1">&#39;pages_count&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Pages Count Histogram&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Pages Count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="s1">&#39;anchor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">fixed_outliers_books_df_capped_iqr</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_142_0.png" src="_images/books research_142_0.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>ratings_count</th>
      <th>reviews_count</th>
      <th>pages_count</th>
      <th>editions_count</th>
      <th>to_read_count</th>
      <th>currently_reading_count</th>
      <th>author_followers_count</th>
      <th>author_books_count</th>
      <th>author_avg_rating</th>
      <th>author_ratings_count</th>
      <th>author_reviews_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>1.631600e+04</td>
      <td>16316.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.047275</td>
      <td>40124.220091</td>
      <td>2681.379505</td>
      <td>333.748774</td>
      <td>43.113140</td>
      <td>33482.523780</td>
      <td>2001.120250</td>
      <td>5672.390537</td>
      <td>76.940120</td>
      <td>4.048311</td>
      <td>3.393447e+05</td>
      <td>21345.637227</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.249599</td>
      <td>44177.972572</td>
      <td>2923.607765</td>
      <td>122.373708</td>
      <td>37.147111</td>
      <td>36207.027521</td>
      <td>2134.448389</td>
      <td>6629.075176</td>
      <td>72.198411</td>
      <td>0.207330</td>
      <td>3.805287e+05</td>
      <td>23460.780467</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.420000</td>
      <td>57.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>3.070000</td>
      <td>8.300000e+01</td>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.890000</td>
      <td>4979.000000</td>
      <td>341.000000</td>
      <td>245.000000</td>
      <td>13.000000</td>
      <td>4855.000000</td>
      <td>281.750000</td>
      <td>444.000000</td>
      <td>18.000000</td>
      <td>3.930000</td>
      <td>2.905475e+04</td>
      <td>2302.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.060000</td>
      <td>20057.500000</td>
      <td>1360.000000</td>
      <td>327.000000</td>
      <td>31.000000</td>
      <td>16590.000000</td>
      <td>1098.500000</td>
      <td>2426.000000</td>
      <td>49.000000</td>
      <td>4.050000</td>
      <td>1.667920e+05</td>
      <td>11935.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.210000</td>
      <td>81367.000000</td>
      <td>5392.250000</td>
      <td>421.000000</td>
      <td>74.000000</td>
      <td>67438.125000</td>
      <td>3968.000000</td>
      <td>11934.000000</td>
      <td>146.000000</td>
      <td>4.180000</td>
      <td>6.944250e+05</td>
      <td>42317.125000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.850000</td>
      <td>195893.000000</td>
      <td>12966.000000</td>
      <td>685.000000</td>
      <td>165.000000</td>
      <td>160884.000000</td>
      <td>9489.000000</td>
      <td>28677.000000</td>
      <td>338.000000</td>
      <td>4.730000</td>
      <td>1.685399e+06</td>
      <td>102202.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><a id='outliers_clean_results'></a></p>
<h3>Outliers cleaning results</h3>
<p>
    After the clean-up, Here are the coloums data without outliers.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_numeric_boxplots</span><span class="p">(</span><span class="n">fixed_outliers_books_df_capped_iqr</span><span class="p">,</span> <span class="n">excluded</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_144_0.png" src="_images/books research_144_0.png" />
<img alt="_images/books research_144_1.png" src="_images/books research_144_1.png" />
<img alt="_images/books research_144_2.png" src="_images/books research_144_2.png" />
<img alt="_images/books research_144_3.png" src="_images/books research_144_3.png" />
<img alt="_images/books research_144_4.png" src="_images/books research_144_4.png" />
<img alt="_images/books research_144_5.png" src="_images/books research_144_5.png" />
<img alt="_images/books research_144_6.png" src="_images/books research_144_6.png" />
<img alt="_images/books research_144_7.png" src="_images/books research_144_7.png" />
<img alt="_images/books research_144_8.png" src="_images/books research_144_8.png" />
<img alt="_images/books research_144_9.png" src="_images/books research_144_9.png" />
</div>
</div>
<h3>Data cleaning finished</h3>
<p>We are done with the cleaning process, le'ts save it</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fixed_outliers_books_df_capped_iqr</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s2">&quot;./clean_books.parquet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a id='after_clean_eda'></a></p>
<h2>After cleaning EDA</h2>
<p>
    Now when the data is clean it's time to see how far we have accomplished by now and show all the stats we have based on the data acquired.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_books</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;./clean_books.parquet&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">clean_books</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>original_title</th>
      <th>rating</th>
      <th>ratings_count</th>
      <th>reviews_count</th>
      <th>book_format</th>
      <th>pages_count</th>
      <th>main_language</th>
      <th>editions_count</th>
      <th>has_awards</th>
      <th>...</th>
      <th>top_tagged_genre_3</th>
      <th>to_read_count</th>
      <th>currently_reading_count</th>
      <th>author_name</th>
      <th>author_followers_count</th>
      <th>author_books_count</th>
      <th>author_avg_rating</th>
      <th>author_ratings_count</th>
      <th>author_reviews_count</th>
      <th>is_title_changed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Harry Potter and the Sorcerer's Stone</td>
      <td>Harry Potter and the Philosopher's Stone</td>
      <td>4.48</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>Hardcover</td>
      <td>309.0</td>
      <td>English</td>
      <td>74.0</td>
      <td>True</td>
      <td>...</td>
      <td>Young Adult</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>J.K. Rowling</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Harry Potter and the Chamber of Secrets</td>
      <td>Harry Potter and the Chamber of Secrets</td>
      <td>4.43</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>Hardcover</td>
      <td>341.0</td>
      <td>English</td>
      <td>74.0</td>
      <td>True</td>
      <td>...</td>
      <td>Young Adult</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>J.K. Rowling</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Harry Potter and the Prisoner of Azkaban</td>
      <td>Harry Potter and the Prisoner of Azkaban</td>
      <td>4.58</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>Mass Market Paperback</td>
      <td>435.0</td>
      <td>English</td>
      <td>74.0</td>
      <td>True</td>
      <td>...</td>
      <td>Fiction</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>J.K. Rowling</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Hobbit, or There and Back Again</td>
      <td>The Hobbit, or There and Back Again</td>
      <td>4.28</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>Paperback</td>
      <td>366.0</td>
      <td>English</td>
      <td>50.0</td>
      <td>True</td>
      <td>...</td>
      <td>Fiction</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>J.R.R. Tolkien</td>
      <td>11934.0</td>
      <td>146.0</td>
      <td>4.35</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Harry Potter and the Goblet of Fire</td>
      <td>Harry Potter and the Goblet of Fire</td>
      <td>4.57</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>Paperback</td>
      <td>421.0</td>
      <td>English</td>
      <td>74.0</td>
      <td>True</td>
      <td>...</td>
      <td>Fiction</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>J.K. Rowling</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>993</th>
      <td>Mrs. Fields Cookie Book</td>
      <td>Mrs. Fields Cookie Book</td>
      <td>4.22</td>
      <td>1259.0</td>
      <td>35.0</td>
      <td>Paperback</td>
      <td>120.0</td>
      <td>English</td>
      <td>2.0</td>
      <td>False</td>
      <td>...</td>
      <td>Food and Drink</td>
      <td>1218.0</td>
      <td>13.0</td>
      <td>Debbi Fields</td>
      <td>7.0</td>
      <td>11.0</td>
      <td>4.18</td>
      <td>1497.0</td>
      <td>60.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>994</th>
      <td>My Korea: Traditional Flavors, Modern Recipes</td>
      <td>My Korea: Traditional Flavors, Modern Recipes</td>
      <td>4.12</td>
      <td>83.0</td>
      <td>11.0</td>
      <td>Hardcover</td>
      <td>352.0</td>
      <td>English</td>
      <td>2.0</td>
      <td>False</td>
      <td>...</td>
      <td>Food and Drink</td>
      <td>328.0</td>
      <td>77.0</td>
      <td>Hooni Kim</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.12</td>
      <td>83.0</td>
      <td>11.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>996</th>
      <td>Cook It in Your Dutch Oven: 150 Foolproof Reci...</td>
      <td>Cook It in Your Dutch Oven: 150 Foolproof Reci...</td>
      <td>3.91</td>
      <td>291.0</td>
      <td>46.0</td>
      <td>Kindle Edition</td>
      <td>327.0</td>
      <td>English</td>
      <td>3.0</td>
      <td>False</td>
      <td>...</td>
      <td>Food and Drink</td>
      <td>267.0</td>
      <td>322.0</td>
      <td>America's Test Kitchen</td>
      <td>453.0</td>
      <td>199.0</td>
      <td>4.19</td>
      <td>54393.0</td>
      <td>3005.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>998</th>
      <td>Taste &amp; Technique: Recipes to Elevate Your Hom...</td>
      <td>Taste &amp; Technique: Recipes to Elevate Your Hom...</td>
      <td>4.16</td>
      <td>194.0</td>
      <td>31.0</td>
      <td>Kindle Edition</td>
      <td>400.0</td>
      <td>English</td>
      <td>3.0</td>
      <td>False</td>
      <td>...</td>
      <td>Food and Drink</td>
      <td>294.0</td>
      <td>137.0</td>
      <td>Naomi Pomeroy</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>4.16</td>
      <td>194.0</td>
      <td>31.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>999</th>
      <td>The Seasoned Life: Food, Family, Faith, and th...</td>
      <td>The Seasoned Life: Food, Family, Faith, and th...</td>
      <td>4.15</td>
      <td>397.0</td>
      <td>34.0</td>
      <td>Hardcover</td>
      <td>256.0</td>
      <td>English</td>
      <td>3.0</td>
      <td>False</td>
      <td>...</td>
      <td>Food and Drink</td>
      <td>426.0</td>
      <td>127.0</td>
      <td>Ayesha Curry</td>
      <td>17.0</td>
      <td>4.0</td>
      <td>4.04</td>
      <td>646.0</td>
      <td>69.0</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>16316 rows Ã 22 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">clean_books</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>ratings_count</th>
      <th>reviews_count</th>
      <th>pages_count</th>
      <th>editions_count</th>
      <th>to_read_count</th>
      <th>currently_reading_count</th>
      <th>author_followers_count</th>
      <th>author_books_count</th>
      <th>author_avg_rating</th>
      <th>author_ratings_count</th>
      <th>author_reviews_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>16316.000000</td>
      <td>1.631600e+04</td>
      <td>16316.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.047275</td>
      <td>40124.220091</td>
      <td>2681.379505</td>
      <td>333.748774</td>
      <td>43.170017</td>
      <td>33482.463778</td>
      <td>2001.120250</td>
      <td>5672.390537</td>
      <td>76.940120</td>
      <td>4.048311</td>
      <td>3.393447e+05</td>
      <td>21345.579002</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.249599</td>
      <td>44177.972572</td>
      <td>2923.607765</td>
      <td>122.373708</td>
      <td>37.210177</td>
      <td>36206.971246</td>
      <td>2134.448389</td>
      <td>6629.075176</td>
      <td>72.198411</td>
      <td>0.207330</td>
      <td>3.805287e+05</td>
      <td>23460.728394</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.420000</td>
      <td>57.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>3.070000</td>
      <td>8.300000e+01</td>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.890000</td>
      <td>4979.000000</td>
      <td>341.000000</td>
      <td>245.000000</td>
      <td>13.000000</td>
      <td>4855.000000</td>
      <td>281.750000</td>
      <td>444.000000</td>
      <td>18.000000</td>
      <td>3.930000</td>
      <td>2.905475e+04</td>
      <td>2302.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.060000</td>
      <td>20057.500000</td>
      <td>1360.000000</td>
      <td>327.000000</td>
      <td>31.000000</td>
      <td>16590.000000</td>
      <td>1098.500000</td>
      <td>2426.000000</td>
      <td>49.000000</td>
      <td>4.050000</td>
      <td>1.667920e+05</td>
      <td>11935.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.210000</td>
      <td>81367.000000</td>
      <td>5392.250000</td>
      <td>421.000000</td>
      <td>74.000000</td>
      <td>67438.000000</td>
      <td>3968.000000</td>
      <td>11934.000000</td>
      <td>146.000000</td>
      <td>4.180000</td>
      <td>6.944250e+05</td>
      <td>42317.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.850000</td>
      <td>195893.000000</td>
      <td>12966.000000</td>
      <td>685.000000</td>
      <td>165.000000</td>
      <td>160884.000000</td>
      <td>9489.000000</td>
      <td>28677.000000</td>
      <td>338.000000</td>
      <td>4.730000</td>
      <td>1.685399e+06</td>
      <td>102202.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_books</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 16316 entries, 0 to 999
Data columns (total 22 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   title                    16316 non-null  object 
 1   original_title           16316 non-null  object 
 2   rating                   16316 non-null  float64
 3   ratings_count            16316 non-null  float64
 4   reviews_count            16316 non-null  float64
 5   book_format              16316 non-null  object 
 6   pages_count              16316 non-null  float64
 7   main_language            16316 non-null  object 
 8   editions_count           16316 non-null  float64
 9   has_awards               16316 non-null  bool   
 10  top_tagged_genre_1       16316 non-null  object 
 11  top_tagged_genre_2       16316 non-null  object 
 12  top_tagged_genre_3       16316 non-null  object 
 13  to_read_count            16316 non-null  float64
 14  currently_reading_count  16316 non-null  float64
 15  author_name              16316 non-null  object 
 16  author_followers_count   16316 non-null  float64
 17  author_books_count       16316 non-null  float64
 18  author_avg_rating        16316 non-null  float64
 19  author_ratings_count     16316 non-null  float64
 20  author_reviews_count     16316 non-null  float64
 21  is_title_changed         16316 non-null  bool   
dtypes: bool(2), float64(12), object(8)
memory usage: 2.6+ MB
</pre></div>
</div>
</div>
</div>
<p><a id='thoughts_after_clean'></a></p>
<h3>Thoughts</h3>
<p>
    Based on what we saw in the description of the DataFrame we were happy with the results.<br>
    All the numbers were adding up to reasonable numbers and the percentiles values for each data coloumn are exactly how we wanted them.<br>
    Also, just by looking at the DataFrame as it is, we started having guesses of how to predict if a book can be awarded or not.<br>
    Overall we were very satisfied with the results.<p><a id='metrics_agg'></a></p>
<h3>Metrics aggregation by getting awarded</h3>
<p>
    We wanted to see how many books which has some metrics aggregated has awards or not.<br>
    Thus we decided to display these metrics.<br>
    The aggregation model is Ratio of:<br>
    <em>Sum of awarded books based on the metric / Total awarded books.</em><br>
    <strong>Note: we had to exclude rating and author average rating from the list due to the aggregation model lack of ability to sum a bounded value. </strong>
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="k">def</span> <span class="nf">get_aggregative_relative_metric_against_target_col</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">metric_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="n">split_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">val</span><span class="p">]</span>

    <span class="n">total_metric_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">split_df</span><span class="p">[</span><span class="n">metric_col</span><span class="p">])</span>
    
    <span class="n">ratio_of_aggregated_metric_to_split_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">total_metric_count</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">split_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">ratio_of_aggregated_metric_to_split_count</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">titlize</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">display_histogram_of_aggregative_metric_against_flag_column</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">metric_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">flag_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="n">positives</span> <span class="o">=</span> <span class="n">get_aggregative_relative_metric_against_target_col</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">metric_col</span><span class="p">,</span> <span class="n">flag_col</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">negatives</span> <span class="o">=</span> <span class="n">get_aggregative_relative_metric_against_target_col</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">metric_col</span><span class="p">,</span> <span class="n">flag_col</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="p">[</span><span class="n">negatives</span><span class="p">,</span> <span class="n">positives</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Not </span><span class="si">{</span><span class="n">titlize</span><span class="p">(</span><span class="n">flag_col</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">titlize</span><span class="p">(</span><span class="n">flag_col</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">titlize</span><span class="p">(</span><span class="n">metric_col</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39; Split by </span><span class="si">{</span><span class="n">titlize</span><span class="p">(</span><span class="n">flag_col</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exclude</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;rating&quot;</span><span class="p">,</span>
    <span class="s2">&quot;author_avg_rating&quot;</span>
<span class="p">}</span><span class="c1"># because those are based on average and it will not reflect any changes</span>

<span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">clean_books</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">display_histogram_of_aggregative_metric_against_flag_column</span><span class="p">(</span><span class="n">clean_books</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="s2">&quot;has_awards&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_154_0.png" src="_images/books research_154_0.png" />
<img alt="_images/books research_154_1.png" src="_images/books research_154_1.png" />
<img alt="_images/books research_154_2.png" src="_images/books research_154_2.png" />
<img alt="_images/books research_154_3.png" src="_images/books research_154_3.png" />
<img alt="_images/books research_154_4.png" src="_images/books research_154_4.png" />
<img alt="_images/books research_154_5.png" src="_images/books research_154_5.png" />
<img alt="_images/books research_154_6.png" src="_images/books research_154_6.png" />
<img alt="_images/books research_154_7.png" src="_images/books research_154_7.png" />
<img alt="_images/books research_154_8.png" src="_images/books research_154_8.png" />
<img alt="_images/books research_154_9.png" src="_images/books research_154_9.png" />
</div>
</div>
<p><a id='og_title_eff'></a></p>
<h3>Changing titles effectivness</h3>
<p>
    The question of how effective is it to change the name of the book was interesting to us from the beginning of this research.<br>
    Now we can finally check the correlation between changing the title to getting awards.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr_between_is_title_changed_to_has_awards</span> <span class="o">=</span> <span class="n">clean_books</span><span class="p">[[</span><span class="s2">&quot;is_title_changed&quot;</span><span class="p">,</span> <span class="s2">&quot;has_awards&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">corr_between_is_title_changed_to_has_awards</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">corr_between_is_title_changed_to_has_awards</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_title_changed</th>
      <th>has_awards</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>is_title_changed</th>
      <td>1.000000</td>
      <td>-0.174169</td>
    </tr>
    <tr>
      <th>has_awards</th>
      <td>-0.174169</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/books research_156_1.png" src="_images/books research_156_1.png" />
</div>
</div>
<p><a id='awards_count_to_genre'></a></p>
<p>
    As can be seen, there is no correlation in between these two, not all that is shining is gold.
</p>    
<h3>Count of awarded books per genre</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_genre_counts</span> <span class="o">=</span> <span class="n">clean_books</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;top_tagged_genre_1&#39;</span><span class="p">])[</span><span class="s1">&#39;has_awards&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Genre: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">books_genre_counts</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">fig1</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">books_genre_counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">, </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">books_genre_counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">books_genre_counts</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span>
    <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">},</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">fig1</span><span class="o">.</span><span class="n">transFigure</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_158_0.png" src="_images/books research_158_0.png" />
</div>
</div>
<p><a id='awards_book_by_percentage'></a></p>
<h3>Percentage of awarded books per genre</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">books_genre_has_awards_counts</span> <span class="o">=</span> <span class="n">clean_books</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;top_tagged_genre_1&#39;</span><span class="p">])[</span><span class="s1">&#39;has_awards&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">books_genre_counts</span> <span class="o">=</span> <span class="n">clean_books</span><span class="p">[</span><span class="s1">&#39;top_tagged_genre_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="n">books_genres_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s1">&#39;genre&#39;</span><span class="p">:</span> <span class="n">books_genre_counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="s1">&#39;has_awards&#39;</span><span class="p">:</span> <span class="n">books_genre_has_awards_counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="n">books_genre_counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="s1">&#39;has_awards_ratio_to_total&#39;</span><span class="p">:</span> <span class="n">books_genre_has_awards_counts</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">books_genre_counts</span><span class="o">.</span><span class="n">values</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">books_genres_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;has_awards_ratio_to_total&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Genre: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">books_genres_data</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>

<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">fig1</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">books_genre_counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%1.3f%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">l</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">books_genres_data</span><span class="p">[</span><span class="s2">&quot;has_awards_ratio_to_total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())],</span>
    <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">},</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">bbox_transform</span><span class="o">=</span><span class="n">fig1</span><span class="o">.</span><span class="n">transFigure</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># notice, audiobook is a genre</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_160_0.png" src="_images/books research_160_0.png" />
</div>
</div>
<p><a id='machine_learning_prep'></a></p>
<h1>Machine Learning model - Preperation</h1>
<p>
    Finally, time to make some predictions.<br>
    The method we wanted to use as our machine learning was decisions tree.<br>
    Reasons we chose this method were:<br>
    <ul>
        <li>This model can be used for classification.</li>
        <li>Very simple and intuitive.</li>
        <li>Using random forest to stimulate cross validation</li>
     </ul>
    Yet, we still had to do some data modifications before creating a machine learning model that can predict if a book will be awarded.<br>
    First, We planned to eliminate coloums whatever not relevant to the prediction model:
    <ul>
        <li>title</li>
        <li>original title</li>
    </ul>
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessed_books</span> <span class="o">=</span> <span class="n">clean_books</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;original_title&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>
    After that we want to be able to use a boolean based features in our DataFrame as value based coloums.<br>
    These booleans are:
    <ul>
        <li>has_awards</li>
        <li>is_title_changed</li>
    </ul>
    So in order to make it booleanish we deciced True value will be presented as 1 and False value will be presented as 0.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bool_to_int</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
    <span class="n">updated_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">updated_df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">updated_df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="mi">0</span>
    <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">updated_df</span>

<span class="n">preprocessed_books</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="s2">&quot;is_title_changed&quot;</span><span class="p">)</span>
<span class="n">preprocessed_books</span> <span class="o">=</span> <span class="n">bool_to_int</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="s2">&quot;has_awards&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>
    Last but not least, We had to do label encoings to all object type columns so they will fit the form for the machine learning model.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">label_encode_df_col_inplace</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;book_format&quot;</span><span class="p">,</span> <span class="s2">&quot;main_language&quot;</span><span class="p">,</span> <span class="s2">&quot;top_tagged_genre_1&quot;</span><span class="p">,</span> <span class="s2">&quot;top_tagged_genre_2&quot;</span><span class="p">,</span> <span class="s2">&quot;top_tagged_genre_3&quot;</span><span class="p">,</span> <span class="s2">&quot;author_name&quot;</span><span class="p">,</span> <span class="s2">&quot;is_title_changed&quot;</span><span class="p">,</span> <span class="s2">&quot;has_awards&quot;</span><span class="p">]:</span>
    <span class="n">label_encode_df_col_inplace</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessed_books</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>ratings_count</th>
      <th>reviews_count</th>
      <th>book_format</th>
      <th>pages_count</th>
      <th>main_language</th>
      <th>editions_count</th>
      <th>has_awards</th>
      <th>top_tagged_genre_1</th>
      <th>top_tagged_genre_2</th>
      <th>top_tagged_genre_3</th>
      <th>to_read_count</th>
      <th>currently_reading_count</th>
      <th>author_name</th>
      <th>author_followers_count</th>
      <th>author_books_count</th>
      <th>author_avg_rating</th>
      <th>author_ratings_count</th>
      <th>author_reviews_count</th>
      <th>is_title_changed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.48</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>10</td>
      <td>309.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>53</td>
      <td>228</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.43</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>10</td>
      <td>341.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>53</td>
      <td>228</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.58</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>16</td>
      <td>435.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>156</td>
      <td>85</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.28</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>18</td>
      <td>366.0</td>
      <td>3</td>
      <td>50.0</td>
      <td>1</td>
      <td>26</td>
      <td>27</td>
      <td>85</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2295</td>
      <td>11934.0</td>
      <td>146.0</td>
      <td>4.35</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.57</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>18</td>
      <td>421.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>156</td>
      <td>85</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>993</th>
      <td>4.22</td>
      <td>1259.0</td>
      <td>35.0</td>
      <td>18</td>
      <td>120.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>90</td>
      <td>1218.0</td>
      <td>13.0</td>
      <td>1336</td>
      <td>7.0</td>
      <td>11.0</td>
      <td>4.18</td>
      <td>1497.0</td>
      <td>60.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>994</th>
      <td>4.12</td>
      <td>83.0</td>
      <td>11.0</td>
      <td>10</td>
      <td>352.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>90</td>
      <td>328.0</td>
      <td>77.0</td>
      <td>2172</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.12</td>
      <td>83.0</td>
      <td>11.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>996</th>
      <td>3.91</td>
      <td>291.0</td>
      <td>46.0</td>
      <td>11</td>
      <td>327.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>90</td>
      <td>267.0</td>
      <td>322.0</td>
      <td>250</td>
      <td>453.0</td>
      <td>199.0</td>
      <td>4.19</td>
      <td>54393.0</td>
      <td>3005.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>998</th>
      <td>4.16</td>
      <td>194.0</td>
      <td>31.0</td>
      <td>11</td>
      <td>400.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>90</td>
      <td>294.0</td>
      <td>137.0</td>
      <td>4119</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>4.16</td>
      <td>194.0</td>
      <td>31.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>999</th>
      <td>4.15</td>
      <td>397.0</td>
      <td>34.0</td>
      <td>10</td>
      <td>256.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>90</td>
      <td>426.0</td>
      <td>127.0</td>
      <td>483</td>
      <td>17.0</td>
      <td>4.0</td>
      <td>4.04</td>
      <td>646.0</td>
      <td>69.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>16316 rows Ã 20 columns</p>
</div></div></div>
</div>
<h3>Terrific</h3>
<p>
    Our DataFrame is now ready for machine learning model.<br>
    Let's save the DataFrame and create the prediction model.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessed_books</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s2">&quot;./preprocessed_books.parquet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessed_books</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;./preprocessed_books.parquet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessed_books</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>ratings_count</th>
      <th>reviews_count</th>
      <th>book_format</th>
      <th>pages_count</th>
      <th>main_language</th>
      <th>editions_count</th>
      <th>has_awards</th>
      <th>top_tagged_genre_1</th>
      <th>top_tagged_genre_2</th>
      <th>top_tagged_genre_3</th>
      <th>to_read_count</th>
      <th>currently_reading_count</th>
      <th>author_name</th>
      <th>author_followers_count</th>
      <th>author_books_count</th>
      <th>author_avg_rating</th>
      <th>author_ratings_count</th>
      <th>author_reviews_count</th>
      <th>is_title_changed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.48</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>10</td>
      <td>309.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>53</td>
      <td>228</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.43</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>10</td>
      <td>341.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>53</td>
      <td>228</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.58</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>16</td>
      <td>435.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>156</td>
      <td>85</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.28</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>18</td>
      <td>366.0</td>
      <td>3</td>
      <td>50.0</td>
      <td>1</td>
      <td>26</td>
      <td>27</td>
      <td>85</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2295</td>
      <td>11934.0</td>
      <td>146.0</td>
      <td>4.35</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.57</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>18</td>
      <td>421.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>156</td>
      <td>85</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>993</th>
      <td>4.22</td>
      <td>1259.0</td>
      <td>35.0</td>
      <td>18</td>
      <td>120.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>90</td>
      <td>1218.0</td>
      <td>13.0</td>
      <td>1336</td>
      <td>7.0</td>
      <td>11.0</td>
      <td>4.18</td>
      <td>1497.0</td>
      <td>60.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>994</th>
      <td>4.12</td>
      <td>83.0</td>
      <td>11.0</td>
      <td>10</td>
      <td>352.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>90</td>
      <td>328.0</td>
      <td>77.0</td>
      <td>2172</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.12</td>
      <td>83.0</td>
      <td>11.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>996</th>
      <td>3.91</td>
      <td>291.0</td>
      <td>46.0</td>
      <td>11</td>
      <td>327.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>90</td>
      <td>267.0</td>
      <td>322.0</td>
      <td>250</td>
      <td>453.0</td>
      <td>199.0</td>
      <td>4.19</td>
      <td>54393.0</td>
      <td>3005.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>998</th>
      <td>4.16</td>
      <td>194.0</td>
      <td>31.0</td>
      <td>11</td>
      <td>400.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>90</td>
      <td>294.0</td>
      <td>137.0</td>
      <td>4119</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>4.16</td>
      <td>194.0</td>
      <td>31.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>999</th>
      <td>4.15</td>
      <td>397.0</td>
      <td>34.0</td>
      <td>10</td>
      <td>256.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>90</td>
      <td>426.0</td>
      <td>127.0</td>
      <td>483</td>
      <td>17.0</td>
      <td>4.0</td>
      <td>4.04</td>
      <td>646.0</td>
      <td>69.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>16316 rows Ã 20 columns</p>
</div></div></div>
</div>
<p><a id='machine_learning_single'></a></p>
<h1>Machine learning model - Single decision tree</h1>
<p>
    Our model for decision tree is based on 3 important utils:
    <ol>
        <li>The sklearn.tree module which includes decision tree-based models for classification. </li>
        <li>From the sklearn.model_selection we used train_test_split - Quick utility that wraps input validation and next(ShuffleSplit().split(X, y)) and application to input data into a single call for splitting (and optionally subsampling) data in a oneliner.<br>
        Which we wrapped with our own data splitter based on the features, labels and random state to our decisions.</li>
        <li>Rendring function which draws the decision tree.</li>
    </ol>
</p>
<p>
    Here you can see the splitting function and the rendering function.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">splitData</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">specifed_random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Split a subset of the dataset, given by the features, into train and test sets.&quot;&quot;&quot;</span>
    <span class="n">df_predictors</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">df_labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Split into training and test sets</span>
    <span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df_predictors</span><span class="p">,</span> <span class="n">df_labels</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">specifed_random_state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">renderTree</span><span class="p">(</span><span class="n">my_tree</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
    <span class="c1"># hacky solution of writing to files and reading again</span>
    <span class="c1"># necessary due to library bugs</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;temp.dot&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">export_graphviz</span><span class="p">(</span><span class="n">my_tree</span><span class="p">,</span> 
                                 <span class="n">out_file</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> 
                                 <span class="n">feature_names</span><span class="o">=</span><span class="n">features</span><span class="p">,</span> 
                                 <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Perished&quot;</span><span class="p">,</span> <span class="s2">&quot;Survived&quot;</span><span class="p">],</span>  
                                 <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                 <span class="n">rounded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">special_characters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  
    <span class="n">dot_data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">dot_data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">graph</span> <span class="o">=</span> <span class="n">pydotplus</span><span class="o">.</span><span class="n">graph_from_dot_data</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>
    <span class="n">image_name</span> <span class="o">=</span> <span class="s2">&quot;temp.png&quot;</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">image_name</span><span class="p">)</span>  
    <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">image_name</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessed_books</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 16316 entries, 0 to 999
Data columns (total 20 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   rating                   16316 non-null  float64
 1   ratings_count            16316 non-null  float64
 2   reviews_count            16316 non-null  float64
 3   book_format              16316 non-null  int64  
 4   pages_count              16316 non-null  float64
 5   main_language            16316 non-null  int64  
 6   editions_count           16316 non-null  float64
 7   has_awards               16316 non-null  int64  
 8   top_tagged_genre_1       16316 non-null  int64  
 9   top_tagged_genre_2       16316 non-null  int64  
 10  top_tagged_genre_3       16316 non-null  int64  
 11  to_read_count            16316 non-null  float64
 12  currently_reading_count  16316 non-null  float64
 13  author_name              16316 non-null  int64  
 14  author_followers_count   16316 non-null  float64
 15  author_books_count       16316 non-null  float64
 16  author_avg_rating        16316 non-null  float64
 17  author_ratings_count     16316 non-null  float64
 18  author_reviews_count     16316 non-null  float64
 19  is_title_changed         16316 non-null  int64  
dtypes: float64(12), int64(8)
memory usage: 2.6 MB
</pre></div>
</div>
</div>
</div>
<p><a id='first_attempt'></a></p>
<h3>First model prediction attempt</h3>
<p>
    And here you can see the decision tree model with the prediction and accuracy of the training and testing of the model based on <strong>rating</strong> feature only.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decisionTree</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;rating&quot;</span>
<span class="p">]</span>

<span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">])</span>
<span class="c1"># fit the tree with the traing data</span>
<span class="n">decisionTree</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">)</span>

<span class="c1"># predict with the training data</span>
<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTrain</span><span class="p">)</span>
<span class="c1"># measure accuracy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on training data = &#39;</span><span class="p">,</span> 
      <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_train</span><span class="p">))</span>

<span class="c1"># predict with the test data</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTest</span><span class="p">)</span>
<span class="c1"># measure accuracy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on test data = &#39;</span><span class="p">,</span> 
      <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="n">renderTree</span><span class="p">(</span><span class="n">decisionTree</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy on training data =  0.5857644847593364
Accuracy on test data =  0.5562637901446433
</pre></div>
</div>
<img alt="_images/books research_177_1.png" src="_images/books research_177_1.png" />
</div>
</div>
<h3>Seems like rating is not enough, as suspected</h3>
<p>in the next section, we are going to improve our prediction using both, more features and improved params.</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decisionTree</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;rating&quot;</span><span class="p">,</span>
        <span class="s2">&quot;editions_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_title_changed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top_tagged_genre_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top_tagged_genre_2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_read_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_followers_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ratings_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_count&quot;</span>
<span class="p">]</span>

<span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">])</span>
<span class="c1"># fit the tree with the traing data</span>
<span class="n">decisionTree</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">)</span>

<span class="c1"># predict with the training data</span>
<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTrain</span><span class="p">)</span>
<span class="c1"># measure accuracy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on training data = &#39;</span><span class="p">,</span> 
      <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_train</span><span class="p">))</span>

<span class="c1"># predict with the test data</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTest</span><span class="p">)</span>
<span class="c1"># measure accuracy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on test data = &#39;</span><span class="p">,</span> 
      <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="n">renderTree</span><span class="p">(</span><span class="n">decisionTree</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy on training data =  0.8300236986189425
Accuracy on test data =  0.7568031380240255
dot: graph is too large for cairo-renderer bitmaps. Scaling by 0.937915 to fit
</pre></div>
</div>
<img alt="_images/books research_179_1.png" src="_images/books research_179_1.png" />
</div>
</div>
<p><a id='ace'></a></p>
<h2>The ace in the sleeve</h2>
<h3>That's better but seems like maybe we can create a new column which may help us</h3>
<p>
    We are going to count how many books with awards the authors has and use it as an hint which may indicate for sucessful writing style.<br>
    The idea was to see if based on previous books the author was given awards the same author might get another award and that information will indicates a writing style that may be successful (As in other subjects such as movies where movies related to some directors are highly to be awarded). <br>
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre_df</span> <span class="o">=</span> <span class="n">preprocessed_books</span><span class="p">[</span><span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;author_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()[[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">]]</span>
<span class="n">authors_has_awards_count</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pre_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pre_df</span><span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
<span class="k">def</span> <span class="nf">get_author_awards_count</span><span class="p">(</span><span class="n">author_name</span><span class="p">,</span> <span class="n">authors_has_awards_count</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">author_name</span> <span class="ow">in</span> <span class="n">authors_has_awards_count</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">authors_has_awards_count</span><span class="p">[</span><span class="n">author_name</span><span class="p">]</span>
    <span class="k">return</span> <span class="mi">0</span>
<span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;author_books_with_awards_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;author_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">author_name</span><span class="p">:</span> <span class="n">get_author_awards_count</span><span class="p">(</span><span class="n">author_name</span><span class="p">,</span> <span class="n">authors_has_awards_count</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_histogram_of_aggregative_metric_against_flag_column</span><span class="p">(</span>
    <span class="n">preprocessed_books</span><span class="p">,</span>
    <span class="s2">&quot;author_books_with_awards_count&quot;</span><span class="p">,</span>
    <span class="s2">&quot;has_awards&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/books research_182_0.png" src="_images/books research_182_0.png" />
</div>
</div>
<p>
    Using the same aggregation graph we used before, You can now see that this "new" feature created by us has a lot of meaning to the prediction model.<br>
    Let's take a look at our new DataFrame. 
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessed_books</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>ratings_count</th>
      <th>reviews_count</th>
      <th>book_format</th>
      <th>pages_count</th>
      <th>main_language</th>
      <th>editions_count</th>
      <th>has_awards</th>
      <th>top_tagged_genre_1</th>
      <th>top_tagged_genre_2</th>
      <th>...</th>
      <th>to_read_count</th>
      <th>currently_reading_count</th>
      <th>author_name</th>
      <th>author_followers_count</th>
      <th>author_books_count</th>
      <th>author_avg_rating</th>
      <th>author_ratings_count</th>
      <th>author_reviews_count</th>
      <th>is_title_changed</th>
      <th>author_books_with_awards_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.48</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>10</td>
      <td>309.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>53</td>
      <td>...</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>1</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.43</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>10</td>
      <td>341.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>53</td>
      <td>...</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.58</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>16</td>
      <td>435.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>156</td>
      <td>...</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.28</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>18</td>
      <td>366.0</td>
      <td>3</td>
      <td>50.0</td>
      <td>1</td>
      <td>26</td>
      <td>27</td>
      <td>...</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2295</td>
      <td>11934.0</td>
      <td>146.0</td>
      <td>4.35</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.57</td>
      <td>81367.0</td>
      <td>5393.0</td>
      <td>18</td>
      <td>421.0</td>
      <td>3</td>
      <td>74.0</td>
      <td>1</td>
      <td>26</td>
      <td>156</td>
      <td>...</td>
      <td>67438.0</td>
      <td>3968.0</td>
      <td>2282</td>
      <td>11934.0</td>
      <td>221.0</td>
      <td>4.46</td>
      <td>694425.0</td>
      <td>42326.0</td>
      <td>0</td>
      <td>15</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>993</th>
      <td>4.22</td>
      <td>1259.0</td>
      <td>35.0</td>
      <td>18</td>
      <td>120.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>...</td>
      <td>1218.0</td>
      <td>13.0</td>
      <td>1336</td>
      <td>7.0</td>
      <td>11.0</td>
      <td>4.18</td>
      <td>1497.0</td>
      <td>60.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>994</th>
      <td>4.12</td>
      <td>83.0</td>
      <td>11.0</td>
      <td>10</td>
      <td>352.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>...</td>
      <td>328.0</td>
      <td>77.0</td>
      <td>2172</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.12</td>
      <td>83.0</td>
      <td>11.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>996</th>
      <td>3.91</td>
      <td>291.0</td>
      <td>46.0</td>
      <td>11</td>
      <td>327.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>...</td>
      <td>267.0</td>
      <td>322.0</td>
      <td>250</td>
      <td>453.0</td>
      <td>199.0</td>
      <td>4.19</td>
      <td>54393.0</td>
      <td>3005.0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>998</th>
      <td>4.16</td>
      <td>194.0</td>
      <td>31.0</td>
      <td>11</td>
      <td>400.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>...</td>
      <td>294.0</td>
      <td>137.0</td>
      <td>4119</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>4.16</td>
      <td>194.0</td>
      <td>31.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>999</th>
      <td>4.15</td>
      <td>397.0</td>
      <td>34.0</td>
      <td>10</td>
      <td>256.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>29</td>
      <td>35</td>
      <td>...</td>
      <td>426.0</td>
      <td>127.0</td>
      <td>483</td>
      <td>17.0</td>
      <td>4.0</td>
      <td>4.04</td>
      <td>646.0</td>
      <td>69.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>16316 rows Ã 21 columns</p>
</div></div></div>
</div>
<p>
    Time to check if the new author awards count we added is helping us with prediction or not.
</p> <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decisionTree</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;rating&quot;</span><span class="p">,</span>
        <span class="s2">&quot;editions_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_title_changed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top_tagged_genre_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_read_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_followers_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ratings_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_with_awards_count&quot;</span>
<span class="p">]</span>

<span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">])</span>
<span class="c1"># fit the tree with the traing data</span>
<span class="n">decisionTree</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">)</span>

<span class="c1"># predict with the training data</span>
<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTrain</span><span class="p">)</span>
<span class="c1"># measure accuracy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on training data = &#39;</span><span class="p">,</span> 
      <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_train</span><span class="p">))</span>

<span class="c1"># predict with the test data</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTest</span><span class="p">)</span>
<span class="c1"># measure accuracy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on test data = &#39;</span><span class="p">,</span> 
      <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="n">renderTree</span><span class="p">(</span><span class="n">decisionTree</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy on training data =  0.8747241971071341
Accuracy on test data =  0.8529051238048542
</pre></div>
</div>
<img alt="_images/books research_186_1.png" src="_images/books research_186_1.png" />
</div>
</div>
<h3>Great improvement</h3>
<p>
    Our "Ace" did help with improving the test group prediction accuracy by 10%, which is highly significant.
</p>    <p><a id='depth_opt'></a></p>
<h3>Depth optimization</h3>
<p>
    Using Grid Search we wanted to know if we can further improve our prediction accuracy.<br>
    The tests were done by using GridSearchVC from the selection module of sklrean.<br>
    The results were:
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="s2">&quot;min_samples_split&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="p">}</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">make_scorer</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;best parameter set is:&quot;</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span><span class="s2">&quot; and its score was&quot;</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>best parameter set is: {&#39;max_depth&#39;: 11, &#39;min_samples_split&#39;: 5}  and its score was 0.8657341856508302
</pre></div>
</div>
</div>
</div>
<p><strong>Note that we decided to move in the range of 2-12 depths and split range of 5-50 in the samples split due to optionality to have overfitting if we try any higher values.</strong></p>
<p>Let's try to predict with the suggested max_depth</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decisionTree</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;rating&quot;</span><span class="p">,</span>
        <span class="s2">&quot;editions_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_title_changed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top_tagged_genre_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_read_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_followers_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ratings_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_with_awards_count&quot;</span>
<span class="p">]</span>

<span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">])</span>
<span class="c1"># fit the tree with the traing data</span>
<span class="n">decisionTree</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">)</span>

<span class="c1"># predict with the training data</span>
<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTrain</span><span class="p">)</span>
<span class="c1"># measure accuracy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on training data = &#39;</span><span class="p">,</span> 
      <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_train</span><span class="p">))</span>

<span class="c1"># predict with the test data</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">decisionTree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTest</span><span class="p">)</span>
<span class="c1"># measure accuracy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on test data = &#39;</span><span class="p">,</span> 
      <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="n">renderTree</span><span class="p">(</span><span class="n">decisionTree</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy on training data =  0.9079839830023698
Accuracy on test data =  0.8673694532973768
</pre></div>
</div>
<img alt="_images/books research_192_1.png" src="_images/books research_192_1.png" />
</div>
</div>
<h3>Slight improvement</h3>
<p>
    We got ourselves a better training accuracy but the test prediction did not improve by a noticiable percentage.<br>
</p>    <p><a id='random_forest'></a></p>
<h2>Prediction model - Random forest of decision trees</h2>
<p>
    Understanding that one tree was just not enough in order to predict if a book will get an award,<br>
    We decided to get better prediction results using random forest model.<br>
    Reasons to use this model:<br>
    <ul>
        <li>Bootstraping - Creating several different subtrees which the commoest of them all is decided as the best prediction using wisdom of the crowd.</li>
        <li>Different subgroups - allows us to try out bigger uncorrelated (by features) decision trees, thus we prevent trying to predict with the same trees multiple times.</li>
        <li>Combining bootsraping and different subgroups also performs as cross-validation which improve accuracy.</li>
    </ul>
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;rating&quot;</span><span class="p">,</span>
        <span class="s2">&quot;editions_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_title_changed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top_tagged_genre_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_read_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_followers_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ratings_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_with_awards_count&quot;</span>
<span class="p">]</span>

<span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">])</span>

<span class="n">forest</span> <span class="o">=</span>  <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">trained_forest</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> 

<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTrain</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on training data= &#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_train</span><span class="p">))</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on test data= &#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy on training data=  1.0
Accuracy on test data=  0.9166462368227507
</pre></div>
</div>
</div>
</div>
<p><a id='overfitting'></a></p>
<h3> 100% of training accuracy, are we overfitting our model?</h3>
<p>
    At this point we were afraid our model is overfitting and that our training methodology needs to be changed.<br>
    So we went on investigation to understand, is the model overfitted?<br>
    After some investigation we found out we did not necessarily overfitted our model.<br>
    <a href="https://towardsdatascience.com/one-common-misconception-about-random-forest-and-overfitting-47cae2e2c23b">
        Here </a>
    is where we got the information which later on allowed us to understand we are not overfitting.
</p>    <p><a id='improve_model'></a></p>
<h3>But can further improve the model?</h3>
<p>
    In order to answer that question we decide to "eliminate" the features which are the least efficient in the prediction.<br>
    So we gathered the weights of each feature in the prediction.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">featuresDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">features</span><span class="p">,</span> <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">})</span>
<span class="n">featuresDF</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;weights&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>weights</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9</th>
      <td>author_books_with_awards_count</td>
      <td>0.392965</td>
    </tr>
    <tr>
      <th>5</th>
      <td>to_read_count</td>
      <td>0.138544</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ratings_count</td>
      <td>0.097785</td>
    </tr>
    <tr>
      <th>6</th>
      <td>author_followers_count</td>
      <td>0.075288</td>
    </tr>
    <tr>
      <th>4</th>
      <td>currently_reading_count</td>
      <td>0.073873</td>
    </tr>
    <tr>
      <th>8</th>
      <td>author_books_count</td>
      <td>0.065379</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rating</td>
      <td>0.053732</td>
    </tr>
    <tr>
      <th>1</th>
      <td>editions_count</td>
      <td>0.052118</td>
    </tr>
    <tr>
      <th>3</th>
      <td>top_tagged_genre_1</td>
      <td>0.042257</td>
    </tr>
    <tr>
      <th>2</th>
      <td>is_title_changed</td>
      <td>0.008058</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>
    The result is that <strong>is_title_changed</strong> was actually the least effective feature.<br>
    Let's remove the least affective feature (is_title_changed)
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;rating&quot;</span><span class="p">,</span>
        <span class="s2">&quot;editions_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top_tagged_genre_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_read_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_followers_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ratings_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_with_awards_count&quot;</span>
<span class="p">]</span>

<span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">])</span>

<span class="n">forest</span> <span class="o">=</span>  <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">trained_forest</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> 

<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTrain</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on training data= &#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_train</span><span class="p">))</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on test data= &#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy on training data=  1.0
Accuracy on test data=  0.9225300318705565
</pre></div>
</div>
</div>
</div>
<p><a id='another_ace'></a></p>
<h3>Less is more?</h3>
<p>
    Removing the <strong>is_title_changed</strong> came up as a great idea which led to better accuracy.<br>
    But we still want to improve the model.<br>
    We can improve it a bit by understand the satisfaction of people by how many already left comment to how many read it and multiply them by author average ratio.<br>
    Let's create another "Ace"  of our own.
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;rating_in_comparison_to_author_avg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;rating&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;author_avg_rating&quot;</span><span class="p">]</span>
<span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;left_reviews_to_reading_ratio_to_rating_synergy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;rating_in_comparison_to_author_avg&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;reviews_count&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;ratings_count&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;currently_reading_count&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">preprocessed_books</span><span class="p">[</span><span class="s2">&quot;to_read_count&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;rating&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top_tagged_genre_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_read_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_followers_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ratings_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_with_awards_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;left_reviews_to_reading_ratio_to_rating_synergy&quot;</span>
<span class="p">]</span>

<span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">])</span>

<span class="n">forest</span> <span class="o">=</span>  <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">trained_forest</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> 

<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTrain</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on training data= &#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_train</span><span class="p">))</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on test data= &#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy on training data=  1.0
Accuracy on test data=  0.924000980632508
</pre></div>
</div>
</div>
</div>
<h3>We were right</h3>
<p>
    We can use community satisfaction to our advantage, guess that the community has a part in awards giving decisions.<br>
    But was this new "Ace" an important part of the equation of the prediction?<br>
    Let's check the new feature's weight.
</p>    <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">featuresDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">features</span><span class="p">,</span> <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">})</span>
<span class="n">featuresDF</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;weights&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>weights</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>author_books_with_awards_count</td>
      <td>0.390284</td>
    </tr>
    <tr>
      <th>3</th>
      <td>to_read_count</td>
      <td>0.142737</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ratings_count</td>
      <td>0.096590</td>
    </tr>
    <tr>
      <th>4</th>
      <td>author_followers_count</td>
      <td>0.076095</td>
    </tr>
    <tr>
      <th>2</th>
      <td>currently_reading_count</td>
      <td>0.069476</td>
    </tr>
    <tr>
      <th>6</th>
      <td>author_books_count</td>
      <td>0.065218</td>
    </tr>
    <tr>
      <th>8</th>
      <td>left_reviews_to_reading_ratio_to_rating_synergy</td>
      <td>0.063305</td>
    </tr>
    <tr>
      <th>0</th>
      <td>rating</td>
      <td>0.052827</td>
    </tr>
    <tr>
      <th>1</th>
      <td>top_tagged_genre_1</td>
      <td>0.043468</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><a id='grid_search_forest'></a></p>
<p>
    The new feature has higher weight in the equation than 2 other features, which means our feature can be acceptable in our prediction model.
</p>    
<h3>Did we finally get the best results we could?</h3>
<p>
    In order to check that we went on and created another test over random forest and many configurations to see which configuration will get the best results.<br>
    The configuration options were as list:
    <ul>
        <li>Bootsrap - always on so we will use just a sample of the dataset and not the whole dataset to build the trees.</li>
        <li>n_estimators - The amount of estimators, we were wondering if more trees will get better results.</li>
        <li>random_state - was set to 0 to make sure the dataset used in every tree is the same.</li>
        <li>max_features - we tried to check all built in options the forest tree classifier has to find the best amount of features. </li>
     </ul>
</p><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># some hyper-params tuning</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;bootstrap&#39;</span><span class="p">:[</span><span class="kc">True</span><span class="p">],</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">501</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="s1">&#39;random_state&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;max_features&#39;</span><span class="p">:[</span><span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s1">&#39;log2&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">make_scorer</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;best parameter set is:&quot;</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span><span class="s2">&quot; and its score was&quot;</span><span class="p">,</span><span class="n">clf</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>best parameter set is: {&#39;bootstrap&#39;: True, &#39;max_features&#39;: &#39;sqrt&#39;, &#39;n_estimators&#39;: 1000, &#39;random_state&#39;: 0}  and its score was 0.9171361624611702
</pre></div>
</div>
</div>
</div>
<p><a id='the_top'></a></p>
<h3>Reached the top?</h3>
<p>
    So now we know the features combination that gives the best prediction but were we just lucky in the train/test split selection? or our model actually works?<br>
    In order to assure our model works we decided to do the followings:<br>
    <ol>
        <li>F-score - To determine the test's accuracy.</li>
        <li>Testing if there is another dataset randomness which will get similar results.</li>
    </ol>
</p>    
<h3>Prooving our test results are valid by adding the f-score results of our tests</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;rating&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top_tagged_genre_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_read_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_followers_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ratings_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;author_books_with_awards_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;left_reviews_to_reading_ratio_to_rating_synergy&quot;</span>
<span class="p">]</span>

<span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">])</span>

<span class="n">forest</span> <span class="o">=</span>  <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">53</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="s1">&#39;sqrt&#39;</span><span class="p">)</span>

<span class="n">trained_forest</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> 

<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTrain</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on training data= &#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_train</span><span class="p">))</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on test data= &#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f_measure score= &#39;</span><span class="p">,</span>  <span class="n">f1_score</span><span class="p">(</span><span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy on training data=  1.0
Accuracy on test data=  0.926697720029419
f_measure score=  0.9179698216735255
</pre></div>
</div>
</div>
</div>
<p><a id='random_states'></a></p>
<h3>Checking list of random states of datasets</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s test it on some more splits (some self cross validation)</span>
<span class="k">def</span> <span class="nf">manual_different_test_groups_accuracy_calc</span><span class="p">(</span><span class="n">split_random_state</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;rating&quot;</span><span class="p">,</span>
            <span class="s2">&quot;top_tagged_genre_1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;currently_reading_count&quot;</span><span class="p">,</span>
            <span class="s2">&quot;to_read_count&quot;</span><span class="p">,</span>
            <span class="s2">&quot;author_followers_count&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ratings_count&quot;</span><span class="p">,</span>
            <span class="s2">&quot;author_books_count&quot;</span><span class="p">,</span>
            <span class="s2">&quot;author_books_with_awards_count&quot;</span><span class="p">,</span>
            <span class="s2">&quot;left_reviews_to_reading_ratio_to_rating_synergy&quot;</span>
    <span class="p">]</span>

    <span class="n">XTrain</span><span class="p">,</span> <span class="n">XTest</span><span class="p">,</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">yTest</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">(</span><span class="n">preprocessed_books</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;has_awards&quot;</span><span class="p">],</span> <span class="n">split_random_state</span><span class="p">)</span>

    <span class="n">forest</span> <span class="o">=</span>  <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">53</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="s1">&#39;sqrt&#39;</span><span class="p">)</span>

    <span class="n">trained_forest</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTrain</span><span class="p">,</span> <span class="n">yTrain</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> 

    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTrain</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on training data= &#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTrain</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_train</span><span class="p">))</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">trained_forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTest</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy on test data= &#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f_measure score= &#39;</span><span class="p">,</span>  <span class="n">f1_score</span><span class="p">(</span><span class="n">yTest</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

    
<span class="n">split_random_states</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>

<span class="k">for</span> <span class="n">random_state</span> <span class="ow">in</span> <span class="n">split_random_states</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;random_state= &quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
    <span class="n">manual_different_test_groups_accuracy_calc</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--------
random_state=  0
Accuracy on training data=  0.9999182806243361
Accuracy on test data=  0.9242461387594999
f_measure score=  0.9122408406702641
--------
--------
random_state=  42
Accuracy on training data=  1.0
Accuracy on test data=  0.926697720029419
f_measure score=  0.9179698216735255
--------
--------
random_state=  100
Accuracy on training data=  0.9999182806243361
Accuracy on test data=  0.9193429762196617
f_measure score=  0.9082798996375802
--------
--------
random_state=  53
Accuracy on training data=  0.999836561248672
Accuracy on test data=  0.9205687668546212
f_measure score=  0.9086294416243654
--------
--------
random_state=  51
Accuracy on training data=  0.9999182806243361
Accuracy on test data=  0.9200784506006374
f_measure score=  0.9096452328159644
--------
--------
random_state=  177
Accuracy on training data=  0.9999182806243361
Accuracy on test data=  0.9088011767590095
f_measure score=  0.897914379802415
--------
--------
random_state=  9
Accuracy on training data=  0.9997548418730081
Accuracy on test data=  0.9257170875214513
f_measure score=  0.9138470287176571
--------
--------
random_state=  10
Accuracy on training data=  1.0
Accuracy on test data=  0.9225300318705565
f_measure score=  0.9120267260579064
--------
--------
random_state=  11
Accuracy on training data=  0.9999182806243361
Accuracy on test data=  0.9225300318705565
f_measure score=  0.9106840022611645
--------
--------
random_state=  12
Accuracy on training data=  1.0
Accuracy on test data=  0.9114979161559206
f_measure score=  0.8982238511418101
--------
--------
random_state=  13
Accuracy on training data=  0.9999182806243361
Accuracy on test data=  0.9190978180926698
f_measure score=  0.9070422535211267
--------
--------
random_state=  19
Accuracy on training data=  1.0
Accuracy on test data=  0.9173817112037264
f_measure score=  0.9055757915382461
--------
--------
random_state=  48
Accuracy on training data=  0.999836561248672
Accuracy on test data=  0.9178720274577102
f_measure score=  0.9048025007104291
--------
--------
random_state=  90
Accuracy on training data=  0.999836561248672
Accuracy on test data=  0.921304241235597
f_measure score=  0.9111049570756022
--------
--------
random_state=  101
Accuracy on training data=  1.0
Accuracy on test data=  0.9271880362834028
f_measure score=  0.9168300196023523
--------
--------
random_state=  57
Accuracy on training data=  1.0
Accuracy on test data=  0.9176268693307184
f_measure score=  0.9066666666666666
--------
--------
random_state=  88
Accuracy on training data=  0.9999182806243361
Accuracy on test data=  0.9215493993625888
f_measure score=  0.9091940976163451
--------
--------
random_state=  99
Accuracy on training data=  1.0
Accuracy on test data=  0.9168913949497426
f_measure score=  0.9048554588829639
--------
--------
random_state=  20
Accuracy on training data=  0.9999182806243361
Accuracy on test data=  0.9210590831086051
f_measure score=  0.9102564102564104
--------
--------
random_state=  900
Accuracy on training data=  0.9999182806243361
Accuracy on test data=  0.9259622456484432
f_measure score=  0.9168959823885526
--------
--------
random_state=  40
Accuracy on training data=  0.9999182806243361
Accuracy on test data=  0.9274331944103947
f_measure score=  0.9148936170212766
--------
--------
random_state=  28
Accuracy on training data=  0.999836561248672
Accuracy on test data=  0.9134591811718559
f_measure score=  0.9019716745348514
--------
--------
random_state=  19
Accuracy on training data=  1.0
Accuracy on test data=  0.9173817112037264
f_measure score=  0.9055757915382461
--------
--------
random_state=  90
Accuracy on training data=  0.999836561248672
Accuracy on test data=  0.921304241235597
f_measure score=  0.9111049570756022
--------
</pre></div>
</div>
</div>
</div>
<p><a id='conclusion'></a></p>
<h2>Conclusion</h2>
<p>
    Predicting if a book will get an awards comes with the need of familiarity with the dataset (i.e : knowing who the author is  may help with distinguish between legit record to an outlier and trigger appropriate action) and creativity to use existing data to create new features which can be used to improve the model prediction accuracy (i.e: using the knowledge of the author to create new dimension of data related to the amount of awards the author gathered).<br> 
    However, after observing the results of so many predictions (decision trees) we think that our model can predict with high accuracy.
</p>  <p><strong>Credits:</strong><br>
some of the used functions were taken from Campus IL course (Intro for Data Science):<br>
i.e:<br>
<u></p>
<li>visualizing the decision tree</li>
<li>detecting outliers using basic IQR</li>
<li>detecting outliers using z score</li>
</u>
Many thanks for sharing the knowledge.</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The Jupyter Book community<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>